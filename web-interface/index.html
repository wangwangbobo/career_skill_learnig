<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒé€”åŠ©æ‰‹AIæ±‚èŒå¤§å¸ˆ - ä¸“ä¸šæ±‚èŒå­¦ä¹ åŠ©æ‰‹</title>
    
    <!-- ä¼˜å…ˆåŠ è½½å…³é”®CSSï¼Œé¿å…ç™½å± -->  
    <link rel="stylesheet" href="styles.css">
    
    <!-- å†…è”å…³é”®æ ·å¼ï¼Œç«‹å³æ˜¾ç¤ºå†…å®¹ -->
    <style>
        /* ç«‹å³æ˜¾ç¤ºé¡µé¢ï¼Œé¿å…ç™½å± */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            opacity: 1 !important; /* å¼ºåˆ¶æ˜¾ç¤º */
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨çš„ç®€å•æ ·å¼ */
        .simple-loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            font-weight: 600;
            z-index: 9999;
        }
        
        .simple-loading.hidden {
            display: none;
        }
        
        /* ç®€å•çš„æ—‹è½¬åŠ¨ç”» */
        .simple-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    
    <!-- å¼‚æ­¥åŠ è½½å¤–éƒ¨å­—ä½“ï¼Œè®¾ç½®è¶…æ—¶é™çº§ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <script>
        // å­—ä½“åŠ è½½è¶…æ—¶å¤„ç†
        (function() {
            let fontLoaded = false;
            let iconLoaded = false;
            
            // è®¾ç½®2ç§’è¶…æ—¶
            setTimeout(() => {
                if (!fontLoaded) {
                    console.warn('â° Google Fonts åŠ è½½è¶…æ—¶ï¼Œä½¿ç”¨ç³»ç»Ÿå­—ä½“');
                    document.body.classList.add('font-fallback');
                }
                if (!iconLoaded) {
                    console.warn('â° FontAwesome åŠ è½½è¶…æ—¶ï¼Œä½¿ç”¨æ–‡æœ¬å›¾æ ‡');
                    document.body.classList.add('icon-fallback');
                }
            }, 2000);
            
            // åŠ¨æ€åŠ è½½å­—ä½“
            const fontLink = document.createElement('link');
            fontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap';
            fontLink.rel = 'stylesheet';
            fontLink.onload = () => { fontLoaded = true; console.log('âœ… Google Fonts åŠ è½½å®Œæˆ'); };
            fontLink.onerror = () => { console.warn('âŒ Google Fonts åŠ è½½å¤±è´¥'); };
            document.head.appendChild(fontLink);
            
            // åŠ¨æ€åŠ è½½å›¾æ ‡
            const iconLink = document.createElement('link');
            iconLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
            iconLink.rel = 'stylesheet';
            iconLink.onload = () => { iconLoaded = true; console.log('âœ… FontAwesome åŠ è½½å®Œæˆ'); };
            iconLink.onerror = () => { console.warn('âŒ FontAwesome åŠ è½½å¤±è´¥'); };
            document.head.appendChild(iconLink);
        })();
    </script>
    
    <!-- æ€ç»´å¯¼å›¾Markmapåº“å’Œæ ·å¼ -->
    <script>
        // åŠ¨æ€åŠ è½½Markmapç›¸å…³åº“
        window.markmapLibsLoading = true;
        window.markmapLibsLoadFailed = false;
        window.markmapLibsLoaded = false;
        
        // åˆ›å»ºscriptæ ‡ç­¾åŠ è½½D3å’ŒMarkmap
        function loadMarkmapLibs() {
            console.log('ğŸ§  å¼€å§‹åŠ è½½Markmapåº“...');
            
            // ç›´æ¥åŠ è½½markmap-autoloaderï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–
            const autoLoaderScript = document.createElement('script');
            autoLoaderScript.src = 'https://cdn.jsdelivr.net/npm/markmap-autoloader@0.14.3';
            autoLoaderScript.onload = () => {
                console.log('âœ… Markmap autoloaderåŠ è½½å®Œæˆ');
                window.markmapLibsLoaded = true;
                window.markmapLibsLoading = false;
                
                // ç­‰å¾…autoloaderåˆå§‹åŒ–
                setTimeout(() => {
                    if (window.markmap) {
                        console.log('âœ… Markmapåº“åˆå§‹åŒ–å®Œæˆ');
                    }
                }, 500);
            };
            autoLoaderScript.onerror = () => {
                console.warn('âŒ Markmap autoloaderåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ');
                loadMarkmapFallback();
            };
            document.head.appendChild(autoLoaderScript);
        }
        
        // å¤‡ç”¨åŠ è½½æ–¹æ¡ˆ
        function loadMarkmapFallback() {
            console.log('ğŸ”„ ä½¿ç”¨å¤‡ç”¨åŠ è½½æ–¹æ¡ˆ...');
            
            // åŠ è½½D3
            const d3Script = document.createElement('script');
            d3Script.src = 'https://cdn.jsdelivr.net/npm/d3@7';
            d3Script.onload = () => {
                console.log('âœ… D3åº“åŠ è½½å®Œæˆ');
                
                // D3åŠ è½½å®ŒæˆååŠ è½½Markmap
                const markmapScript = document.createElement('script');
                markmapScript.src = 'https://cdn.jsdelivr.net/npm/markmap-view@0.14.3';
                markmapScript.onload = () => {
                    console.log('âœ… Markmapåº“åŠ è½½å®Œæˆ');
                    window.markmapLibsLoaded = true;
                    window.markmapLibsLoading = false;
                    
                    // åŠ è½½Markmapå·¥å…·æ 
                    const toolbarScript = document.createElement('script');
                    toolbarScript.src = 'https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3';
                    toolbarScript.onload = () => console.log('âœ… Markmapå·¥å…·æ åŠ è½½å®Œæˆ');
                    document.head.appendChild(toolbarScript);
                };
                markmapScript.onerror = () => {
                    console.warn('âŒ Markmapåº“åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ');
                    window.markmapLibsLoadFailed = true;
                    window.markmapLibsLoading = false;
                };
                document.head.appendChild(markmapScript);
            };
            d3Script.onerror = () => {
                console.warn('âŒ D3åº“åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ');
                window.markmapLibsLoadFailed = true;
                window.markmapLibsLoading = false;
            };
            document.head.appendChild(d3Script);
        }
        
        // åŠ è½½Markmap CSS
        function loadMarkmapCSS() {
            const markmapCSS = document.createElement('link');
            markmapCSS.rel = 'stylesheet';
            markmapCSS.href = 'https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3/dist/style.css';
            markmapCSS.onload = () => console.log('âœ… Markmap CSSåŠ è½½å®Œæˆ');
            document.head.appendChild(markmapCSS);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåå°è¯•åŠ è½½Markmapåº“
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                loadMarkmapLibs();
                loadMarkmapCSS();
            });
        } else {
            loadMarkmapLibs();
            loadMarkmapCSS();
        }
        
        // 3ç§’è¶…æ—¶é™çº§
        setTimeout(() => {
            if (window.markmapLibsLoading && !window.markmapLibsLoaded) {
                console.warn('â° Markmapåº“åŠ è½½è¶…æ—¶ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ');
                window.markmapLibsLoadFailed = true;
                window.markmapLibsLoading = false;
            }
        }, 3000);
    </script>
    
    <!-- Markmapæ ·å¼ -->
    <style>
        .markmap-container {
            position: relative;
            width: 100%;
            height: 500px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background: #ffffff;
            overflow: hidden;
        }
        
        .markmap-header {
            padding: 10px 15px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .markmap-title {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .markmap-controls {
            display: flex;
            gap: 5px;
        }
        
        .markmap-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 5px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s ease;
        }
        
        .markmap-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .markmap-content {
            width: 100%;
            height: calc(100% - 45px);
            position: relative;
        }
        
        .markmap-content svg {
            width: 100%;
            height: 100%;
        }
        
        /* æ€ç»´å¯¼å›¾èŠ‚ç‚¹æ ·å¼ */
        .markmap g[data-depth="0"] > circle {
            fill: #4f46e5 !important;
        }
        
        .markmap g[data-depth="1"] > circle {
            fill: #059669 !important;
        }
        
        .markmap g[data-depth="2"] > circle {
            fill: #dc2626 !important;
        }
        
        .markmap g[data-depth="3"] > circle {
            fill: #d97706 !important;
        }
        
        /* é™çº§æ ‘å½¢ç»“æ„æ ·å¼ */
        .markmap-tree-fallback {
            padding: 15px;
            font-size: 0.9rem;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .mindmap-tree-level-0 {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .mindmap-node-item {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .mindmap-node-text {
            font-weight: 500;
        }
    </style>
    
    <!-- æ€ç»´å¯¼å›¾ä½¿ç”¨æœ¬åœ°é™çº§æ–¹æ¡ˆï¼Œä¸ä¾èµ–å¤–éƒ¨CDN -->
    <script>
        // è®¾ç½®æ€ç»´å¯¼å›¾ä½¿ç”¨é™çº§æ¨¡å¼
        window.markmapLibsLoading = false;
        window.markmapLibsLoadFailed = true;
        window.markmapLibsLoaded = false;
        
        console.log('ğŸ§  æ€ç»´å¯¼å›¾ä½¿ç”¨æœ¬åœ°é™çº§æ–¹æ¡ˆï¼Œä¸åŠ è½½å¤–éƒ¨CDNåº“');
    </script>
    
    <!-- å¿«é€Ÿåˆå§‹åŒ–è„šæœ¬ - æ€§èƒ½ä¼˜åŒ– -->
    <script>
        // é¡µé¢å¿«é€Ÿæ˜¾ç¤ºé€»è¾‘ - DOMå‡†å¤‡å°±ç»ªåç«‹å³æ˜¾ç¤º
        function quickShowPage() {
            console.log('âš¡ å¿«é€Ÿæ˜¾ç¤ºé¡µé¢...');
            
            const simpleLoading = document.getElementById('simpleLoading');
            if (simpleLoading) {
                simpleLoading.classList.add('hidden');
                console.log('âœ… åŠ è½½æŒ‡ç¤ºå™¨å·²éšè—');
            }
            
            // ç¡®ä¿é¡µé¢å†…å®¹å¯è§
            document.body.style.opacity = '1';
            document.body.style.visibility = 'visible';
            
            console.log('ğŸš€ é¡µé¢å·²å¿«é€Ÿæ˜¾ç¤ºï¼Œä¸ç­‰å¾…å¤–éƒ¨èµ„æº');
        }
        
        // DOMå†…å®¹åŠ è½½å®Œæˆåç«‹å³æ˜¾ç¤ºé¡µé¢
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', quickShowPage);
        } else {
            quickShowPage();
        }
        
        // å¤‡ç”¨æ–¹æ¡ˆï¼š500msåå¼ºåˆ¶æ˜¾ç¤ºé¡µé¢
        setTimeout(quickShowPage, 500);
    </script>
    
    <script src="fast-init.js"></script>
    <!-- é™çº§CSSï¼šå½“å¤–éƒ¨èµ„æºåŠ è½½å¤±è´¥æ—¶çš„å¤‡ç”¨æ ·å¼ -->
    <style>
        /* å­—ä½“é™çº§ï¼šå¦‚æœInterå­—ä½“æ²¡åŠ è½½æˆåŠŸï¼Œä½¿ç”¨ç³»ç»Ÿå­—ä½“ */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
        }
        
        /* å›¾æ ‡é™çº§ï¼šå¦‚æœFontAwesomeæ²¡åŠ è½½æˆåŠŸï¼Œæ˜¾ç¤ºæ–‡æœ¬ */
        .icon-fallback {
            display: none;
        }
        
        /* å­—ä½“é™çº§æ ·å¼ */
        .font-fallback {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif !important;
        }
        
        /* å›¾æ ‡é™çº§æ ·å¼ */
        .icon-fallback .fas {
            font-family: Arial, sans-serif !important;
        }
        .icon-fallback .fas.fa-graduation-cap:before { content: "ğŸ“"; }
        .icon-fallback .fas.fa-cog:before { content: "âš™ï¸"; }
        .icon-fallback .fas.fa-briefcase:before { content: "ğŸ’¼"; }
        .icon-fallback .fas.fa-file-alt:before { content: "ğŸ“„"; }
        .icon-fallback .fas.fa-lightbulb:before { content: "ğŸ’¡"; }
        .icon-fallback .fas.fa-question-circle:before { content: "â“"; }
        .icon-fallback .fas.fa-book:before { content: "ğŸ“š"; }
        .icon-fallback .fas.fa-certificate:before { content: "ğŸ†"; }
        .icon-fallback .fas:not([class*="fa-"]):before {
            content: "ğŸ“‹";
            font-family: Arial, sans-serif;
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            color: #4f46e5;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .loading-indicator.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ç®€å•åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div class="simple-loading" id="simpleLoading">
        <div class="simple-spinner"></div>
        æ­£åœ¨åŠ è½½èŒé€”åŠ©æ‰‹...
    </div>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>èŒé€”åŠ©æ‰‹</span>
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link active">é¦–é¡µ</a>
                <a href="#features" class="nav-link">åŠŸèƒ½</a>
                <a href="#about" class="nav-link">å…³äº</a>
                <button class="config-btn" id="configBtn">
                    <i class="fas fa-cog"></i>
                    <span>é…ç½®API</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <!-- å·¦ä¾§å†…å®¹åŒºåŸŸ -->
        <div class="content-area">
            <!-- æ¬¢è¿åŒºåŸŸ -->
            <section class="hero-section" id="home">
                <div class="hero-content">
                    <div class="robot-avatar">
                        ğŸ¤–
                    </div>
                    <h1 class="hero-title">èŒé€”åŠ©æ‰‹</h1>
                    <h2 class="hero-subtitle">Hi åŒå­¦ï¼</h2>
                    <p class="hero-description">æ ¹æ®èŒä½æè¿°ä¸ºä½ åˆ¶å®šä¸“å±å­¦ä¹ è·¯çº¿ï¼Œæä¾›ä»å²—ä½åˆ†æåˆ°é¢è¯•å‡†å¤‡çš„å…¨æ–¹ä½æ”¯æŒï¼Œè½»æ¾æ‹¿ä¸‹offer~</p>
                </div>
            </section>

            <!-- èŒä½è¾“å…¥åŒºåŸŸ -->
            <section class="job-input-section">
                <div class="input-card">
                    <div class="input-tabs">
                        <button class="tab-btn active" id="jobNameTab" data-tab="jobName">
                            <i class="fas fa-briefcase"></i>
                            è¾“å…¥å²—ä½åç§°
                        </button>
                        <button class="tab-btn" id="jobDescTab" data-tab="jobDesc">
                            <i class="fas fa-file-alt"></i>
                            ä¸Šä¼ èŒä½æè¿°
                        </button>
                    </div>
                    
                    <!-- å²—ä½åç§°è¾“å…¥ -->
                    <div class="tab-content active" id="jobNameContent">
                        <div class="input-group">
                            <label for="jobTitle">èŒä½åç§°ï¼š</label>
                            <input 
                                type="text" 
                                id="jobTitle" 
                                placeholder="è¯·å¡«å†™èŒä½ä¿¡æ¯ï¼ˆå¦‚AIå·¥ç¨‹å¸ˆï¼‰" 
                                class="job-input"
                            >
                        </div>
                        <div class="quick-jobs">
                            <span class="quick-label">çƒ­é—¨èŒä½ï¼š</span>
                            <button class="job-tag" data-job="å‰ç«¯å·¥ç¨‹å¸ˆ">å‰ç«¯å·¥ç¨‹å¸ˆ</button>
                            <button class="job-tag" data-job="åç«¯å·¥ç¨‹å¸ˆ">åç«¯å·¥ç¨‹å¸ˆ</button>
                            <button class="job-tag" data-job="AIå·¥ç¨‹å¸ˆ">AIå·¥ç¨‹å¸ˆ</button>
                            <button class="job-tag" data-job="äº§å“ç»ç†">äº§å“ç»ç†</button>
                            <button class="job-tag" data-job="æ•°æ®åˆ†æå¸ˆ">æ•°æ®åˆ†æå¸ˆ</button>
                        </div>
                    </div>
                    
                    <!-- èŒä½æè¿°ä¸Šä¼  -->
                    <div class="tab-content" id="jobDescContent">
                        <div class="input-group">
                            <label for="jobDescription">èŒä½æè¿°ï¼š</label>
                            <textarea 
                                id="jobDescription" 
                                placeholder="è¯·å¡«å†™èŒä½æè¿°ä¿¡æ¯" 
                                class="job-textarea"
                                rows="6"
                            ></textarea>
                        </div>
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>ç‚¹å‡»ä¸Šä¼ èŒä½æè¿°å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</p>
                            <input type="file" id="fileInput" accept="image/*" style="display: none;">
                            <button class="upload-btn" id="uploadBtn">
                                <i class="fas fa-image"></i>
                                é€‰æ‹©å›¾ç‰‡
                            </button>
                        </div>
                    </div>
                    
                    <button id="generateBtn" class="generate-btn" disabled>
                        <i class="fas fa-book"></i>
                        ç”Ÿæˆå­¦ä¹ è·¯çº¿
                    </button>
                </div>
            </section>

        <!-- åŠ è½½çŠ¶æ€ -->
        <section class="loading-section" id="loadingSection" style="display: none;">
            <div class="loading-card">
                <div class="loading-content">
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                    </div>
                    <h3 class="loading-title">AIæ­£åœ¨ä¸ºæ‚¨åˆ†æèŒä½å’Œç”Ÿæˆå­¦ä¹ èµ„æ–™...</h3>
                    
                    <!-- è¿›åº¦æ¡ -->
                    <div class="progress-container">
                        <div class="progress-bar" style="width: 0%"></div>
                    </div>
                    <div class="progress-text">0%</div>
                    <div class="loading-steps">
                        <div class="step active" id="step1">
                            <i class="fas fa-search"></i>
                            <span>åˆ†æèŒä½æŠ€èƒ½</span>
                        </div>
                        <div class="step" id="step2">
                            <i class="fas fa-lightbulb"></i>
                            <span>ç”ŸæˆçŸ¥è¯†ç‚¹</span>
                        </div>
                        <div class="step" id="step3">
                            <i class="fas fa-question-circle"></i>
                            <span>ç”Ÿæˆé¢è¯•é¢˜</span>
                        </div>
                        <div class="step" id="step4">
                            <i class="fas fa-book"></i>
                            <span>æ¨èä¹¦ç±</span>
                        </div>
                        <div class="step" id="step5">
                            <i class="fas fa-certificate"></i>
                            <span>æ¨èè¯ä¹¦</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
        <section class="results-section" id="resultsSection" style="display: none;">
            <div class="results-header">
                <h2 class="results-title">
                    <i class="fas fa-graduation-cap"></i>
                    åç«¯å·¥ç¨‹å¸ˆ æ ¸å¿ƒçŸ¥è¯†ç‚¹
                </h2>
                <div class="results-meta">
                    <span class="topic-display" id="topicDisplay"></span>
                    <span class="generation-time" id="generationTime"></span>
                </div>
                <div class="results-actions">
                    <button class="result-action-btn" id="saveBtn">
                        <i class="fas fa-save"></i>
                        ä¿å­˜
                    </button>
                    <button class="result-action-btn" id="exportBtn">
                        <i class="fas fa-file-pdf"></i>
                        å¯¼å‡ºPDF
                    </button>
                    <button class="result-action-btn" id="exportFeishuBtn">
                        <i class="fas fa-file-alt"></i>
                        å¯¼å‡ºé£ä¹¦æ–‡æ¡£
                    </button>
                </div>
            </div>

            <!-- æ€ç»´å¯¼å›¾ -->
            <div class="result-card" id="mindmapCard">
                <div class="card-header">
                    <h3><i class="fas fa-project-diagram"></i> æ€ç»´å¯¼å›¾</h3>
                    <span class="card-status" id="mindmapStatus">ç­‰å¾…ä¸­</span>
                    <div class="mindmap-controls">
                        <button class="mindmap-btn" id="expandAll" title="å±•å¼€å…¨éƒ¨">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <button class="mindmap-btn" id="collapseAll" title="æŠ˜å å…¨éƒ¨">
                            <i class="fas fa-compress-arrows-alt"></i>
                        </button>
                        <button class="mindmap-btn" id="downloadMindmap" title="ä¸‹è½½æ€ç»´å¯¼å›¾">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
                <div class="card-content" id="mindmapContent">
                    <!-- æ€ç»´å¯¼å›¾å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                </div>
            </div>

            <!-- äº”ä¸ªç‹¬ç«‹æ¨¡å—å±•ç¤ºåŒºåŸŸ -->
            <div class="content-modules-container" id="contentModulesContainer">
                <!-- çŸ¥è¯†ç‚¹æ¨¡å— -->
                <div class="module-card knowledge" id="knowledgeModule" style="display: none;">
                    <div class="module-header">
                        <i class="fas fa-lightbulb"></i>
                        <h3 class="module-title">æ ¸å¿ƒçŸ¥è¯†ç‚¹</h3>
                        <span class="module-count" id="knowledgeCount">0</span>
                    </div>
                    <div class="module-content" id="knowledgeContent">
                        <!-- çŸ¥è¯†ç‚¹å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>

                <!-- é«˜é¢‘é¢è¯•é¢˜æ¨¡å— -->
                <div class="module-card interview" id="interviewModule" style="display: none;">
                    <div class="module-header">
                        <i class="fas fa-question-circle"></i>
                        <h3 class="module-title">é«˜é¢‘é¢è¯•é¢˜</h3>
                        <span class="module-count" id="interviewCount">0</span>
                    </div>
                    <div class="module-content" id="interviewContent">
                        <!-- é¢è¯•é¢˜å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>

                <!-- æ¨èä¹¦ç±æ¨¡å— -->
                <div class="module-card books" id="booksModule" style="display: none;">
                    <div class="module-header">
                        <i class="fas fa-book"></i>
                        <h3 class="module-title">æ¨èä¹¦ç±</h3>
                        <span class="module-count" id="booksCount">0</span>
                    </div>
                    <div class="module-content" id="booksContent">
                        <!-- ä¹¦ç±å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>

                <!-- æ¨èè¯¾ç¨‹æ¨¡å— -->
                <div class="module-card courses" id="coursesModule" style="display: none;">
                    <div class="module-header">
                        <i class="fas fa-graduation-cap"></i>
                        <h3 class="module-title">æ¨èè¯¾ç¨‹</h3>
                        <span class="module-count" id="coursesCount">0</span>
                    </div>
                    <div class="module-content" id="coursesContent">
                        <!-- è¯¾ç¨‹å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>

                <!-- ç›¸å…³è¯ä¹¦æ¨¡å— -->
                <div class="module-card certificates" id="certificatesModule" style="display: none;">
                    <div class="module-header">
                        <i class="fas fa-certificate"></i>
                        <h3 class="module-title">ç›¸å…³è¯ä¹¦</h3>
                        <span class="module-count" id="certificatesCount">0</span>
                    </div>
                    <div class="module-content" id="certificatesContent">
                        <!-- è¯ä¹¦å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>
            </div>

            <!-- æŠ€èƒ½åˆ†ç±»å±•ç¤º -->
            <div class="skills-container" id="skillsContainer">
                <!-- æŠ€èƒ½åˆ†ç±»å°†åŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- é‡æ–°ç”ŸæˆæŒ‰é’® -->
            <div class="regenerate-section">
                <button class="regenerate-btn" id="regenerateBtn">
                    <i class="fas fa-redo"></i>
                    é‡æ–°ç”Ÿæˆ
                </button>
                <button class="regenerate-btn" id="testModulesBtn" style="margin-left: 1rem; background: #10b981;">
                    <i class="fas fa-flask"></i>
                    æµ‹è¯•äº”ä¸ªæ¨¡å—
                </button>
            </div>
        </section>

        <!-- é”™è¯¯æç¤º -->
        <section class="error-section" id="errorSection" style="display: none;">
            <div class="error-card">
                <div class="error-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 class="error-title">ç”Ÿæˆå¤±è´¥</h3>
                <p class="error-message" id="errorMessage"></p>
                <button class="retry-btn" id="retryBtn">
                    <i class="fas fa-redo"></i>
                    é‡è¯•
                </button>
            </div>
        </section>
        </div> <!-- ç»“æŸå·¦ä¾§å†…å®¹åŒºåŸŸ -->
        
        <!-- å³ä¾§æ—¥å¿—é¢æ¿ -->
        <div class="log-panel" id="logPanel">
            <div class="log-header">
                <h3>
                    <i class="fas fa-terminal"></i>
                    AI å®æ—¶æ—¥å¿—
                </h3>
                <div class="log-controls">
                    <button class="log-btn" id="clearLogsBtn" title="æ¸…ç©ºæ—¥å¿—">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="log-btn" id="downloadLogsBtn" title="ä¸‹è½½æ—¥å¿—">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="log-btn" id="toggleLogPanelBtn" title="éšè—/æ˜¾ç¤ºæ—¥å¿—">
                        <i class="fas fa-eye-slash"></i>
                    </button>
                </div>
            </div>
            <div class="log-content" id="logContent">
                <div class="log-welcome">
                    <i class="fas fa-info-circle"></i>
                    æ¬¢è¿ä½¿ç”¨èŒé€”åŠ©æ‰‹ï¼è¯·è¾“å…¥èŒä½ä¿¡æ¯å¼€å§‹ç”Ÿæˆ...
                </div>
            </div>
            <div class="log-status">
                <span class="log-count">0 æ¡æ—¥å¿—</span>
                <span class="log-auto-scroll">
                    <input type="checkbox" id="autoScrollLog" checked>
                    <label for="autoScrollLog">è‡ªåŠ¨æ»šåŠ¨</label>
                </span>
            </div>
        </div>
        
        <!-- AIå¯¹è¯æ¡† -->
        <div class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <h3>
                    <i class="fas fa-robot"></i>
                    AI æ™ºèƒ½åŠ©æ‰‹
                </h3>
                <div class="chat-controls">
                    <button class="chat-btn" id="clearChatBtn" title="æ¸…ç©ºå¯¹è¯">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="chat-btn" id="downloadChatBtn" title="ä¸‹è½½å¯¹è¯">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="chat-btn" id="toggleChatPanelBtn" title="éšè—/æ˜¾ç¤ºå¯¹è¯">
                        <i class="fas fa-eye-slash"></i>
                    </button>
                </div>
            </div>
            <div class="chat-content" id="chatContent">
                <div class="chat-welcome">
                    <i class="fas fa-robot"></i>
                    <p>ä½ å¥½ï¼æˆ‘æ˜¯èŒé€”åŠ©æ‰‹AIï¼Œå¯ä»¥å›ç­”ä½ å…³äºèŒä¸šå‘å±•ã€æŠ€èƒ½å­¦ä¹ çš„é—®é¢˜ã€‚</p>
                    <p>è¯·è¾“å…¥ä½ çš„é—®é¢˜å¼€å§‹å¯¹è¯å§ï¼</p>
                </div>
            </div>
            <div class="chat-input-area">
                <div class="chat-input-wrapper">
                    <textarea 
                        id="chatInput" 
                        placeholder="è¯·è¾“å…¥ä½ çš„é—®é¢˜..."
                        rows="2"
                        maxlength="2000"
                    ></textarea>
                    <button class="chat-send-btn" id="chatSendBtn" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="chat-status">
                    <span class="chat-count" id="chatCount">0 æ¡å¯¹è¯</span>
                    <span class="chat-model">AI æ¨¡å‹: ç™¾ç‚¼</span>
                </div>
            </div>
        </div>
    </div> <!-- ç»“æŸä¸»å®¹å™¨ -->

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 èŒé€”åŠ©æ‰‹AIæ±‚èŒå¤§å¸ˆ - åŸºäºEkoæ¡†æ¶æ„å»º | å‚åŠ "Awaken Your Web åˆ›æ–°æŒ‘æˆ˜èµ›"</p>
            <div class="footer-links">
                <a href="#" class="footer-link">GitHub</a>
                <a href="#" class="footer-link">æ–‡æ¡£</a>
                <a href="#" class="footer-link">åé¦ˆ</a>
            </div>
        </div>
    </footer>

    <!-- Toast é€šçŸ¥ -->
    <div class="toast" id="toast">
        <div class="toast-content">
            <i class="toast-icon"></i>
            <span class="toast-message"></span>
        </div>
    </div>

    <!-- APIå¯†é’¥é…ç½®å¼¹çª— -->
    <div class="config-modal" id="configModal">
        <div class="config-modal-overlay" id="configOverlay"></div>
        <div class="config-modal-content">
            <div class="config-header">
                <h3>
                    <i class="fas fa-key"></i>
                    é…ç½®APIå¯†é’¥
                </h3>
                <button class="config-close" id="configClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="config-body">
                <div class="config-description">
                    <p>ä¸ºäº†ä½¿ç”¨çœŸå®AIåŠŸèƒ½ç”Ÿæˆå­¦ä¹ å†…å®¹ï¼Œè¯·é…ç½®é˜¿é‡Œäº‘ç™¾ç‚¼APIå¯†é’¥ï¼š</p>
                </div>
                <div class="config-form">
                    <div class="config-input-group">
                        <label for="apiKeyInput">é˜¿é‡Œäº‘ç™¾ç‚¼APIå¯†é’¥ï¼š</label>
                        <div class="config-input-wrapper">
                            <input 
                                type="password" 
                                id="apiKeyInput" 
                                placeholder="è¯·è¾“å…¥ä½ çš„APIå¯†é’¥" 
                                class="config-input"
                            >
                            <button class="toggle-password" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="config-help">
                        <div class="config-help-item">
                            <strong>1. è·å–APIå¯†é’¥ï¼š</strong>
                            <a href="https://dashscope.console.aliyun.com/" target="_blank" class="config-link">
                                è®¿é—®é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°
                                <i class="fas fa-external-link-alt"></i>
                            </a>
                        </div>
                        <div class="config-help-item">
                            <strong>2. ç™»å½•é˜¿é‡Œäº‘è´¦å·</strong>å¹¶åˆ›å»ºAPIå¯†é’¥
                        </div>
                        <div class="config-help-item">
                            <strong>3. å¤åˆ¶å¯†é’¥</strong>å¹¶ç²˜è´´åˆ°ä¸Šæ–¹è¾“å…¥æ¡†
                        </div>
                    </div>
                    <div class="config-status" id="configStatus">
                        <!-- çŠ¶æ€ä¿¡æ¯å°†åŠ¨æ€æ˜¾ç¤º -->
                    </div>
                </div>
            </div>
            <div class="config-footer">
                <button class="config-btn config-btn-cancel" id="configCancel">å–æ¶ˆ</button>
                <button class="config-btn config-btn-test" id="configTest">æµ‹è¯•è¿æ¥</button>
                <button class="config-btn config-btn-save" id="configSave">ä¿å­˜é…ç½®</button>
            </div>
        </div>
    </div>

    <!-- å†…å®¹ç±»å‹é€‰æ‹©æ¨¡æ€æ¡† -->
    <div class="content-modal" id="contentModal">
        <div class="content-modal-overlay" id="contentOverlay"></div>
        <div class="content-modal-content">
            <div class="content-header">
                <h3>
                    <i class="fas fa-list-check"></i>
                    é€‰æ‹©ç”Ÿæˆå†…å®¹
                </h3>
                <button class="content-close" id="contentClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="content-body">
                <div class="content-description">
                    <p>è¯·é€‰æ‹©æ‚¨å¸Œæœ›ç”Ÿæˆçš„å­¦ä¹ èµ„æ–™ç±»å‹ï¼š</p>
                </div>
                <div class="content-options">
                    <label class="content-option">
                        <input type="checkbox" name="contentType" value="knowledge" checked>
                        <div class="option-card">
                            <i class="fas fa-lightbulb"></i>
                            <h4>çŸ¥è¯†ç‚¹</h4>
                            <p>æ ¸å¿ƒæŠ€èƒ½å’ŒçŸ¥è¯†ç‚¹æ¸…å•</p>
                        </div>
                    </label>
                    <label class="content-option">
                        <input type="checkbox" name="contentType" value="interview" checked>
                        <div class="option-card">
                            <i class="fas fa-question-circle"></i>
                            <h4>é«˜é¢‘é¢è¯•é¢˜</h4>
                            <p>å¸¸è§é¢è¯•é—®é¢˜å’Œå‚è€ƒç­”æ¡ˆ</p>
                        </div>
                    </label>
                    <label class="content-option">
                        <input type="checkbox" name="contentType" value="books">
                        <div class="option-card">
                            <i class="fas fa-book"></i>
                            <h4>æ¨èä¹¦ç±</h4>
                            <p>ç›¸å…³é¢†åŸŸä¸“ä¸šä¹¦ç±æ¨è</p>
                        </div>
                    </label>
                    <label class="content-option">
                        <input type="checkbox" name="contentType" value="certificates">
                        <div class="option-card">
                            <i class="fas fa-certificate"></i>
                            <h4>è¯ä¹¦</h4>
                            <p>èŒä¸šç›¸å…³è¯ä¹¦å’Œè®¤è¯</p>
                        </div>
                    </label>
                    <label class="content-option">
                        <input type="checkbox" name="contentType" value="courses">
                        <div class="option-card">
                            <i class="fas fa-graduation-cap"></i>
                            <h4>æ¨èè¯¾ç¨‹</h4>
                            <p>åœ¨çº¿å­¦ä¹ è¯¾ç¨‹æ¨è</p>
                        </div>
                    </label>
                </div>
            </div>
            <div class="content-footer">
                <button class="content-btn content-btn-cancel" id="contentCancel">å–æ¶ˆ</button>
                <button class="content-btn content-btn-confirm" id="contentConfirm">ç”Ÿæˆå­¦ä¹ è·¯çº¿</button>
            </div>
        </div>
    </div>

    <!-- ç®€åŒ–çš„JavaScriptåˆå§‹åŒ– -->
    <script>
        // ç«‹å³éšè—åŠ è½½æŒ‡ç¤ºå™¨ï¼Œæ˜¾ç¤ºé¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            const simpleLoading = document.getElementById('simpleLoading');
            if (simpleLoading) {
                simpleLoading.classList.add('hidden');
            }
            console.log('âœ“ é¡µé¢åŠ è½½å®Œæˆ');
            
            // ç«‹å³ä¿®å¤æŒ‰é’®çŠ¶æ€çš„å¤‡ç”¨è„šæœ¬
            setTimeout(function() {
                const jobTitle = document.getElementById('jobTitle');
                const generateBtn = document.getElementById('generateBtn');
                
                if (jobTitle && generateBtn) {
                    console.log('ğŸ”§ å¤‡ç”¨ä¿®å¤è„šæœ¬å¯åŠ¨...');
                    
                    function updateButtonState() {
                        const hasValue = jobTitle.value.trim().length > 0;
                        generateBtn.disabled = !hasValue;
                        generateBtn.style.opacity = hasValue ? '1' : '0.6';
                        generateBtn.style.cursor = hasValue ? 'pointer' : 'not-allowed';
                        generateBtn.style.pointerEvents = 'auto';
                        
                        console.log('ğŸ”„ æŒ‰é’®çŠ¶æ€æ›´æ–°:', {
                            hasValue,
                            disabled: generateBtn.disabled,
                            value: jobTitle.value
                        });
                    }
                    
                    // ç«‹å³æ›´æ–°
                    updateButtonState();
                    
                    // ç›‘å¬è¾“å…¥å˜åŒ–
                    jobTitle.addEventListener('input', updateButtonState);
                    
                    // ç›‘å¬çƒ­é—¨æŒ‰é’®ç‚¹å‡»
                    document.querySelectorAll('.job-tag').forEach(function(tag) {
                        tag.addEventListener('click', function() {
                            const job = this.getAttribute('data-job');
                            if (job) {
                                jobTitle.value = job;
                                updateButtonState();
                                console.log('ğŸ† çƒ­é—¨èŒä½é€‰ä¸­:', job);
                            }
                        });
                    });
                    
                    console.log('âœ… å¤‡ç”¨ä¿®å¤è„šæœ¬å·²åˆå§‹åŒ–');
                }
            }, 50);
        });
        
        // å¦‚æœ3ç§’å†…æ²¡åŠ è½½å®Œæˆï¼Œå¼ºåˆ¶æ˜¾ç¤ºé¡µé¢
        setTimeout(function() {
            const simpleLoading = document.getElementById('simpleLoading');
            if (simpleLoading) {
                simpleLoading.classList.add('hidden');
            }
        }, 3000);
    </script>
    
    <!-- ä¸»è¦çš„JavaScriptæ–‡ä»¶ - åŒæ­¥åŠ è½½ç¡®ä¿æ­£ç¡®åˆå§‹åŒ– -->
    <script src="app.js"></script>
    
    <!-- ç®€åŒ–çš„åˆå§‹åŒ–è„šæœ¬ - è§£å†³åˆå§‹åŒ–é—®é¢˜ -->
    <script src="simple-init.js"></script>
    
    <!-- èŒé€”åŠ©æ‰‹è¡¥å……æ–¹æ³• -->
    <script>
        // ç®€å•çš„åˆå§‹åŒ–æ£€æŸ¥
        function addJobAssistantMethods() {
            // ç­‰å¾…ä¸»ç±»åŠ è½½å®Œæˆ
            if (window.jobAssistantUI) {
                const ui = window.jobAssistantUI;
                console.log('âœ… æ‰¾åˆ° jobAssistantUIï¼Œæ·»åŠ è¡¥å……æ–¹æ³•...');
                
                // æ·»åŠ switchTabæ–¹æ³•
                ui.switchTab = function(tabName) {
                    if (!this.jobNameTab || !this.jobDescTab) return;
                    
                    this.jobNameTab.classList.remove('active');
                    this.jobDescTab.classList.remove('active');
                    this.jobNameContent.classList.remove('active');
                    this.jobDescContent.classList.remove('active');
                    
                    if (tabName === 'jobName') {
                        this.jobNameTab.classList.add('active');
                        this.jobNameContent.classList.add('active');
                    } else {
                        this.jobDescTab.classList.add('active');
                        this.jobDescContent.classList.add('active');
                    }
                    
                    this.updateGenerateButton && this.updateGenerateButton();
                };
                
                // æ·»åŠ updateGenerateButtonæ–¹æ³•
                ui.updateGenerateButton = function() {
                    const hasJobTitle = this.jobTitle && this.jobTitle.value.trim().length > 0;
                    const hasJobDesc = this.jobDescription && this.jobDescription.value.trim().length > 0;
                    const hasUploadedFile = this.fileInput && this.fileInput.files.length > 0;
                    
                    const isJobNameTabActive = this.jobNameContent && this.jobNameContent.classList.contains('active');
                    const isValid = isJobNameTabActive ? hasJobTitle : (hasJobDesc || hasUploadedFile);
                    
                    if (this.generateBtn) {
                        this.generateBtn.disabled = !isValid;
                        this.generateBtn.style.opacity = isValid ? '1' : '0.6';
                    }
                };
                
                // æ·»åŠ showContentModalæ–¹æ³•
                ui.showContentModal = function() {
                    if (this.contentModal) {
                        this.contentModal.classList.add('show');
                        this.updateContentConfirmButton && this.updateContentConfirmButton();
                    }
                };
                
                // æ·»åŠ hideContentModalæ–¹æ³•
                ui.hideContentModal = function() {
                    if (this.contentModal) {
                        this.contentModal.classList.remove('show');
                    }
                };
                
                // æ·»åŠ updateContentConfirmButtonæ–¹æ³•
                ui.updateContentConfirmButton = function() {
                    if (this.contentOptions && this.contentConfirm) {
                        const checkedOptions = Array.from(this.contentOptions).filter(cb => cb.checked);
                        this.contentConfirm.disabled = checkedOptions.length === 0;
                    }
                };
                
                // æ·»åŠ startGenerationæ–¹æ³•ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
                ui.startGeneration = async function() {
                    try {
                        console.log('ğŸš€ å¼€å§‹ç”Ÿæˆå­¦ä¹ èµ„æ–™');
                        
                        // è·å–é€‰ä¸­çš„å†…å®¹ç±»å‹
                        this.selectedContentTypes = [];
                        if (this.contentOptions) {
                            this.selectedContentTypes = Array.from(this.contentOptions)
                                .filter(cb => cb.checked)
                                .map(cb => cb.value);
                        }
                        
                        // è·å–èŒä½ä¿¡æ¯
                        const isJobNameTabActive = this.jobNameContent && this.jobNameContent.classList.contains('active');
                        if (isJobNameTabActive && this.jobTitle) {
                            this.currentJobInfo = {
                                type: 'jobName',
                                content: this.jobTitle.value.trim()
                            };
                        } else if (this.jobDescription) {
                            this.currentJobInfo = {
                                type: 'jobDescription',
                                content: this.jobDescription.value.trim(),
                                file: this.fileInput && this.fileInput.files[0] || null
                            };
                        }
                        
                        this.hideContentModal();
                        
                        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                        if (this.loadingSection) {
                            this.loadingSection.style.display = 'block';
                        }
                        
                        this.addLog && this.addLog('info', `ğŸ’¼ å¼€å§‹åˆ†æèŒä½: ${this.currentJobInfo.content}`);
                        this.addLog && this.addLog('info', `ğŸ¯ é€‰ä¸­å†…å®¹ç±»å‹: ${this.selectedContentTypes.join(', ')}`);
                        
                        // è°ƒç”¨çœŸå®APIç”Ÿæˆå­¦ä¹ èµ„æ–™
                        await this.callRealAPI();
                        
                    } catch (error) {
                        console.error('ç”Ÿæˆå¤±è´¥:', error);
                        this.showToast && this.showToast('ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
                    }
                };
                
                // æ·»åŠ çœŸå®APIè°ƒç”¨æ–¹æ³•ï¼ˆæµå¼ç‰ˆæœ¬ï¼‰
                ui.callRealAPI = async function() {
                    try {
                        console.log('ğŸš€ å¼€å§‹æµå¼ç”Ÿæˆå­¦ä¹ æ–¹æ¡ˆ...');
                        this.addLog && this.addLog('info', 'ğŸš€ å¼€å§‹è°ƒç”¨AIæµå¼ç”Ÿæˆæ¥å£...');
                        
                        // æ£€æŸ¥æ˜¯å¦æœ‰APIå¯†é’¥
                        const apiKey = this.getStoredApiKey ? this.getStoredApiKey() : null;
                        
                        if (!apiKey) {
                            this.addLog && this.addLog('warning', 'âš ï¸ æœªé…ç½®APIå¯†é’¥ï¼Œå°†å°è¯•ä½¿ç”¨æœ¬åœ°å·¥å…·æœç´¢è¯¾ç¨‹');
                            this.showToast && this.showToast('âš ï¸ æœªé…ç½®APIå¯†é’¥ï¼Œå°†å°è¯•ä½¿ç”¨æœ¬åœ°å·¥å…·ã€‚é…ç½®APIå¯†é’¥å¯è·å¾—æ›´å¥½çš„AIåŠŸèƒ½ã€‚', 'info', 5000);
                        }
                        
                        // ä½¿ç”¨æµå¼APIç«¯ç‚¹
                        const response = await fetch('/api/generate-learning-plan-stream', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                topic: this.currentJobInfo.content,
                                apiKey: apiKey,
                                contentTypes: this.selectedContentTypes  // æ·»åŠ ç”¨æˆ·é€‰æ‹©çš„å†…å®¹ç±»å‹
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        // å¤„ç†æµå¼å“åº”
                        const reader = response.body.getReader();
                        const decoder = new TextDecoder();
                        let buffer = '';
                        
                        // å­˜å‚¨æµå¼æ•°æ®
                        let streamData = {
                            courses: [],
                            studyPlan: null,
                            exercises: [],
                            notes: null,
                            progress: null,
                            mindmap: null
                        };
                        
                        console.log('ğŸ“Š å¼€å§‹å¤„ç†æµå¼å“åº”...');
                        this.addLog && this.addLog('info', 'ğŸ“Š æ­£åœ¨æ¥æ”¶AIæµå¼æ•°æ®...');
                        
                        const processStream = async () => {
                            try {
                                while (true) {
                                    const { done, value } = await reader.read();
                                    
                                    if (done) {
                                        console.log('ğŸ æµå¼æ•°æ®æ¥æ”¶å®Œæˆ');
                                        this.addLog && this.addLog('success', 'âœ… æµå¼æ•°æ®æ¥æ”¶å®Œæˆ');
                                        
                                        // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
                                        this.showStreamResults(streamData);
                                        return;
                                    }
                                    
                                    buffer += decoder.decode(value, { stream: true });
                                    const lines = buffer.split('\n');
                                    
                                    // ä¿ç•™æœ€åä¸€è¡Œï¼ˆå¯èƒ½ä¸å®Œæ•´ï¼‰
                                    buffer = lines.pop() || '';
                                    
                                    for (const line of lines) {
                                        if (line.trim() === '') continue;
                                        
                                        if (line.startsWith('event: ')) {
                                            const eventType = line.slice(7).trim();
                                            console.log('ğŸ“¡ SSEäº‹ä»¶ç±»å‹:', eventType);
                                            continue;
                                        }
                                        
                                        if (line.startsWith('data: ')) {
                                            try {
                                                const dataStr = line.slice(6);
                                                const data = JSON.parse(dataStr);
                                                console.log('ğŸ“Š æ”¶åˆ°æµå¼æ•°æ®:', data);
                                                
                                                // å¤„ç†æµå¼äº‹ä»¶
                                                await this.handleStreamEvent(data, streamData);
                                                
                                            } catch (e) {
                                                console.warn('âš ï¸ è§£ææµæ•°æ®å¤±è´¥:', e.message, 'åŸå§‹æ•°æ®:', line);
                                            }
                                        }
                                    }
                                }
                            } catch (streamError) {
                                console.error('âŒ æµå¤„ç†é”™è¯¯:', streamError);
                                this.addLog && this.addLog('error', 'âŒ æµå¤„ç†é”™è¯¯: ' + streamError.message);
                                throw streamError;
                            }
                        };
                        
                        await processStream();
                        
                    } catch (error) {
                        console.error('â“ APIè°ƒç”¨å¤±è´¥:', error);
                        this.addLog && this.addLog('error', `âŒ APIè°ƒç”¨å¤±è´¥: ${error.message}`);
                        
                        // é™çº§åˆ°æ¨¡æ‹Ÿæ•°æ®
                        this.showToast && this.showToast('APIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®å±•ç¤º', 'warning', 3000);
                        await this.simulateGeneration();
                        this.generateMockData();
                    }
                };
                
                // æ·»åŠ å¤„ç†æµå¼äº‹ä»¶çš„æ–¹æ³•
                ui.handleStreamEvent = async function(data, streamData) {
                    console.log('ğŸ“Š æµå¼äº‹ä»¶:', data);
                    
                    // å¤„ç†å¼€å§‹äº‹ä»¶
                    if (data.message && data.message.includes('å¼€å§‹ç”Ÿæˆ')) {
                        this.addLog && this.addLog('info', 'ğŸš€ ' + data.message);
                        return;
                    }
                    
                    // æ ¹æ®äº‹ä»¶ç±»å‹å¤„ç†
                    if (data.step) {
                        console.log(`ğŸ”„ å¤„ç†æ­¥éª¤: ${data.step}, è¿›åº¦: ${data.progress}%`);
                        this.addLog && this.addLog('info', `ğŸ”„ ${data.message || data.step}`);
                        
                        // å¦‚æœæœ‰æ•°æ®ï¼Œæ›´æ–°å¯¹åº”éƒ¨åˆ†
                        if (data.data) {
                            console.log(`ğŸ“Š æ”¶åˆ° ${data.step} æ•°æ®:`, data.data);
                            console.log(`ğŸ† å³å°†æ˜¾ç¤º ${data.step} å†…å®¹...`);
                            
                            switch (data.step) {
                                case 'courses':
                                    streamData.courses = data.data;
                                    console.log('ğŸ“ å¼€å§‹æ˜¾ç¤ºè¯¾ç¨‹æ¨è...');
                                    this.displayStreamCourses(data.data);
                                    this.addLog && this.addLog('success', 'âœ… è¯¾ç¨‹æ¨èç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… è¯¾ç¨‹æ¨èæ˜¾ç¤ºå®Œæˆ');
                                    break;
                                case 'studyPlan':
                                    streamData.studyPlan = data.data;
                                    console.log('ğŸ’¡ å¼€å§‹æ˜¾ç¤ºçŸ¥è¯†ç‚¹...');
                                    // ä½¿ç”¨çŸ¥è¯†ç‚¹æ˜¾ç¤ºæ–¹æ³•è€Œä¸æ˜¯å­¦ä¹ è®¡åˆ’
                                    this.displayStreamKnowledge(data.data.phases || []);
                                    this.addLog && this.addLog('success', 'âœ… çŸ¥è¯†ç‚¹ç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… çŸ¥è¯†ç‚¹æ˜¾ç¤ºå®Œæˆ');
                                    break;
                                case 'exercises':
                                    streamData.exercises = data.data;
                                    console.log('â“ å¼€å§‹æ˜¾ç¤ºé¢è¯•é¢˜...');
                                    this.displayStreamExercises(data.data);
                                    this.addLog && this.addLog('success', 'âœ… é¢è¯•é¢˜ç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… é¢è¯•é¢˜æ˜¾ç¤ºå®Œæˆ');
                                    break;
                                case 'notes':
                                    streamData.notes = data.data;
                                    console.log('ğŸ“š å¼€å§‹æ˜¾ç¤ºæ¨èä¹¦ç±...');
                                    this.displayStreamNotes(data.data);
                                    this.addLog && this.addLog('success', 'âœ… æ¨èä¹¦ç±ç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… æ¨èä¹¦ç±æ˜¾ç¤ºå®Œæˆ');
                                    break;
                                case 'progress':
                                    streamData.progress = data.data;
                                    console.log('ğŸ† å¼€å§‹æ˜¾ç¤ºç›¸å…³è¯ä¹¦...');
                                    this.displayStreamCertificates(data.data);
                                    this.addLog && this.addLog('success', 'âœ… ç›¸å…³è¯ä¹¦ç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… ç›¸å…³è¯ä¹¦æ˜¾ç¤ºå®Œæˆ');
                                    break;
                                case 'mindmap':
                                    streamData.mindmap = data.data;
                                    console.log('ğŸ§  å¼€å§‹æ˜¾ç¤ºæ€ç»´å¯¼å›¾...');
                                    this.displayStreamMindmap(data.data);
                                    this.addLog && this.addLog('success', 'âœ… æ€ç»´å¯¼å›¾ç”Ÿæˆå®Œæˆ');
                                    console.log('âœ… æ€ç»´å¯¼å›¾æ˜¾ç¤ºå®Œæˆ');
                                    break;
                                default:
                                    console.warn(`âš ï¸ æœªçŸ¥çš„æ­¥éª¤ç±»å‹: ${data.step}`);
                            }
                        } else {
                            console.warn(`âš ï¸ ${data.step} æ­¥éª¤æ²¡æœ‰æ•°æ®`);
                        }
                    }
                    
                    // å¤„ç†å®Œæˆäº‹ä»¶
                    if (data.result) {
                        console.log('âœ… æµå¼ç”Ÿæˆå®Œæˆï¼Œæ›´æ–°æœ€ç»ˆç»“æœ');
                        console.log('ğŸ“Š æœ€ç»ˆç»“æœæ•°æ®:', data.result);
                        Object.assign(streamData, data.result);
                        
                        // æ¸…ç©ºç»“æœå®¹å™¨ï¼Œå‡†å¤‡æ˜¾ç¤º5ä¸ªç‹¬ç«‹åˆ†å—
                        if (this.skillsContainer) {
                            this.skillsContainer.innerHTML = '';
                            console.log('ğŸ—‘ï¸ å·²æ¸…ç©ºç»“æœå®¹å™¨ï¼Œå‡†å¤‡æ˜¾ç¤ºç‹¬ç«‹åˆ†å—');
                        }
                        
                        // ç¡®ä¿æ˜¾ç¤ºæœ€ç»ˆç»“æœä¸­çš„æ‰€æœ‰å†…å®¹ - ä¸ºæ¯ç§é€‰ä¸­çš„å†…å®¹ç±»å‹æ˜¾ç¤ºç‹¬ç«‹åˆ†å—
                        const selectedTypes = this.selectedContentTypes || ['knowledge', 'interview'];
                        console.log('ğŸ” ç”¨æˆ·é€‰æ‹©çš„å†…å®¹ç±»å‹:', selectedTypes);
                        
                        // 1. çŸ¥è¯†ç‚¹ - ä½¿ç”¨studyPlanæ•°æ®
                        if (selectedTypes.includes('knowledge') && data.result.studyPlan) {
                            console.log('ğŸ’¡ æ˜¾ç¤ºçŸ¥è¯†ç‚¹åˆ†å—');
                            this.displayStreamKnowledge(data.result.studyPlan.phases || []);
                        }
                        
                        // 2. é«˜é¢‘é¢è¯•é¢˜ - ä½¿ç”¨exercisesæ•°æ®
                        if (selectedTypes.includes('interview') && data.result.exercises) {
                            console.log('â“ æ˜¾ç¤ºé¢è¯•é¢˜åˆ†å—');
                            this.displayStreamExercises(data.result.exercises);
                        }
                        
                        // 3. æ¨èä¹¦ç± - ä½¿ç”¨notesæ•°æ®
                        if (selectedTypes.includes('books') && data.result.notes) {
                            console.log('ğŸ“š æ˜¾ç¤ºä¹¦ç±åˆ†å—');
                            this.displayStreamNotes(data.result.notes);
                        }
                        
                        // 4. ç›¸å…³è¯ä¹¦ - ä½¿ç”¨progressæ•°æ®
                        if (selectedTypes.includes('certificates') && data.result.progress) {
                            console.log('ğŸ† æ˜¾ç¤ºè¯ä¹¦åˆ†å—');
                            this.displayStreamCertificates(data.result.progress);
                        }
                        
                        // 5. æ¨èè¯¾ç¨‹ - ä½¿ç”¨coursesæ•°æ®
                        if (selectedTypes.includes('courses') && data.result.courses) {
                            console.log('ğŸ“ æ˜¾ç¤ºè¯¾ç¨‹åˆ†å—');
                            this.displayStreamCourses(data.result.courses);
                        }
                        
                        // 6. æ€ç»´å¯¼å›¾ - å§‹ç»ˆæ˜¾ç¤ºï¼ˆä½œä¸ºæœ€åä¸€ä¸ªç‹¬ç«‹åˆ†å—ï¼‰
                        if (data.result.mindmap) {
                            console.log('ğŸ§  æ˜¾ç¤ºæ€ç»´å¯¼å›¾åˆ†å—');
                            this.displayStreamMindmap(data.result.mindmap);
                        }
                        
                        this.addLog && this.addLog('success', 'ğŸ‰ å­¦ä¹ æ–¹æ¡ˆç”Ÿæˆå®Œæˆï¼');
                    }
                    
                    // å¤„ç†é”™è¯¯äº‹ä»¶
                    if (data.error) {
                        console.error('âŒ æµå¼ç”Ÿæˆé”™è¯¯:', data.error);
                        this.addLog && this.addLog('error', 'âŒ æµå¼ç”Ÿæˆé”™è¯¯: ' + data.error);
                        throw new Error(data.error);
                    }
                };
                
                // ä¿®æ”¹è¯¾ç¨‹æ˜¾ç¤ºæ–¹æ³• - ä½¿ç”¨ç‹¬ç«‹åˆ†å—æ˜¾ç¤º
                ui.displayStreamCourses = function(courses) {
                    if (!courses || !Array.isArray(courses) || courses.length === 0) {
                        console.warn('âš ï¸ è¯¾ç¨‹æ•°æ®ä¸ºç©ºæˆ–æ— æ•ˆ');
                        return;
                    }
                    
                    console.log('ğŸ“ æ˜¾ç¤ºæ¨èè¯¾ç¨‹:', courses);
                    
                    // æ ¼å¼åŒ–è¯¾ç¨‹æ•°æ®
                    const coursesData = courses.map(course => {
                        const rating = course.rating ? parseFloat(course.rating).toFixed(1) : 'N/A';
                        const students = course.students ? course.students.toLocaleString() : '0';
                        const difficulty = this.translateDifficulty ? this.translateDifficulty(course.difficulty) : course.difficulty || 'æœªçŸ¥';
                        const highlights = course.highlights ? course.highlights.join('ã€') : '';
                        
                        return `<div class="course-item" style="margin-bottom: 1.5rem; padding: 1rem; border: 1px solid #e5e5e5; border-radius: 8px; background: #f9f9f9;">
                            <h4 style="margin: 0 0 0.5rem 0; color: #4f46e5;">${course.title || 'æœªå‘½åè¯¾ç¨‹'}</h4>
                            <p><strong>ğŸ¢ å¹³å°:</strong> ${course.platform || 'æœªçŸ¥å¹³å°'}</p>
                            <p><strong>ğŸ“Š éš¾åº¦:</strong> ${difficulty}</p>
                            <p><strong>â­ è¯„åˆ†:</strong> ${rating}/5 | <strong>ğŸ‘¥ å­¦ç”Ÿ:</strong> ${students}äºº</p>
                            <p><strong>â±ï¸ æ—¶é•¿:</strong> ${course.duration || 'æœªçŸ¥'} | <strong>ğŸ’° ä»·æ ¼:</strong> ${course.price === 0 ? 'å…è´¹' : 'ï¿¥' + (course.price || 'æœªçŸ¥')}</p>
                            ${highlights ? `<p><strong>ğŸ† äº®ç‚¹:</strong> ${highlights}</p>` : ''}
                            ${course.description ? `<p style="color: #444; font-size: 0.9rem;">${course.description}</p>` : ''}
                        </div>`;
                    });
                    
                    this.addIndependentSkillCategory('ğŸ“ æ¨èè¯¾ç¨‹', 'courses', coursesData, 'fas fa-graduation-cap');
                };
                
                ui.displayStreamStudyPlan = function(studyPlan) {
                    if (!studyPlan) {
                        console.warn('âš ï¸ å­¦ä¹ è®¡åˆ’æ•°æ®ä¸ºç©º');
                        return;
                    }
                    
                    console.log('ğŸ“‹ æ˜¾ç¤ºå­¦ä¹ è®¡åˆ’:', studyPlan);
                    
                    // ä¸ºå­¦ä¹ è®¡åˆ’åˆ›å»ºç‹¬ç«‹çš„æ˜¾ç¤ºå—
                    const studyPlanData = studyPlan.phases ? studyPlan.phases.map(phase => 
                        `<strong>${phase.name || 'æœªå‘½åé˜¶æ®µ'}</strong><br>${(phase.tasks || []).map(task => `â€¢ ${task}`).join('<br>')}`
                    ) : ['æš‚æ— å­¦ä¹ è®¡åˆ’æ•°æ®'];
                    
                    this.addIndependentSkillCategory('ğŸ“‹ å­¦ä¹ è®¡åˆ’', 'knowledge', studyPlanData, 'fas fa-clipboard-list');
                };
                
                ui.displayStreamExercises = function(exercises) {
                    if (!exercises || !Array.isArray(exercises) || exercises.length === 0) {
                        console.warn('âš ï¸ ç»ƒä¹ é¢˜æ•°æ®ä¸ºç©ºæˆ–æ— æ•ˆ');
                        return;
                    }
                    
                    console.log('ğŸ“ æ˜¾ç¤ºç»ƒä¹ é¢˜:', exercises);
                    
                    // ä¸ºç»ƒä¹ é¢˜åˆ›å»ºç‹¬ç«‹çš„æ˜¾ç¤ºå—
                    const exercisesData = exercises.map((exercise, index) => `${index + 1}. ${exercise || 'ç©ºé¢˜ç›®'}`);
                    
                    this.addIndependentSkillCategory('â“ é«˜é¢‘é¢è¯•é¢˜', 'interview', exercisesData, 'fas fa-question-circle');
                };
                
                ui.displayStreamNotes = function(notes) {
                    if (!notes) {
                        console.warn('âš ï¸ ç¬”è®°æ•°æ®ä¸ºç©º');
                        return;
                    }
                    
                    console.log('ğŸ“– æ˜¾ç¤ºå­¦ä¹ ç¬”è®°:', notes);
                    
                    // ä¸ºå­¦ä¹ ç¬”è®°åˆ›å»ºç‹¬ç«‹çš„æ˜¾ç¤ºå—
                    const notesData = notes.keyPoints ? notes.keyPoints.map(point => point || 'ç©ºå†…å®¹') : ['æš‚æ— å…³é”®çŸ¥è¯†ç‚¹'];
                    
                    this.addIndependentSkillCategory('ğŸ“š æ¨èä¹¦ç±', 'books', notesData, 'fas fa-book');
                };
                
                // æ·»åŠ ç‹¬ç«‹æŠ€èƒ½åˆ†ç±»æ˜¾ç¤ºæ–¹æ³•
                ui.addIndependentSkillCategory = function(title, contentType, items, iconClass) {
                    if (!this.skillsContainer) return;
                    
                    const selectedTypes = this.selectedContentTypes || ['knowledge', 'interview'];
                    
                    // æ£€æŸ¥æ˜¯å¦åº”è¯¥æ˜¾ç¤ºè¿™ä¸ªå†…å®¹ç±»å‹
                    if (!selectedTypes.includes(contentType)) {
                        console.log(`ğŸš« è·³è¿‡æ˜¾ç¤º ${title}ï¼Œå› ä¸ºç”¨æˆ·æœªé€‰æ‹© ${contentType} ç±»å‹`);
                        return;
                    }
                    
                    const skillDiv = document.createElement('div');
                    skillDiv.className = 'skill-category';
                    skillDiv.innerHTML = `
                        <div class="skill-header" onclick="this.parentElement.classList.toggle('collapsed')">
                            <h3 class="skill-title">
                                <i class="${iconClass}"></i>
                                ${title}
                            </h3>
                            <i class="fas fa-chevron-down skill-toggle"></i>
                        </div>
                        <div class="skill-content">
                            <div class="content-types">
                                <div class="content-type">
                                    <div class="content-type-body">
                                        ${this.renderContentItems(items)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    this.skillsContainer.appendChild(skillDiv);
                    console.log(`âœ… æ·»åŠ ç‹¬ç«‹å†…å®¹å—: ${title}`);
                };
                
                // æ·»åŠ å†…å®¹æ¸²æŸ“è¾…åŠ©æ–¹æ³•
                ui.renderContentItems = function(items) {
                    if (!items || !Array.isArray(items)) {
                        return '<p>æš‚æ— æ•°æ®</p>';
                    }
                    
                    return items.map(item => {
                        if (typeof item === 'string') {
                            return `<div class="content-item">${item}</div>`;
                        } else {
                            return `<div class="content-item">${item}</div>`;
                        }
                    }).join('');
                };
                
                // ä¿®æ”¹è¯¾ç¨‹æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamCourses = function(courses) {
                    if (!courses || !Array.isArray(courses) || courses.length === 0) {
                        console.warn('âš ï¸ è¯¾ç¨‹æ•°æ®ä¸ºç©ºæˆ–æ— æ•ˆ');
                        return;
                    }
                    
                    console.log('ğŸ“ æ˜¾ç¤ºæ¨èè¯¾ç¨‹:', courses);
                    
                    // æ ¼å¼åŒ–è¯¾ç¨‹æ•°æ®
                    const coursesData = courses.map(course => {
                        return `<div class="course-item">
                            <h4>${course.title || 'æœªå‘½åè¯¾ç¨‹'}</h4>
                            <p><strong>å¹³å°:</strong> ${course.platform || 'æœªçŸ¥å¹³å°'}</p>
                            <p><strong>éš¾åº¦:</strong> ${this.translateDifficulty ? this.translateDifficulty(course.difficulty) : course.difficulty || 'æœªçŸ¥'}</p>
                            <p><strong>è¯„åˆ†:</strong> ${course.rating || 'N/A'}</p>
                            <p>${course.description || 'æš‚æ— æè¿°'}</p>
                        </div>`;
                    });
                    
                    this.addIndependentSkillCategory('ğŸ“ æ¨èè¯¾ç¨‹', 'courses', coursesData, 'fas fa-graduation-cap');
                };
                
                // æ·»åŠ è¯ä¹¦æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamCertificates = function(certificates) {
                    if (!certificates || !Array.isArray(certificates) || certificates.length === 0) {
                        // ç”Ÿæˆé»˜è®¤è¯ä¹¦æ¨è
                        const jobTitle = this.currentJobInfo?.content || 'ä¸“ä¸šæŠ€èƒ½';
                        certificates = [
                            `${jobTitle}ç›¸å…³èŒä¸šè®¤è¯`,
                            'è¡Œä¸šæƒå¨è¯ä¹¦æ¨è',
                            'æŠ€èƒ½æå‡è®¤è¯è¯¾ç¨‹',
                            'ä¸“ä¸šèƒ½åŠ›ç­‰çº§è¯ä¹¦'
                        ];
                    }
                    
                    console.log('ğŸ† æ˜¾ç¤ºç›¸å…³è¯ä¹¦:', certificates);
                    this.addIndependentSkillCategory('ğŸ† ç›¸å…³è¯ä¹¦', 'certificates', certificates, 'fas fa-certificate');
                };
                
                // æ·»åŠ çŸ¥è¯†ç‚¹æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamKnowledge = function(knowledge) {
                    const knowledgeModule = document.getElementById('knowledgeModule');
                    const knowledgeContent = document.getElementById('knowledgeContent');
                    const knowledgeCount = document.getElementById('knowledgeCount');
                    
                    if (!knowledgeModule || !knowledgeContent) {
                        console.error('âš ï¸ çŸ¥è¯†ç‚¹æ¨¡å—å®¹å™¨ä¸å­˜åœ¨');
                        return;
                    }
                    
                    if (!knowledge || !Array.isArray(knowledge) || knowledge.length === 0) {
                        const jobTitle = this.currentJobInfo?.content || 'ä¸“ä¸šæŠ€èƒ½';
                        knowledge = [
                            `${jobTitle}åŸºç¡€ç†è®ºä¸æ¦‚å¿µ`,
                            'è¡Œä¸šæœ€ä½³å®è·µå’Œæ ‡å‡†',
                            'ç›¸å…³å·¥å…·å’ŒæŠ€æœ¯æ ˆ',
                            'å®é™…é¡¹ç›®åº”ç”¨æ¡ˆä¾‹'
                        ];
                    }
                    
                    console.log('ğŸ’¡ æ˜¾ç¤ºçŸ¥è¯†ç‚¹:', knowledge);
                    
                    const knowledgeHtml = knowledge.map((item, index) => {
                        const content = typeof item === 'string' ? item : item.content || item.title || 'æœªçŸ¥å†…å®¹';
                        return `<div class="knowledge-item"><div class="knowledge-number">${index + 1}</div><div class="knowledge-text">${content}</div></div>`;
                    }).join('');
                    
                    knowledgeContent.innerHTML = `<div class="knowledge-list">${knowledgeHtml}</div>`;
                    knowledgeCount.textContent = knowledge.length;
                    knowledgeModule.style.display = 'block';
                    
                    console.log(`âœ… çŸ¥è¯†ç‚¹æ¨¡å—æ˜¾ç¤ºå®Œæˆï¼ˆ${knowledge.length}ä¸ªé¡¹ç›®ï¼‰`);
                };
                
                // æ·»åŠ é¢è¯•é¢˜æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamExercises = function(exercises) {
                    const interviewModule = document.getElementById('interviewModule');
                    const interviewContent = document.getElementById('interviewContent');
                    const interviewCount = document.getElementById('interviewCount');
                    
                    if (!interviewModule || !interviewContent) {
                        console.error('âš ï¸ é¢è¯•é¢˜æ¨¡å—å®¹å™¨ä¸å­˜åœ¨');
                        return;
                    }
                    
                    if (!exercises || !Array.isArray(exercises) || exercises.length === 0) {
                        const jobTitle = this.currentJobInfo?.content || 'ä¸“ä¸šæŠ€èƒ½';
                        exercises = [
                            `è¯·ä»‹ç»æ‚¨å¯¹${jobTitle}å²—ä½çš„ç†è§£`,
                            `æ‚¨åœ¨${jobTitle}æ–¹é¢æœ‰å“ªäº›å®æˆ˜ç»éªŒï¼Ÿ`,
                            `å¦‚ä½•è§£å†³${jobTitle}å·¥ä½œä¸­çš„å¸¸è§é—®é¢˜ï¼Ÿ`,
                            `æè¿°ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„${jobTitle}é¡¹ç›®`,
                            `æ‚¨è®¤ä¸º${jobTitle}æœªæ¥çš„å‘å±•è¶‹åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ`
                        ];
                    }
                    
                    console.log('â“ æ˜¾ç¤ºé¢è¯•é¢˜:', exercises);
                    
                    // åˆ†ç±»é¢è¯•é¢˜
                    const categories = this.categorizeInterviewQuestions(exercises);
                    
                    // ç”Ÿæˆé¢è¯•é¢˜HTML
                    const interviewHtml = `
                        <div class="interview-header">
                            <div class="interview-stats">
                                <div class="stats-item">
                                    <span class="stats-number">${exercises.length}</span>
                                    <span class="stats-label">æ€»é¢˜ç›®</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-number">${categories.length}</span>
                                    <span class="stats-label">å·²åˆ†ç±»</span>
                                </div>
                            </div>
                            <div class="interview-description">
                                ç²¾é€‰ä¼ä¸šé«˜é¢‘é¢è¯•é¢˜ç›®ï¼ŒAIæ™ºèƒ½è¯„åˆ†åŠ©æ‚¨æå‡é¢è¯•è¡¨ç°
                            </div>
                        </div>
                        
                        <div class="interview-categories">
                            ${categories.map(category => `
                                <div class="interview-category">
                                    <div class="category-header">
                                        <div class="category-tags">
                                            <span class="category-tag primary">${category.type}</span>
                                            <span class="category-tag secondary">${category.level}</span>
                                        </div>
                                        <div class="category-meta">
                                            <span class="question-count">ğŸ‘ ${category.views}</span>
                                            <span class="difficulty-rating">â­ ${category.rating}</span>
                                            <span class="time-estimate">â° å»ºè®®ç”¨æ—¶ ${category.timeEstimate}</span>
                                        </div>
                                    </div>
                                    
                                    <div class="question-content">
                                        <h4 class="question-title">${category.question}</h4>
                                        <div class="question-description">
                                            ${category.description}
                                        </div>
                                    </div>
                                    
                                    <div class="question-actions">
                                        <button class="action-btn practice-btn" data-question="${category.question}">
                                            <i class="fas fa-comments"></i>
                                            ç»ƒä¹ ç­”æ¡ˆ
                                        </button>
                                        <button class="action-btn ai-btn" data-question="${category.question}">
                                            <i class="fas fa-robot"></i>
                                            AIè¯„åˆ†
                                        </button>
                                        <button class="action-btn favorite-btn">
                                            <i class="far fa-heart"></i>
                                        </button>
                                        <button class="action-btn bookmark-btn">
                                            <i class="far fa-bookmark"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    interviewContent.innerHTML = interviewHtml;
                    interviewCount.textContent = exercises.length;
                    interviewModule.style.display = 'block';
                    
                    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                    this.addInterviewEventListeners();
                    
                    console.log(`âœ… é¢è¯•é¢˜æ¨¡å—æ˜¾ç¤ºå®Œæˆï¼ˆ${exercises.length}ä¸ªé¡¹ç›®ï¼‰`);
                };
                
                // é¢è¯•é¢˜åˆ†ç±»æ–¹æ³•
                ui.categorizeInterviewQuestions = function(exercises) {
                    const questionTypes = ['åŸºç¡€ç†è®º', 'æŠ€æœ¯å®æˆ˜', 'é¡¹ç›®ç»éªŒ', 'é—®é¢˜è§£å†³', 'å‘å±•è§„åˆ’'];
                    const levels = ['åˆçº§', 'ä¸­çº§', 'é«˜çº§'];
                    
                    return exercises.map((question, index) => {
                        const typeIndex = index % questionTypes.length;
                        const levelIndex = Math.floor(index / 2) % levels.length;
                        
                        return {
                            question: question,
                            type: questionTypes[typeIndex],
                            level: levels[levelIndex],
                            views: (Math.floor(Math.random() * 3000) + 500).toLocaleString(),
                            rating: (4.0 + Math.random() * 0.9).toFixed(1),
                            timeEstimate: `${Math.floor(Math.random() * 8) + 3} åˆ†é’Ÿ`,
                            description: this.generateQuestionDescription(question)
                        };
                    });
                };
                
                // ç”Ÿæˆé¢˜ç›®æè¿°
                ui.generateQuestionDescription = function(question) {
                    // æ ¹æ®é—®é¢˜ç±»å‹ç”Ÿæˆç›¸åº”çš„æè¿°
                    if (question.includes('ç†è§£') || question.includes('ä»‹ç»')) {
                        return 'è€ƒå¯Ÿå¯¹æ ¸å¿ƒæ¦‚å¿µçš„ç†è§£å’Œæ•´ä½“è®¤çŸ¥èƒ½åŠ›';
                    } else if (question.includes('å®æˆ˜') || question.includes('ç»éªŒ')) {
                        return 'è¯„ä¼°å®é™…é¡¹ç›®ç»éªŒå’Œè§£å†³é—®é¢˜çš„èƒ½åŠ›';
                    } else if (question.includes('è®¾è®¡') || question.includes('æ¶æ„')) {
                        return 'æµ‹è¯•ç³»ç»Ÿè®¾è®¡å’Œæ¶æ„æ€ç»´èƒ½åŠ›';
                    } else if (question.includes('ä¼˜åŒ–') || question.includes('æ€§èƒ½')) {
                        return 'è€ƒå¯ŸæŠ€æœ¯æ·±åº¦å’Œä¼˜åŒ–æ€ç»´';
                    } else if (question.includes('å¾®æœåŠ¡') || question.includes('åˆ†å¸ƒå¼')) {
                        return 'è¯„ä¼°å¯¹å¤æ‚ç³»ç»Ÿæ¶æ„çš„ç†è§£èƒ½åŠ›';
                    } else {
                        return 'ç»¼åˆè€ƒå¯Ÿä¸“ä¸šæŠ€èƒ½å’Œè§£å†³é—®é¢˜çš„æ€è·¯';
                    }
                };
                
                // æ·»åŠ é¢è¯•é¢˜äº‹ä»¶ç›‘å¬å™¨
                ui.addInterviewEventListeners = function() {
                    // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†åŠ¨æ€æ·»åŠ çš„å…ƒç´ 
                    const interviewContent = document.getElementById('interviewContent');
                    if (!interviewContent) return;
                    
                    // ç»ƒä¹ ç­”æ¡ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
                    interviewContent.addEventListener('click', (e) => {
                        if (e.target.closest('.practice-btn')) {
                            const button = e.target.closest('.practice-btn');
                            const question = button.getAttribute('data-question');
                            console.log('ğŸ¯ ç‚¹å‡»ç»ƒä¹ ç­”æ¡ˆæŒ‰é’®:', question);
                            this.fillAIAssistantInput(question);
                            
                            // æ·»åŠ ç‚¹å‡»åé¦ˆ
                            button.style.transform = 'scale(0.95)';
                            setTimeout(() => {
                                button.style.transform = 'scale(1)';
                            }, 150);
                        }
                        
                        // AIè¯„åˆ†æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                        if (e.target.closest('.ai-btn')) {
                            const button = e.target.closest('.ai-btn');
                            const question = button.getAttribute('data-question');
                            console.log('ğŸ¤– ç‚¹å‡»AIè¯„åˆ†æŒ‰é’®:', question);
                            const aiPrompt = `è¯·å¸®æˆ‘åˆ†æè¿™é“é¢è¯•é¢˜çš„ç­”é¢˜è¦ç‚¹å’Œè¯„åˆ†æ ‡å‡†ï¼š${question}`;
                            this.fillAIAssistantInput(aiPrompt);
                            
                            // æ·»åŠ ç‚¹å‡»åé¦ˆ
                            button.style.transform = 'scale(0.95)';
                            setTimeout(() => {
                                button.style.transform = 'scale(1)';
                            }, 150);
                        }
                        
                        // æ”¶è—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                        if (e.target.closest('.favorite-btn')) {
                            const button = e.target.closest('.favorite-btn');
                            const icon = button.querySelector('i');
                            if (icon.classList.contains('far')) {
                                icon.classList.replace('far', 'fas');
                                icon.style.color = '#ef4444';
                                this.showToast('å·²æ·»åŠ åˆ°æ”¶è—å¤¹', 'success');
                            } else {
                                icon.classList.replace('fas', 'far');
                                icon.style.color = '';
                                this.showToast('å·²å–æ¶ˆæ”¶è—', 'info');
                            }
                        }
                        
                        // ä¹¦ç­¾æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                        if (e.target.closest('.bookmark-btn')) {
                            const button = e.target.closest('.bookmark-btn');
                            const icon = button.querySelector('i');
                            if (icon.classList.contains('far')) {
                                icon.classList.replace('far', 'fas');
                                icon.style.color = '#f59e0b';
                                this.showToast('å·²æ·»åŠ ä¹¦ç­¾', 'success');
                            } else {
                                icon.classList.replace('fas', 'far');
                                icon.style.color = '';
                                this.showToast('å·²å–æ¶ˆä¹¦ç­¾', 'info');
                            }
                        }
                    });
                    
                    console.log('âœ… é¢è¯•é¢˜äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
                };
                
                // å¡«å…¥AIåŠ©æ‰‹è¾“å…¥æ¡†çš„æ–¹æ³•
                ui.fillAIAssistantInput = function(text) {
                    const chatInput = document.getElementById('chatInput');
                    if (chatInput) {
                        chatInput.value = text;
                        chatInput.focus();
                        
                        // è§¦å‘inputäº‹ä»¶ä»¥æ›´æ–°å‘é€æŒ‰é’®çŠ¶æ€
                        const inputEvent = new Event('input', { bubbles: true });
                        chatInput.dispatchEvent(inputEvent);
                        
                        this.showToast('å†…å®¹å·²å¡«å…¥AIåŠ©æ‰‹ï¼Œå¯ä»¥ç›´æ¥æé—®ï¼', 'success');
                        console.log('âœ… å†…å®¹å·²å¡«å…¥AIåŠ©æ‰‹:', text);
                    } else {
                        console.warn('âš ï¸ æœªæ‰¾åˆ°AIåŠ©æ‰‹è¾“å…¥æ¡†');
                        this.showToast('æœªæ‰¾åˆ°AIåŠ©æ‰‹è¾“å…¥æ¡†', 'error');
                    }
                };
                
                // Toastæç¤ºæ–¹æ³•
                ui.showToast = function(message, type = 'info') {
                    const toast = document.getElementById('toast');
                    const toastMessage = toast?.querySelector('.toast-message');
                    const toastIcon = toast?.querySelector('.toast-icon');
                    
                    if (toast && toastMessage && toastIcon) {
                        // è®¾ç½®å›¾æ ‡
                        const icons = {
                            success: 'fas fa-check-circle',
                            error: 'fas fa-exclamation-circle',
                            warning: 'fas fa-exclamation-triangle',
                            info: 'fas fa-info-circle'
                        };
                        
                        toastIcon.className = `toast-icon ${icons[type] || icons.info}`;
                        toastMessage.textContent = message;
                        toast.className = `toast show toast-${type}`;
                        
                        // 3ç§’åè‡ªåŠ¨éšè—
                        setTimeout(() => {
                            toast.className = 'toast';
                        }, 3000);
                    }
                };
                
                // ä¿®æ”¹è¯¾ç¨‹æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamCourses = function(courses) {
                    const coursesModule = document.getElementById('coursesModule');
                    const coursesContent = document.getElementById('coursesContent');
                    const coursesCount = document.getElementById('coursesCount');
                    
                    if (!coursesModule || !coursesContent) {
                        console.error('âš ï¸ è¯¾ç¨‹æ¨¡å—å®¹å™¨ä¸å­˜åœ¨');
                        return;
                    }
                    
                    if (!courses || !Array.isArray(courses) || courses.length === 0) {
                        const jobTitle = this.currentJobInfo?.content || 'ä¸“ä¸šæŠ€èƒ½';
                        courses = [{
                            title: `${jobTitle}é›¶åŸºç¡€å…¥é—¨è¯¾ç¨‹`,
                            platform: 'Coursera',
                            difficulty: 'åˆçº§',
                            rating: '4.8',
                            students: '50,000+',
                            description: 'ä»é›¶å¼€å§‹å­¦ä¹ æ ¸å¿ƒæŠ€èƒ½'
                        }];
                    }
                    
                    console.log('ğŸ“ æ˜¾ç¤ºæ¨èè¯¾ç¨‹:', courses);
                    
                    const coursesHtml = courses.map((course, index) => {
                        const title = course.title || 'æœªå‘½åè¯¾ç¨‹';
                        const platform = course.platform || 'æœªçŸ¥å¹³å°';
                        const difficulty = course.difficulty || 'æœªçŸ¥';
                        const rating = course.rating || 'N/A';
                        const students = course.students || 'æœªçŸ¥';
                        const description = course.description || 'æš‚æ— æè¿°';
                        
                        return `<div class="course-item"><div class="course-number">${index + 1}</div><div class="course-info"><h4 class="course-title">${title}</h4><div class="course-meta"><span class="course-platform">ğŸ›ï¸ ${platform}</span><span class="course-difficulty">ğŸ¯ ${difficulty}</span><span class="course-rating">â­ ${rating}</span><span class="course-students">ğŸ‘¥ ${students}</span></div><p class="course-description">${description}</p></div></div>`;
                    }).join('');
                    
                    coursesContent.innerHTML = `<div class="courses-list">${coursesHtml}</div>`;
                    coursesCount.textContent = courses.length;
                    coursesModule.style.display = 'block';
                    
                    console.log(`âœ… è¯¾ç¨‹æ¨¡å—æ˜¾ç¤ºå®Œæˆï¼ˆ${courses.length}ä¸ªé¡¹ç›®ï¼‰`);
                };
                
                // ä¿®æ”¹è¯ä¹¦æ˜¾ç¤ºæ–¹æ³•
                ui.displayStreamCertificates = function(certificates) {
                    const certificatesModule = document.getElementById('certificatesModule');
                    const certificatesContent = document.getElementById('certificatesContent');
                    const certificatesCount = document.getElementById('certificatesCount');
                    
                    if (!certificatesModule || !certificatesContent) {
                        console.error('âš ï¸ è¯ä¹¦æ¨¡å—å®¹å™¨ä¸å­˜åœ¨');
                        return;
                    }
                    
                    if (!certificates || !Array.isArray(certificates) || certificates.length === 0) {
                        const jobTitle = this.currentJobInfo?.content || 'ä¸“ä¸šæŠ€èƒ½';
                        certificates = [{
                            name: `${jobTitle}ä¸“ä¸šè®¤è¯`,
                            provider: 'è¡Œä¸šæƒå¨æœºæ„',
                            difficulty: 'ä¸­çº§',
                            duration: '3-6ä¸ªæœˆ',
                            value: 'æå‡èŒä¸šç«äº‰åŠ›ï¼Œè·å¾—è¡Œä¸šè®¤å¯'
                        }];
                    }
                    
                    console.log('ğŸ† æ˜¾ç¤ºç›¸å…³è¯ä¹¦:', certificates);
                    
                    const certificatesHtml = certificates.map((cert, index) => {
                        const name = (typeof cert === 'string') ? cert : (cert.name || 'æœªçŸ¥è¯ä¹¦');
                        const provider = (typeof cert === 'object' && cert.provider) ? cert.provider : 'æœªçŸ¥æœºæ„';
                        const difficulty = (typeof cert === 'object' && cert.difficulty) ? cert.difficulty : 'æœªçŸ¥';
                        const duration = (typeof cert === 'object' && cert.duration) ? cert.duration : 'æœªçŸ¥';
                        const value = (typeof cert === 'object' && cert.value) ? cert.value : 'ä¸“ä¸šèƒ½åŠ›è®¤è¯';
                        
                        return `<div class="certificate-item"><div class="certificate-number">${index + 1}</div><div class="certificate-info"><h4 class="certificate-name">${name}</h4><div class="certificate-meta"><span class="certificate-provider">ğŸ¢ ${provider}</span><span class="certificate-difficulty">ğŸ¯ ${difficulty}</span><span class="certificate-duration">â° ${duration}</span></div><p class="certificate-value">${value}</p></div></div>`;
                    }).join('');
                    
                    certificatesContent.innerHTML = `<div class="certificates-list">${certificatesHtml}</div>`;
                    certificatesCount.textContent = certificates.length;
                    certificatesModule.style.display = 'block';
                    
                    console.log(`âœ… è¯ä¹¦æ¨¡å—æ˜¾ç¤ºå®Œæˆï¼ˆ${certificates.length}ä¸ªé¡¹ç›®ï¼‰`);
                };
                
                // æ¢å¤æ€ç»´å¯¼å›¾æ˜¾ç¤ºæ–¹æ³• - è¿™æ˜¯æ ¸å¿ƒåŠŸèƒ½ä¸èƒ½åˆ é™¤ï¼
                ui.displayStreamMindmap = function(mindmap) {
                    if (!mindmap) {
                        console.warn('âš ï¸ æ€ç»´å¯¼å›¾æ•°æ®ä¸ºç©º');
                        return;
                    }
                    
                    console.log('ğŸ§  æ˜¾ç¤ºæ€ç»´å¯¼å›¾:', mindmap);
                    
                    // å¤„ç†æ€ç»´å¯¼å›¾æ˜¾ç¤º
                    if (this.mindmapContent) {
                        let content = '';
                        if (mindmap.html) {
                            content = mindmap.html;
                        } else if (mindmap.content) {
                            content = `
                                <div class="mindmap-container">
                                    <div class="mindmap-fallback">
                                        <h3>${mindmap.title || 'å­¦ä¹ æ€ç»´å¯¼å›¾'}</h3>
                                        <div class="mindmap-tree">
                                            ${this.convertMarkdownToTree ? this.convertMarkdownToTree(mindmap.content) : mindmap.content}
                                        </div>
                                        <div class="mindmap-info">
                                            <p><strong>ğŸ§  çœŸå®AIç”Ÿæˆçš„æ€ç»´å¯¼å›¾ï¼š</strong></p>
                                            <ul>
                                                <li>â€¢ åŸºäºå¤§æ¨¡å‹åˆ†æç”Ÿæˆ</li>
                                                <li>â€¢ ä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„æ¨è</li>
                                                <li>â€¢ ç»“åˆèŒä½éœ€æ±‚ä¸å­¦ä¹ ç›®æ ‡</li>
                                                <li>â€¢ æ™ºèƒ½åŒ–å­¦ä¹ è®¡åˆ’å®šåˆ¶</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }
                        
                        this.mindmapContent.innerHTML = content;
                        
                        // æ›´æ–°æ€ç»´å¯¼å›¾çŠ¶æ€
                        const mindmapStatus = document.getElementById('mindmapStatus');
                        if (mindmapStatus) {
                            mindmapStatus.textContent = 'å®Œæˆ';
                            mindmapStatus.className = 'card-status completed';
                        }
                    }
                };
                
                ui.showStreamResults = function(streamData) {
                    console.log('ğŸ‰ æ˜¾ç¤ºæµå¼ç»“æœ:', streamData);
                    
                    // éšè—åŠ è½½çŠ¶æ€
                    if (this.loadingSection) {
                        this.loadingSection.style.display = 'none';
                    }
                    
                    // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                    if (this.resultsSection) {
                        this.resultsSection.style.display = 'block';
                    }
                    
                    // æ›´æ–°èŒä½æ˜¾ç¤º
                    if (this.topicDisplay) {
                        this.topicDisplay.textContent = this.currentJobInfo.content;
                    }
                    
                    // æ›´æ–°ç”Ÿæˆæ—¶é—´
                    if (this.generationTime) {
                        this.generationTime.textContent = new Date().toLocaleString();
                    }
                    
                    this.addLog && this.addLog('success', 'âœ… å­¦ä¹ æ–¹æ¡ˆç”Ÿæˆå®Œæˆ');
                };
                
                // æ·»åŠ éš¾åº¦ç¿»è¯‘æ–¹æ³•
                ui.translateDifficulty = function(difficulty) {
                    const difficultyMap = {
                        'beginner': 'åˆçº§',
                        'intermediate': 'ä¸­çº§', 
                        'advanced': 'é«˜çº§',
                        'expert': 'ä¸“å®¶çº§',
                        'unknown': 'æœªçŸ¥'
                    };
                    return difficultyMap[difficulty] || 'æœªçŸ¥';
                };
                
                // æ·»åŠ è¾…åŠ©ç”Ÿæˆæ–¹æ³•
                ui.generateInterviewQuestions = function(phaseName) {
                    return [
                        `${phaseName}ç›¸å…³çš„æ ¸å¿ƒé—®é¢˜`,
                        `å®é™…åº”ç”¨åœºæ™¯é¢è¯•é¢˜`,
                        `é—®é¢˜è§£å†³æ€è·¯åˆ†æ`
                    ];
                };
                
                ui.generateBookRecommendations = function(phaseName) {
                    return [
                        `${phaseName}ç›¸å…³ä¸“ä¸šä¹¦ç±`,
                        `å®æˆ˜æŒ‡å—å’Œæœ€ä½³å®è·µ`
                    ];
                };
                
                ui.generateCertificates = function(phaseName) {
                    return [
                        `${phaseName}ç›¸å…³èŒä¸šè®¤è¯`,
                        `è¡Œä¸šæƒå¨è¯ä¹¦æ¨è`
                    ];
                };
                
                ui.generateCourses = function(phaseName) {
                    return [
                        `${phaseName}åœ¨çº¿å­¦ä¹ è¯¾ç¨‹`,
                        `å®æˆ˜é¡¹ç›®æ•™ç¨‹`
                    ];
                };
                
                // æ·»åŠ è·å–å­˜å‚¨çš„APIå¯†é’¥æ–¹æ³•
                ui.getStoredApiKey = function() {
                    return localStorage.getItem('ai_learning_companion_api_key') || '';
                };
                
                // æ·»åŠ æ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹
                ui.simulateGeneration = async function() {
                    console.log('ğŸ“Š æ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹å¼€å§‹');
                    
                    // æ›´æ–°è¿›åº¦æ¡å’Œæ­¥éª¤
                    await this.updateProgressWithSteps([
                        { step: 1, progress: 20, message: 'åˆ†æèŒä½æŠ€èƒ½éœ€æ±‚...' },
                        { step: 2, progress: 40, message: 'ç”Ÿæˆæ ¸å¿ƒçŸ¥è¯†ç‚¹...' },
                        { step: 3, progress: 60, message: 'æ•´ç†é«˜é¢‘é¢è¯•é¢˜...' },
                        { step: 4, progress: 80, message: 'æ¨èå­¦ä¹ èµ„æº...' },
                        { step: 5, progress: 100, message: 'ç”Ÿæˆæ€ç»´å¯¼å›¾...' }
                    ]);
                    
                    // æ˜¾ç¤ºç»“æœ
                    this.showResults();
                };
                
                // æ·»åŠ è¿›åº¦æ›´æ–°æ–¹æ³•
                ui.updateProgressWithSteps = async function(steps) {
                    for (const stepData of steps) {
                        // æ›´æ–°å½“å‰æ­¥éª¤çŠ¶æ€
                        this.updateStepStatus(stepData.step, 'active');
                        
                        // æ›´æ–°è¿›åº¦æ¡
                        this.updateProgressBar(stepData.progress);
                        
                        // æ›´æ–°åŠ è½½æ ‡é¢˜
                        this.updateLoadingTitle(stepData.message);
                        
                        // æ·»åŠ æ—¥å¿—
                        this.addLog && this.addLog('info', `ğŸ”„ ${stepData.message}`);
                        
                        // ç­‰å¾…ä¸€æ®µæ—¶é—´æ¨¡æ‹Ÿå¤„ç†
                        await this.sleep(1200);
                        
                        // æ ‡è®°æ­¥éª¤ä¸ºå®Œæˆ
                        this.updateStepStatus(stepData.step, 'completed');
                    }
                };
                
                // æ·»åŠ æ­¥éª¤çŠ¶æ€æ›´æ–°æ–¹æ³•
                ui.updateStepStatus = function(stepNumber, status) {
                    const stepElement = document.getElementById(`step${stepNumber}`);
                    if (stepElement) {
                        stepElement.className = `step ${status}`;
                    }
                };
                
                // æ·»åŠ è¿›åº¦æ¡æ›´æ–°æ–¹æ³•
                ui.updateProgressBar = function(progress) {
                    const progressBar = document.querySelector('.progress-bar');
                    const progressText = document.querySelector('.progress-text');
                    
                    if (progressBar) {
                        progressBar.style.width = `${progress}%`;
                    }
                    if (progressText) {
                        progressText.textContent = `${progress}%`;
                    }
                };
                
                // æ·»åŠ åŠ è½½æ ‡é¢˜æ›´æ–°æ–¹æ³•
                ui.updateLoadingTitle = function(message) {
                    const loadingTitle = document.querySelector('.loading-title');
                    if (loadingTitle) {
                        loadingTitle.textContent = message;
                    }
                };
                
                // æ·»åŠ ç¡çœ æ–¹æ³•
                ui.sleep = function(ms) {
                    return new Promise(resolve => setTimeout(resolve, ms));
                };
                
                // æ·»åŠ æ˜¾ç¤ºç»“æœæ–¹æ³•
                ui.showResults = function() {
                    // éšè—åŠ è½½çŠ¶æ€
                    if (this.loadingSection) {
                        this.loadingSection.style.display = 'none';
                    }
                    
                    // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                    if (this.resultsSection) {
                        this.resultsSection.style.display = 'block';
                    }
                    
                    // æ›´æ–°ç»“æœä¿¡æ¯
                    if (this.topicDisplay && this.currentJobInfo) {
                        this.topicDisplay.textContent = this.currentJobInfo.content;
                    }
                    if (this.generationTime) {
                        this.generationTime.textContent = new Date().toLocaleString();
                    }
                    
                    this.addLog && this.addLog('info', 'âœ… å­¦ä¹ èµ„æ–™æ˜¾ç¤ºå®Œæˆ');
                    
                    // æ³¨æ„ï¼šä¸åœ¨è¿™é‡Œç”Ÿæˆæ•°æ®ï¼Œæ•°æ®åœ¨callRealAPIä¸­å¤„ç†
                };
                
                // æ·»åŠ ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®æ–¹æ³•
                ui.generateMockData = function() {
                    if (!this.skillsContainer) return;
                    
                    // ç”ŸæˆåŸºäºèŒä½çš„æŠ€èƒ½åˆ†ç±»æ•°æ®
                    const jobTitle = this.currentJobInfo?.content || 'å‰ç«¯å·¥ç¨‹å¸ˆ';
                    const mockSkills = this.generateJobSpecificSkills(jobTitle);
                    
                    this.skillsContainer.innerHTML = '';
                    
                    // ç”ŸæˆæŠ€èƒ½åˆ†ç±»
                    mockSkills.forEach(skill => {
                        this.addSkillCategory(skill.name, skill.content);
                    });
                    
                    // ç”Ÿæˆæ€ç»´å¯¼å›¾
                    this.generateMindmapForJob(jobTitle, mockSkills);
                    
                    this.addLog && this.addLog('info', 'ğŸ“ˆ èŒä½å­¦ä¹ èµ„æ–™å·²ç”Ÿæˆ');
                };
                
                // æ·»åŠ åŸºäºèŒä½çš„æŠ€èƒ½ç”Ÿæˆæ–¹æ³•
                ui.generateJobSpecificSkills = function(jobTitle) {
                    const skillTemplates = {
                        'å‰ç«¯å·¥ç¨‹å¸ˆ': [
                            {
                                name: 'HTML/CSS åŸºç¡€æŠ€èƒ½',
                                content: {
                                    knowledge: ['HTML5 è¯­ä¹‰åŒ–æ ‡ç­¾', 'CSS3 å¸ƒå±€æŠ€æœ¯', 'å“åº”å¼è®¾è®¡', 'Flexbox å’Œ Grid'],
                                    interview: ['CSS é€‰æ‹©å™¨ä¼˜å…ˆçº§', 'BFC åŸç†å’Œåº”ç”¨', 'æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†'],
                                    books: ['ã€ŠCSS æ­ç§˜ã€‹', 'ã€ŠHTML5 ç¨‹åºè®¾è®¡ã€‹'],
                                    certificates: ['å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆè®¤è¯'],
                                    courses: ['CSS é«˜çº§å¸ƒå±€æŠ€æœ¯', 'HTML5 å®æˆ˜é¡¹ç›®']
                                }
                            },
                            {
                                name: 'JavaScript æ ¸å¿ƒæŠ€æœ¯',
                                content: {
                                    knowledge: ['ES6+ æ–°ç‰¹æ€§', 'å¼‚æ­¥ç¼–ç¨‹', 'åŸå‹é“¾å’Œç»§æ‰¿', 'æ¨¡å—åŒ–å¼€å‘'],
                                    interview: ['é—­åŒ…å’Œä½œç”¨åŸŸ', 'äº‹ä»¶å¾ªç¯æœºåˆ¶', 'Promise å’Œ async/await', 'é˜²æŠ–å’ŒèŠ‚æµ'],
                                    books: ['ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹', 'ã€Šä½ ä¸çŸ¥é“çš„ JavaScriptã€‹'],
                                    certificates: ['JavaScript å¼€å‘è€…è®¤è¯'],
                                    courses: ['JavaScript è¿›é˜¶æ•™ç¨‹', 'ES6+ å®æˆ˜åº”ç”¨']
                                }
                            },
                            {
                                name: 'å‰ç«¯æ¡†æ¶',
                                content: {
                                    knowledge: ['React/Vue æ ¸å¿ƒåŸç†', 'ç»„ä»¶åŒ–å¼€å‘', 'çŠ¶æ€ç®¡ç†', 'è·¯ç”±ç³»ç»Ÿ'],
                                    interview: ['è™šæ‹ŸDOM åŸç†', 'ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ', 'Redux/Vuex çŠ¶æ€ç®¡ç†', 'æ€§èƒ½ä¼˜åŒ–æŠ€å·§'],
                                    books: ['ã€ŠReact è¿›é˜¶ä¹‹é“ã€‹', 'ã€ŠVue.js å®æˆ˜ã€‹'],
                                    certificates: ['React å¼€å‘è€…è®¤è¯', 'Vue.js ä¸“ä¸šè®¤è¯'],
                                    courses: ['React å…¨å®¶æ¡¶å®æˆ˜', 'Vue3 ä¼ä¸šçº§åº”ç”¨å¼€å‘']
                                }
                            }
                        ],
                        'åç«¯å·¥ç¨‹å¸ˆ': [
                            {
                                name: 'Java æ ¸å¿ƒæŠ€æœ¯',
                                content: {
                                    knowledge: ['Java åŸºç¡€è¯­æ³•', 'é¢å‘å¯¹è±¡ç¼–ç¨‹', 'é›†åˆæ¡†æ¶', 'å¤šçº¿ç¨‹ç¼–ç¨‹'],
                                    interview: ['JVM å†…å­˜æ¨¡å‹', 'åƒåœ¾å›æ”¶æœºåˆ¶', 'çº¿ç¨‹åŒæ­¥å’Œé”', 'Spring æ¡†æ¶åŸç†'],
                                    books: ['ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹', 'ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹'],
                                    certificates: ['Oracle Java è®¤è¯', 'Spring ä¸“ä¸šè®¤è¯'],
                                    courses: ['Java é«˜çº§ç¼–ç¨‹', 'Spring Boot å¾®æœåŠ¡å¼€å‘']
                                }
                            },
                            {
                                name: 'æ•°æ®åº“æŠ€æœ¯',
                                content: {
                                    knowledge: ['MySQL æ•°æ®åº“è®¾è®¡', 'SQL æŸ¥è¯¢ä¼˜åŒ–', 'Redis ç¼“å­˜æŠ€æœ¯', 'æ•°æ®åº“äº‹åŠ¡'],
                                    interview: ['æ•°æ®åº“ç´¢å¼•åŸç†', 'ACID ç‰¹æ€§', 'ä¸»ä»å¤åˆ¶', 'åˆ†åº“åˆ†è¡¨ç­–ç•¥'],
                                    books: ['ã€ŠMySQL å¿…çŸ¥å¿…ä¼šã€‹', 'ã€Šé«˜æ€§èƒ½ MySQLã€‹'],
                                    certificates: ['MySQL DBA è®¤è¯', 'Redis ä¸“ä¸šè®¤è¯'],
                                    courses: ['MySQL æ€§èƒ½ä¼˜åŒ–', 'Redis å®æˆ˜åº”ç”¨']
                                }
                            }
                        ],
                        'AIå·¥ç¨‹å¸ˆ': [
                            {
                                name: 'Python ä¸æœºå™¨å­¦ä¹ ',
                                content: {
                                    knowledge: ['Python åŸºç¡€è¯­æ³•', 'NumPy å’Œ Pandas', 'Scikit-learn', 'æ·±åº¦å­¦ä¹ æ¡†æ¶'],
                                    interview: ['æœºå™¨å­¦ä¹ ç®—æ³•åŸç†', 'ç¥ç»ç½‘ç»œæ¶æ„', 'æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–', 'è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–'],
                                    books: ['ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹', 'ã€Šæ·±åº¦å­¦ä¹ ã€‹'],
                                    certificates: ['TensorFlow å¼€å‘è€…è®¤è¯', 'AWS ML ä¸“ä¸šè®¤è¯'],
                                    courses: ['TensorFlow å®æˆ˜', 'PyTorch æ·±åº¦å­¦ä¹ ']
                                }
                            }
                        ],
                        'äº§å“ç»ç†': [
                            {
                                name: 'äº§å“è®¾è®¡ä¸ç®¡ç†',
                                content: {
                                    knowledge: ['ç”¨æˆ·éœ€æ±‚åˆ†æ', 'äº§å“è®¾è®¡æ–¹æ³•', 'æ•°æ®åˆ†æ', 'é¡¹ç›®ç®¡ç†'],
                                    interview: ['äº§å“ç”Ÿå‘½å‘¨æœŸç®¡ç†', 'ç”¨æˆ·ä½“éªŒè®¾è®¡', 'A/B æµ‹è¯•', 'ç«å“åˆ†æ'],
                                    books: ['ã€Šäººäººéƒ½æ˜¯äº§å“ç»ç†ã€‹', 'ã€Šç²¾ç›Šåˆ›ä¸šã€‹'],
                                    certificates: ['PMP é¡¹ç›®ç®¡ç†è®¤è¯', 'äº§å“ç»ç†ä¸“ä¸šè®¤è¯'],
                                    courses: ['äº§å“ç»ç†å®æˆ˜', 'ç”¨æˆ·ä½“éªŒè®¾è®¡']
                                }
                            }
                        ]
                    };
                    
                    // æŸ¥æ‰¾åŒ¹é…çš„æŠ€èƒ½æ¨¡æ¿
                    for (const [job, skills] of Object.entries(skillTemplates)) {
                        if (jobTitle.includes(job)) {
                            return skills;
                        }
                    }
                    
                    // é»˜è®¤è¿”å›é€šç”¨æŠ€èƒ½
                    return [
                        {
                            name: 'æŠ€èƒ½åŸºç¡€',
                            content: {
                                knowledge: ['ä¸“ä¸šæŠ€èƒ½åŸºç¡€', 'è¡Œä¸šçŸ¥è¯†ä½“ç³»', 'å®é™…é¡¹ç›®ç»éªŒ'],
                                interview: ['ä¸“ä¸šèƒ½åŠ›é¢è¯•é¢˜', 'å·¥ä½œç»éªŒåˆ†äº«', 'é—®é¢˜è§£å†³èƒ½åŠ›'],
                                books: ['è¡Œä¸šç›¸å…³ä¹¦ç±æ¨è'],
                                certificates: ['èŒä¸šè®¤è¯æ¨è'],
                                courses: ['åœ¨çº¿å­¦ä¹ è¯¾ç¨‹']
                            }
                        }
                    ];
                };
                
                // æ·»åŠ æŠ€èƒ½åˆ†ç±»æ–¹æ³•
                ui.addSkillCategory = function(skillName, contentData) {
                    if (!this.skillsContainer) return;
                    
                    const skillDiv = document.createElement('div');
                    skillDiv.className = 'skill-category';
                    skillDiv.innerHTML = `
                        <div class="skill-header" onclick="this.parentElement.classList.toggle('collapsed')">
                            <h3 class="skill-title">
                                <i class="fas fa-code"></i>
                                ${skillName}
                            </h3>
                            <i class="fas fa-chevron-down skill-toggle"></i>
                        </div>
                        <div class="skill-content">
                            <div class="content-types"></div>
                        </div>
                    `;
                    
                    const contentTypesDiv = skillDiv.querySelector('.content-types');
                    
                    // æ·»åŠ å„ç±»å‹å†…å®¹
                    this.selectedContentTypes.forEach(type => {
                        if (contentData[type]) {
                            const typeDiv = document.createElement('div');
                            typeDiv.className = 'content-type';
                            typeDiv.innerHTML = `
                                <div class="content-type-header">
                                    <i class="${this.getContentTypeIcon(type)}"></i>
                                    ${this.getContentTypeName(type)}
                                </div>
                                <div class="content-type-body">
                                    ${this.renderContentItems(contentData[type])}
                                </div>
                            `;
                            contentTypesDiv.appendChild(typeDiv);
                        }
                    });
                    
                    this.skillsContainer.appendChild(skillDiv);
                };
                
                // æ·»åŠ æ€ç»´å¯¼å›¾ç”Ÿæˆæ–¹æ³•
                ui.generateMindmapForJob = function(jobTitle, skills) {
                    if (!this.mindmapContent) return;
                    
                    // ç”Ÿæˆ Markdown å†…å®¹
                    let markdownContent = `# ${jobTitle} å­¦ä¹ è·¯çº¿\n\n`;
                    
                    skills.forEach(skill => {
                        markdownContent += `## ${skill.name}\n\n`;
                        
                        this.selectedContentTypes.forEach(type => {
                            if (skill.content[type]) {
                                markdownContent += `### ${this.getContentTypeName(type)}\n`;
                                skill.content[type].forEach(item => {
                                    markdownContent += `- ${item}\n`;
                                });
                                markdownContent += '\n';
                            }
                        });
                    });
                    
                    // æ˜¾ç¤ºæ€ç»´å¯¼å›¾
                    this.mindmapContent.innerHTML = `
                        <div class="mindmap-container">
                            <div class="mindmap-fallback">
                                <h3>${jobTitle} å­¦ä¹ æ€ç»´å¯¼å›¾</h3>
                                <div class="mindmap-tree">
                                    ${this.convertMarkdownToTree(markdownContent)}
                                </div>
                                <div class="mindmap-info">
                                    <p><strong>ğŸ§  æ€ç»´å¯¼å›¾åŠŸèƒ½è¯´æ˜ï¼š</strong></p>
                                    <ul>
                                        <li>â€¢ åŸºäº ModelScope Markmap MCP æœåŠ¡å™¨ç”Ÿæˆ</li>
                                        <li>â€¢ å°† Markdown å†…å®¹è½¬æ¢ä¸ºå¯è§†åŒ–æ€ç»´å¯¼å›¾</li>
                                        <li>â€¢ æ”¯æŒäº¤äº’å¼å±•å¼€ã€æŠ˜å ã€ç¼©æ”¾åŠŸèƒ½</li>
                                        <li>â€¢ å¸®åŠ©ç†è§£å­¦ä¹ ç»“æ„å’ŒçŸ¥è¯†å…³è”</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // æ›´æ–°æ€ç»´å¯¼å›¾çŠ¶æ€
                    const mindmapStatus = document.getElementById('mindmapStatus');
                    if (mindmapStatus) {
                        mindmapStatus.textContent = 'å®Œæˆ';
                        mindmapStatus.className = 'card-status completed';
                    }
                };
                
                // æ·»åŠ  Markdown è½¬æ ‘å½¢ç»“æ„æ–¹æ³•
                ui.convertMarkdownToTree = function(markdown) {
                    const lines = markdown.split('\n').filter(line => line.trim());
                    let html = '<div class="mindmap-tree">';
                    let currentLevel = 0;
                    
                    lines.forEach(line => {
                        const level = (line.match(/^#+/) || [''])[0].length;
                        const text = line.replace(/^#+\s*/, '').trim();
                        
                        if (level > 0) {
                            const indent = (level - 1) * 20;
                            html += `<div class="mindmap-node level-${level}" style="margin-left: ${indent}px;">
                                <div class="node-text">${text}</div>
                            </div>`;
                        } else if (line.startsWith('- ')) {
                            const text = line.replace(/^-\s*/, '').trim();
                            html += `<div class="mindmap-node level-item" style="margin-left: 40px;">
                                <div class="node-text">â€¢ ${text}</div>
                            </div>`;
                        }
                    });
                    
                    html += '</div>';
                    return html;
                };
                
                // æ·»åŠ å†…å®¹ç±»å‹å›¾æ ‡å’Œåç§°æ–¹æ³•
                ui.getContentTypeIcon = function(type) {
                    const icons = {
                        knowledge: 'fas fa-lightbulb',
                        interview: 'fas fa-question-circle',
                        books: 'fas fa-book',
                        certificates: 'fas fa-certificate',
                        courses: 'fas fa-graduation-cap'
                    };
                    return icons[type] || 'fas fa-file';
                };
                
                ui.getContentTypeName = function(type) {
                    const names = {
                        knowledge: 'çŸ¥è¯†ç‚¹',
                        interview: 'é«˜é¢‘é¢è¯•é¢˜',
                        books: 'æ¨èä¹¦ç±',
                        certificates: 'è¯ä¹¦',
                        courses: 'æ¨èè¯¾ç¨‹'
                    };
                    return names[type] || 'æœªçŸ¥ç±»å‹';
                };
                
                // åˆå§‹åŒ–æ—¶æ›´æ–°æŒ‰é’®çŠ¶æ€
                setTimeout(() => {
                    ui.updateGenerateButton && ui.updateGenerateButton();
                    // è¿æ¥åˆ°æœåŠ¡å™¨å®æ—¶æ—¥å¿—æµ
                    ui.connectToLogStream && ui.connectToLogStream();
                    
                    // å¼ºåˆ¶ä¿®å¤æŒ‰é’®çŠ¶æ€ï¼ˆç¡®ä¿æŒ‰é’®å¯ç‚¹å‡»ï¼‰
                    const jobTitle = document.getElementById('jobTitle');
                    const generateBtn = document.getElementById('generateBtn');
                    
                    if (jobTitle && generateBtn && jobTitle.value.trim().length > 0) {
                        console.log('ğŸ”§ å¼ºåˆ¶ä¿®å¤æŒ‰é’®çŠ¶æ€...');
                        generateBtn.disabled = false;
                        generateBtn.style.opacity = '1';
                        generateBtn.style.cursor = 'pointer';
                        generateBtn.style.pointerEvents = 'auto';
                        console.log('âœ… æŒ‰é’®å·²å¼ºåˆ¶å¯ç”¨');
                    }
                }, 100);
                
                console.log('âœ“ èŒé€”åŠ©æ‰‹è¡¥å……æ–¹æ³•å·²åŠ è½½');
                
                // æ·»åŠ æµ‹è¯•äº”ä¸ªç‹¬ç«‹æ¨¡å—çš„å‡½æ•°
                ui.testIndependentModules = function() {
                    console.log('ğŸ—ºï¸ æµ‹è¯•äº”ä¸ªç‹¬ç«‹æ¨¡å—å±•ç¤º');
                    
                    // è®¾ç½®æµ‹è¯•èŒä½ä¿¡æ¯
                    this.currentJobInfo = { content: 'åç«¯å·¥ç¨‹å¸ˆ' };
                    
                    // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                    if (this.resultsSection) {
                        this.resultsSection.style.display = 'block';
                    }
                    
                    // æ›´æ–°èŒä½æ˜¾ç¤º
                    if (this.topicDisplay) {
                        this.topicDisplay.textContent = 'åç«¯å·¥ç¨‹å¸ˆ - æµ‹è¯•æ¨¡å—';
                    }
                    
                    // æ›´æ–°ç”Ÿæˆæ—¶é—´
                    if (this.generationTime) {
                        this.generationTime.textContent = new Date().toLocaleString();
                    }
                    
                    // 1. æµ‹è¯•çŸ¥è¯†ç‚¹æ¨¡å—
                    this.displayStreamKnowledge([
                        'åç«¯å·¥ç¨‹å¸ˆåŸºç¡€ç†è®ºä¸æ¦‚å¿µ',
                        'è¡Œä¸šæœ€ä½³å®è·µå’Œæ ‡å‡†',
                        'ç›¸å…³å·¥å…·å’ŒæŠ€æœ¯æ ˆ',
                        'å®é™…é¡¹ç›®åº”ç”¨æ¡ˆä¾‹'
                    ]);
                    
                    // 2. æµ‹è¯•é¢è¯•é¢˜æ¨¡å—
                    this.displayStreamExercises([
                        'è¯·ä»‹ç»æ‚¨å¯¹åç«¯å·¥ç¨‹å¸ˆå²—ä½çš„ç†è§£',
                        'æ‚¨åœ¨åç«¯å¼€å‘æ–¹é¢æœ‰å“ªäº›å®æˆ˜ç»éªŒï¼Ÿ',
                        'å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘çš„åç«¯ç³»ç»Ÿï¼Ÿ',
                        'æè¿°ä¸€ä¸ªå¤æ‚çš„æ•°æ®åº“ä¼˜åŒ–é¡¹ç›®',
                        'æ‚¨å¯¹å¾®æœåŠ¡æ¶æ„æœ‰ä»€ä¹ˆç†è§£ï¼Ÿ',
                        'å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„äº‹åŠ¡ï¼Ÿ'
                    ]);
                    
                    // 3. æµ‹è¯•ä¹¦ç±æ¨¡å—
                    this.displayStreamNotes({
                        keyPoints: [
                            'ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ - å‘¨å¿—å',
                            'ã€Šæ·±åº¦å­¦ä¹ ã€‹ - Ian Goodfellow',
                            'ã€ŠPythonæœºå™¨å­¦ä¹ ã€‹ - Sebastian Raschka',
                            'ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ - æèˆª'
                        ]
                    });
                    
                    // 4. æµ‹è¯•è¯¾ç¨‹æ¨¡å—
                    this.displayStreamCourses([
                        {
                            title: 'æœºå™¨å­¦ä¹ å…¥é—¨ä¸å®æˆ˜',
                            platform: 'Coursera',
                            difficulty: 'åˆçº§',
                            rating: '4.8',
                            students: '50,000+',
                            description: 'ç”±æ–¯å¦ç¦å¤§å­¦æä¾›çš„æœºå™¨å­¦ä¹ ç»å…¸è¯¾ç¨‹'
                        },
                        {
                            title: 'æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œ',
                            platform: 'Udemy',
                            difficulty: 'ä¸­çº§',
                            rating: '4.6',
                            students: '25,000+',
                            description: 'ä»åŸºç¡€åˆ°é«˜çº§çš„æ·±åº¦å­¦ä¹ å®æˆ˜è¯¾ç¨‹'
                        }
                    ]);
                    
                    // 5. æµ‹è¯•è¯ä¹¦æ¨¡å—
                    this.displayStreamCertificates([
                        {
                            name: 'TensorFlowå¼€å‘è€…è®¤è¯',
                            provider: 'Google',
                            difficulty: 'ä¸­çº§',
                            duration: '3-6ä¸ªæœˆ',
                            value: 'è°·æ­Œå®˜æ–¹è®¤è¯ï¼Œè¡Œä¸šæƒå¨æ€§é«˜'
                        },
                        {
                            name: 'AWSæœºå™¨å­¦ä¹ ä¸“å®¶è®¤è¯',
                            provider: 'Amazon',
                            difficulty: 'é«˜çº§',
                            duration: '6-12ä¸ªæœˆ',
                            value: 'äº‘å¹³å°MLé¢†åŸŸé¡¶çº§è®¤è¯'
                        }
                    ]);
                    
                    this.addLog && this.addLog('success', 'âœ… äº”ä¸ªç‹¬ç«‹æ¨¡å—æµ‹è¯•å®Œæˆ');
                    console.log('âœ… äº”ä¸ªç‹¬ç«‹æ¨¡å—æµ‹è¯•å®Œæˆ');
                };
                
                // æ·»åŠ ç›´æ¥çš„è¾“å…¥ç›‘å¬å™¨ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
                const jobTitleInput = document.getElementById('jobTitle');
                const generateButton = document.getElementById('generateBtn');
                const testModulesBtn = document.getElementById('testModulesBtn');
                
                // ç»‘å®šæµ‹è¯•æ¨¡å—æŒ‰é’®
                if (testModulesBtn) {
                    testModulesBtn.addEventListener('click', () => {
                        console.log('ğŸ—ºï¸ ç‚¹å‡»æµ‹è¯•æ¨¡å—æŒ‰é’®');
                        ui.testIndependentModules();
                    });
                }
                
                if (jobTitleInput && generateButton) {
                    jobTitleInput.addEventListener('input', function() {
                        const hasValue = this.value.trim().length > 0;
                        console.log('ğŸ“ è¾“å…¥å˜åŒ–ï¼Œæ›´æ–°æŒ‰é’®:', hasValue);
                        
                        generateButton.disabled = !hasValue;
                        generateButton.style.opacity = hasValue ? '1' : '0.6';
                        generateButton.style.cursor = hasValue ? 'pointer' : 'not-allowed';
                    });
                    
                    // ç«‹å³æ£€æŸ¥åˆå§‹çŠ¶æ€
                    const hasInitialValue = jobTitleInput.value.trim().length > 0;
                    if (hasInitialValue) {
                        generateButton.disabled = false;
                        generateButton.style.opacity = '1';
                        generateButton.style.cursor = 'pointer';
                        console.log('âœ… åˆå§‹æ£€æŸ¥ï¼šæŒ‰é’®å·²å¯ç”¨');
                    }
                    }
                }
        
        // æ·»åŠ æ—¥å¿—æµè¿æ¥åŠŸèƒ½åˆ° UI å®ä¾‹
        function initializeLogStream() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–
            if (window._logStreamSetup) {
                return;
            }
            window._logStreamSetup = true;
            
            let initAttempts = 0;
            const maxAttempts = 10;
            
            function tryInit() {
                initAttempts++;
                if (initAttempts > maxAttempts) {
                    console.log('ğŸ“‹ å·²è¾¾åˆ°æœ€å¤§åˆå§‹åŒ–å°è¯•æ¬¡æ•°');
                    return;
                }
                
                // ç­‰å¾…ä¸»ç±»åŠ è½½å®Œæˆ
                if (window.jobAssistantUI && window.jobAssistantUI.connectToLogStream) {
                    console.log('âœ… æ‰¾åˆ° jobAssistantUIï¼Œå¯åŠ¨æ—¥å¿—æµè¿æ¥...');
                    
                    // ç›´æ¥è°ƒç”¨å·²æœ‰çš„è¿æ¥æ–¹æ³•
                    try {
                        window.jobAssistantUI.connectToLogStream();
                        console.log('âœ“ å®æ—¶æ—¥å¿—æµåŠŸèƒ½å·²é›†æˆ');
                        return;
                    } catch (error) {
                        console.error('âŒ æ—¥å¿—æµè¿æ¥é”™è¯¯:', error);
                    }
                }
                
                // åªåœ¨æœªæˆåŠŸæ—¶æ‰é‡è¯•ï¼Œå¹¶ä¸”é€æ¸å¢åŠ é—´éš”
                const retryDelay = Math.min(500 * initAttempts, 3000);
                setTimeout(tryInit, retryDelay);
            }
            
            // åœ¨é¡µé¢åŠ è½½å®Œæˆåå°è¯•åˆå§‹åŒ–
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    setTimeout(tryInit, 500);
                });
            } else {
                setTimeout(tryInit, 500);
            }
        }
        
        // å¯åŠ¨åˆå§‹åŒ–
        initializeLogStream();
        
    </script>
    
    <!-- æŒ‰é’®ä¿®å¤è„šæœ¬ -->
    <script src="fix-button.js"></script>
</body>
</html>