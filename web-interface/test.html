<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‰é’®æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { border-color: #28a745; background-color: #d4edda; }
        .error { border-color: #dc3545; background-color: #f8d7da; }
        .warning { border-color: #ffc107; background-color: #fff3cd; }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        #console {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ ç”Ÿæˆå­¦ä¹ è·¯çº¿æŒ‰é’®æµ‹è¯•</h1>
        
        <div class="test-item">
            <h3>ğŸ“‹ å½“å‰çŠ¶æ€æ£€æŸ¥</h3>
            <p id="status">æ­£åœ¨æ£€æŸ¥...</p>
        </div>
        
        <div class="test-item">
            <h3>ğŸ¯ å¿«é€Ÿæµ‹è¯•</h3>
            <input type="text" id="testInput" placeholder="è¾“å…¥èŒä½åç§°ï¼ˆå¦‚ï¼šAIå·¥ç¨‹å¸ˆï¼‰" value="AIå·¥ç¨‹å¸ˆ">
            <br>
            <button class="btn btn-primary" id="testButton" disabled>ç”Ÿæˆå­¦ä¹ è·¯çº¿</button>
            <button class="btn btn-success" onclick="forceEnable()">å¼ºåˆ¶å¯ç”¨</button>
            <button class="btn btn-danger" onclick="runDiagnostic()">è¯Šæ–­é—®é¢˜</button>
        </div>
        
        <div class="test-item">
            <h3>ğŸš€ å¿«é€Ÿä¿®å¤</h3>
            <button class="btn btn-primary" onclick="window.open('http://localhost:3000', '_blank')">æ‰“å¼€èŒé€”åŠ©æ‰‹</button>
            <button class="btn btn-success" onclick="runQuickFix()">æ‰§è¡Œå¿«é€Ÿä¿®å¤</button>
        </div>
        
        <div class="test-item">
            <h3>ğŸ“Š æ§åˆ¶å°æ—¥å¿—</h3>
            <div id="console"></div>
            <button class="btn btn-primary" onclick="clearConsole()">æ¸…é™¤æ—¥å¿—</button>
        </div>
    </div>

    <script>
        let console_div = document.getElementById('console');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            console_div.innerHTML += `[${timestamp}] ${message}<br>`;
            console_div.scrollTop = console_div.scrollHeight;
            console.log(message);
        }
        
        function clearConsole() {
            console_div.innerHTML = '';
        }
        
        function checkStatus() {
            fetch('http://localhost:3000')
                .then(response => response.text())
                .then(html => {
                    const hasGenerateBtn = html.includes('generateBtn');
                    const hasDisabled = html.includes('generateBtn" class="generate-btn" disabled');
                    
                    let status = '';
                    if (hasGenerateBtn) {
                        status += 'âœ… ç”ŸæˆæŒ‰é’®å­˜åœ¨<br>';
                        status += hasDisabled ? 'âŒ æŒ‰é’®è¢«ç¦ç”¨' : 'âœ… æŒ‰é’®çŠ¶æ€æ­£å¸¸';
                    } else {
                        status = 'âŒ ç”ŸæˆæŒ‰é’®ä¸å­˜åœ¨';
                    }
                    
                    document.getElementById('status').innerHTML = status;
                    log(`æœåŠ¡å™¨çŠ¶æ€æ£€æŸ¥: ${hasGenerateBtn ? 'æŒ‰é’®å­˜åœ¨' : 'æŒ‰é’®ç¼ºå¤±'}, ${hasDisabled ? 'è¢«ç¦ç”¨' : 'æ­£å¸¸'}`);
                })
                .catch(error => {
                    document.getElementById('status').innerHTML = 'âŒ æœåŠ¡å™¨è¿æ¥å¤±è´¥';
                    log(`è¿æ¥å¤±è´¥: ${error.message}`);
                });
        }
        
        function forceEnable() {
            const testButton = document.getElementById('testButton');
            testButton.disabled = false;
            testButton.style.opacity = '1';
            testButton.style.cursor = 'pointer';
            log('ğŸ”§ æµ‹è¯•æŒ‰é’®å·²å¼ºåˆ¶å¯ç”¨');
        }
        
        function runDiagnostic() {
            log('ğŸ” å¼€å§‹è¯Šæ–­...');
            
            // æ£€æŸ¥è¾“å…¥æ¡†
            const input = document.getElementById('testInput');
            log(`ğŸ“ è¾“å…¥æ¡†å€¼: "${input.value}"`);
            
            // æ£€æŸ¥æŒ‰é’®çŠ¶æ€
            const button = document.getElementById('testButton');
            log(`ğŸ”˜ æŒ‰é’®çŠ¶æ€: disabled=${button.disabled}, opacity=${button.style.opacity}`);
            
            // æµ‹è¯•ä¿®å¤è„šæœ¬
            if (input.value.trim().length > 0) {
                button.disabled = false;
                button.style.opacity = '1';
                button.style.cursor = 'pointer';
                log('âœ… è¯Šæ–­ä¿®å¤å®Œæˆ');
            } else {
                log('âš ï¸ è¯·å…ˆè¾“å…¥èŒä½åç§°');
            }
        }
        
        function runQuickFix() {
            log('ğŸš‘ æ‰§è¡Œå¿«é€Ÿä¿®å¤...');
            
            // å‘ä¸»é¡µé¢æ³¨å…¥ä¿®å¤è„šæœ¬
            const fixScript = `
                const jobTitle = document.getElementById('jobTitle');
                const generateBtn = document.getElementById('generateBtn');
                
                if (jobTitle && generateBtn) {
                    if (jobTitle.value.trim().length > 0) {
                        generateBtn.disabled = false;
                        generateBtn.style.opacity = '1';
                        generateBtn.style.cursor = 'pointer';
                        generateBtn.removeAttribute('disabled');
                        console.log('âœ… æŒ‰é’®å·²ä¿®å¤');
                    }
                }
            `;
            
            log('ğŸ’‰ ä¿®å¤è„šæœ¬å·²ç”Ÿæˆï¼Œè¯·åœ¨ä¸»é¡µé¢æ§åˆ¶å°ä¸­è¿è¡Œ');
            log('æˆ–è€…ç›´æ¥è®¿é—®: http://localhost:3000');
        }
        
        // åˆå§‹åŒ–æµ‹è¯•æŒ‰é’®åŠŸèƒ½
        document.getElementById('testInput').addEventListener('input', function(e) {
            const button = document.getElementById('testButton');
            const hasValue = e.target.value.trim().length > 0;
            
            button.disabled = !hasValue;
            button.style.opacity = hasValue ? '1' : '0.6';
            button.style.cursor = hasValue ? 'pointer' : 'not-allowed';
            
            log(`ğŸ“ è¾“å…¥å˜åŒ–: "${e.target.value}", æŒ‰é’®${hasValue ? 'å¯ç”¨' : 'ç¦ç”¨'}`);
        });
        
        document.getElementById('testButton').addEventListener('click', function() {
            log('ğŸ”˜ æµ‹è¯•æŒ‰é’®è¢«ç‚¹å‡»');
            alert('æµ‹è¯•æŒ‰é’®å·¥ä½œæ­£å¸¸ï¼ç°åœ¨è¯·åœ¨ä¸»é¡µé¢æµ‹è¯•å®é™…åŠŸèƒ½ã€‚');
        });
        
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥çŠ¶æ€
        window.addEventListener('load', () => {
            log('ğŸš€ æµ‹è¯•é¡µé¢å·²åŠ è½½');
            checkStatus();
            
            // åˆå§‹çŠ¶æ€æ£€æŸ¥
            const input = document.getElementById('testInput');
            if (input.value.trim().length > 0) {
                forceEnable();
            }
        });
        
        // å®šæœŸæ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        setInterval(checkStatus, 5000);
    </script>
</body>
</html>