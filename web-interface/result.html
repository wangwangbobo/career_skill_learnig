<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>å­¦ä¹ èµ„æ–™ç”Ÿæˆç»“æœ - èŒé€”åŠ©æ‰‹AIæ±‚èŒå¤§å¸ˆ</title>
    
    <!-- åŠ è½½æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- åŠ è½½ Font Awesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- APIé…ç½®ç›¸å…³å…¨å±€å‡½æ•° - åœ¨é¡µé¢è§£ææ—¶ç«‹å³å¯ç”¨ -->
    <script>
        // å…¨å±€APIé…ç½®å‡½æ•° - ç¡®ä¿ç«‹å³å¯ç”¨
        function openApiConfigModal() {
            console.log('ğŸš€ å…¨å±€å‡½æ•°: æ‰“å¼€APIé…ç½®æ¨¡æ€æ¡†');
            const apiConfigModal = document.getElementById('apiConfigModal');
            const apiKeyInput = document.getElementById('apiKey');
            const apiProviderSelect = document.getElementById('apiProvider');
            
            if (!apiConfigModal) {
                console.error('æ‰¾ä¸åˆ°APIé…ç½®æ¨¡æ€æ¡†');
                alert('APIé…ç½®æ¨¡æ€æ¡†æœªæ‰¾åˆ°ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                return;
            }
            
            // ä»localStorageåŠ è½½å·²ä¿å­˜çš„é…ç½®
            if (apiKeyInput) {
                const savedApiKey = localStorage.getItem('ai_learning_companion_api_key');
                apiKeyInput.value = savedApiKey || '';
            }
            
            if (apiProviderSelect) {
                const savedApiProvider = localStorage.getItem('apiProvider');
                apiProviderSelect.value = savedApiProvider || 'alibaba';
            }
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            apiConfigModal.style.display = 'flex';
            apiConfigModal.classList.add('show');
            
            console.log('âœ… APIé…ç½®æ¨¡æ€æ¡†å·²æ˜¾ç¤º');
        }
        
        // å…¨å±€å…³é—­æ¨¡æ€æ¡†å‡½æ•°
        function closeApiConfigModal() {
            console.log('å…³é—­APIé…ç½®æ¨¡æ€æ¡†');
            const apiConfigModal = document.getElementById('apiConfigModal');
            if (apiConfigModal) {
                apiConfigModal.classList.remove('show');
                setTimeout(() => {
                    apiConfigModal.style.display = 'none';
                }, 300);
            }
        }
        
        // ç¡®ä¿å‡½æ•°ä¹Ÿåœ¨windowå¯¹è±¡ä¸Š
        window.openApiConfigModal = openApiConfigModal;
        window.closeApiConfigModal = closeApiConfigModal;
        
        // è¿”å›åˆ°job-inputé¡µé¢çš„å‡½æ•°
        function goBackToJobInput() {
            console.log('ğŸ”™ è¿”å›åˆ°job-inputé¡µé¢');
            window.location.href = 'job-input.html';
        }
        
        // ç¡®ä¿è¿”å›å‡½æ•°ä¹Ÿåœ¨windowå¯¹è±¡ä¸Š
        window.goBackToJobInput = goBackToJobInput;
    </script>
    <!-- é¡µé¢ä¸“ç”¨æ ·å¼ -->
    <style>
        /* ç»“æœé¡µé¢ä¸“ç”¨æ ·å¼ */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .results-container {
            display: flex;
            flex: 1;
            padding: 0.5rem 1rem 1rem 1rem; /* å‡å°ä¸Šè¾¹è· */
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨æ ‡é¢˜æ  */
        .results-header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 0.1rem 1rem; /* å‡å°åˆ°æå°å€¼ */
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            min-height: 2.5rem; /* è®¾ç½®æœ€å°é«˜åº¦ */
            position: relative;
        }
        
        /* è¿”å›ç®­å¤´æŒ‰é’® */
        .back-arrow-btn {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border: none;
            background: #f3f4f6;
            border-radius: 6px;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            z-index: 100;
        }
        
        .back-arrow-btn:hover {
            background: #6366f1;
            color: white;
            transform: translateY(-50%) translateX(-2px);
        }
        
        /* è°ƒæ•´æ ‡é¢˜ä½ç½®ï¼Œç»™è¿”å›æŒ‰é’®è®©å‡ºç©ºé—´ */
        
        .results-title {
            display: flex;
            align-items: center;
            font-size: 1rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“å¤§å° */
            font-weight: 600;
            color: #111827;
            margin: 0;
            margin-left: 48px; /* ç»™è¿”å›æŒ‰é’®ç•™å‡ºç©ºé—´ */
        }
        
        .results-title i {
            margin-right: 0.5rem; /* å‡å°å›¾æ ‡é—´è· */
            color: #6366f1;
        }
        
        .results-meta {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .generation-time {
            display: flex;
            align-items: center;
        }
        
        .generation-time i {
            margin-right: 0.5rem;
        }
        
        .results-actions {
            display: flex;
            gap: 0.5rem; /* å‡å°æŒ‰é’®é—´è· */
        }
        
        .result-action-btn {
            padding: 0.2rem 0.6rem; /* è¿›ä¸€æ­¥å‡å°æŒ‰é’®å†…è¾¹è· */
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: white;
            font-size: 0.75rem; /* å‡å°å­—ä½“ */
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            z-index: 100; /* æ·»åŠ z-indexç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚ */
            position: relative; /* æ·»åŠ ç›¸å¯¹å®šä½ */
        }
        
        .result-action-btn:hover {
            border-color: #6366f1;
            color: #6366f1;
        }
        
        .result-action-btn i {
            margin-right: 0.5rem;
        }
        
        /* ä¸»è¦å†…å®¹åŒºåŸŸ - ä¸‰åˆ—å¸ƒå±€ */
        .content-layout {
            display: flex;
            flex: 1;
            gap: 1rem;
            width: 100%;
            position: relative;
            overflow: visible;
            pointer-events: auto; /* ç¡®ä¿å¯ä»¥å“åº”ç‚¹å‡» */
        }
        
        /* å·¦ä¾§ç›®å½•é¢æ¿ */
        .content-sidebar {
            width: 260px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            overflow: visible; /* ä¿®æ”¹ä¸ºvisibleç¡®ä¿å†…å®¹ä¸è¢«å‰ªè£ */
            position: relative;
            z-index: 5; /* å¢åŠ z-indexç¡®ä¿åœ¨ä¸Šå±‚ */
        }
        
        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sidebar-header h3 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            color: #111827;
        }
        

        .sidebar-section {
            margin-bottom: 1rem;
        }
        
        .sidebar-section-title {
            padding: 0.75rem 1rem;
            margin: 0;
            font-size: 0.875rem;
            font-weight: 600;
            color: #111827;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .content-nav-list, .skill-nav-list {
            margin: 0;
            padding: 0;
            list-style: none;
            position: relative;
            z-index: 20; /* å¢åŠ z-indexç¡®ä¿åœ¨ä¸Šå±‚ */
            pointer-events: auto; /* ç¡®ä¿å¯ä»¥å“åº”ç‚¹å‡» */
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            color: #4b5563;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            pointer-events: auto; /* ç¡®ä¿å¯ä»¥å“åº”ç‚¹å‡» */
            z-index: 20; /* å¢åŠ z-indexç¡®ä¿åœ¨ä¸Šå±‚ */
        }
        
        .nav-item:hover {
            background: #f9fafb;
            color: #6366f1;
        }
        
        .nav-item.active {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            font-weight: 500;
        }
        
        .nav-item i {
            margin-right: 0.75rem;
            width: 16px;
            text-align: center;
        }
        
        .item-count {
            margin-left: 0.5rem;
            font-size: 0.75rem;
            color: #9ca3af;
        }
        
        .nav-arrow {
            margin-left: auto;
            font-size: 0.75rem;
            transition: transform 0.3s ease;
        }
        
        .nav-item.expanded .nav-arrow {
            transform: rotate(90deg);
        }
        
        /* ä¸­é—´å†…å®¹åŒºåŸŸ */
        .content-main {
            flex: 1;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 1;
            min-width: 0; /* é˜²æ­¢flexå…ƒç´ æº¢å‡º */
            width: 100%;
        }
        
        .content-section {
            display: none;
            flex: 1;
            flex-direction: column;
            position: relative;
            background: white;
            border-radius: 8px;
            width: 100%;
            min-width: 0; /* é˜²æ­¢flexå…ƒç´ æº¢å‡º */
            overflow: hidden;
        }
        
        .content-section.active {
            display: flex;
            z-index: 10;
        }
        
        .section-header {
            padding: 0.5rem 1rem; /* è¿›ä¸€æ­¥å‡å°‘ä¸Šä¸‹å†…è¾¹è· */
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .section-header > div {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            display: flex;
            align-items: center;
        }
        
        .section-header h2 i {
            margin-right: 0.75rem;
            color: #6366f1;
        }
        
        /* ä¸“é—¨é’ˆå¯¹æ€ç»´å¯¼å›¾é¡µé¢çš„æŒ‰é’®å¸ƒå±€ - æ ‡é¢˜åœ¨æœ€å·¦è¾¹ï¼ŒæŒ‰é’®åœ¨æ ‡é¢˜å³è¾¹ */
        #mindmapSection .section-header {
            justify-content: flex-start !important;
        }
        
        #mindmapSection .section-header h2 {
            order: 1 !important;
            margin-right: 1rem !important;
        }
        
        #mindmapSection .section-header > div {
            order: 2 !important;
        }
        
        .section-count {
            margin-left: 0.5rem;
            font-size: 0.875rem;
            font-weight: 400;
            color: #6b7280;
        }
        
        .expand-all-btn {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: white;
            font-size: 0.75rem;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .expand-all-btn:hover {
            border-color: #6366f1;
            color: #6366f1;
        }
        
        .expand-all-btn i {
            margin-right: 0.5rem;
        }
        
        .section-content {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            width: 100%;
        }
        
        /* æ€ç»´å¯¼å›¾ç›¸å…³æ ·å¼ä¼˜åŒ– */
        .mindmap-card {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            height: calc(100vh - 280px); /* è‡ªé€‚åº”é«˜åº¦ */
            min-height: 70vh; /* æœ€å°70%è§†å£é«˜åº¦ */
            max-height: 85vh; /* æœ€å¤§85%è§†å£é«˜åº¦ */
            display: flex;
            flex-direction: column;
        }
        
        /* æ€ç»´å¯¼å›¾å†…å®¹åŒºåŸŸï¼ˆSVGæˆ–é™çº§æ˜¾ç¤ºï¼‰ */
        #mindmapContent {
            width: 100%;
            height: 100%;
            overflow: hidden; /* é˜²æ­¢æ»šåŠ¨æ¡ */
        }
        
        /* SVGæ ·å¼ä¼˜åŒ– */
        #mindmapContent svg {
            width: 100%;
            height: 100%;
            display: block; /* ç§»é™¤é»˜è®¤çš„inlineé—´éš™ */
        }
        
        /* é™çº§æ–¹æ¡ˆæ ·å¼ä¼˜åŒ– */
        .mindmap-fallback {
            width: 100%;
            height: 100%;
            padding: 2rem;
            box-sizing: border-box;
            overflow-y: auto; /* å…è®¸å‚ç›´æ»šåŠ¨ */
        }
        
        .mindmap-controls {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 10;
            display: flex;
            gap: 0.5rem;
        }
        
        .mindmap-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mindmap-btn:hover {
            background: #f9fafb;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .mindmap-content {
            flex: 1;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            min-height: 70vh; /* ä½¿ç”¨è§†å£é«˜åº¦ï¼Œè‡ªé€‚åº”å±å¹•å¤§å° */
            max-height: 85vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ */
            height: calc(100vh - 300px); /* åŠ¨æ€è®¡ç®—é«˜åº¦ï¼Œå‡å»é¡¶éƒ¨å¯¼èˆªå’Œåº•éƒ¨ç©ºé—´ */
            width: 100%;
            box-sizing: border-box;
        }
        
        /* å³ä¾§AIåŠ©æ‰‹ */
        .ai-assistant {
            width: 380px;
            height: calc(100vh - 120px); /* å‡å°‘é¡¶éƒ¨ç•™ç™½ï¼Œæ›´å¥½é€‚åº”å±å¹• */
            max-height: 900px; /* å¢åŠ æœ€å¤§é«˜åº¦ */
            min-height: 400px; /* è®¾ç½®æœ€å°é«˜åº¦ */
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            z-index: 2; /* ç¡®ä¿AIåŠ©æ‰‹å§‹ç»ˆåœ¨æœ€ä¸Šå±‚ */
        }
        
        /* AIåŠ©æ‰‹ç¼©å°çŠ¶æ€ */
        .ai-assistant.minimized {
            position: fixed !important;
            top: 80px !important;
            right: 20px !important;
            width: 60px !important;
            height: 60px !important;
            min-width: 60px !important;
            min-height: 60px !important;
            max-width: 60px !important;
            max-height: 60px !important;
            border-radius: 50% !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            z-index: 1000 !important;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            overflow: hidden !important;
            flex-direction: row !important;
        }
        
        .ai-assistant.minimized:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        
        .ai-assistant.minimized .assistant-header {
            display: none !important;
        }
        
        .ai-assistant.minimized .assistant-title {
            display: none !important;
        }
        
        .ai-assistant.minimized .assistant-actions {
            display: none !important;
        }
        
        .ai-assistant.minimized .assistant-content {
            display: none !important;
        }
        
        .ai-assistant.minimized .chat-messages {
            display: none !important;
        }
        
        .ai-assistant.minimized .chat-input-container {
            display: none !important;
        }
        
        /* ç¼©å°åçš„æœºå™¨äººå›¾æ ‡ */
        .ai-assistant.minimized::before {
            content: "\f544";
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            font-size: 28px;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1001;
            pointer-events: none;
        }
        
        /* ç¼©å°çŠ¶æ€ä¸‹çš„ç‚¹å‡»åŒºåŸŸ */
        .ai-assistant.minimized::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            z-index: 1002;
            cursor: pointer;
        }
        
        .assistant-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #6366f1;
            color: white;
        }
        
        .assistant-title {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .assistant-title i {
            margin-right: 0.75rem;
        }
        
        .assistant-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .assistant-btn {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .assistant-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .assistant-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            overflow-x: hidden; /* é˜²æ­¢æ°´å¹³æ»šåŠ¨ */
            background: #f9fafb;
            min-height: 300px; /* æœ€å°é«˜åº¦ */
            max-height: calc(100vh - 250px); /* è°ƒæ•´æœ€å¤§é«˜åº¦ï¼Œæ›´å¥½é€‚åº”å±å¹• */
            /* ç¾åŒ–æ»šåŠ¨æ¡ */
            scrollbar-width: thin;
            scrollbar-color: #cbd5e0 #f7fafc;
        }
        
        /* Webkit æµè§ˆå™¨æ»šåŠ¨æ¡æ ·å¼ */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: #f7fafc;
            border-radius: 3px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
            transition: background 0.3s ease;
        }
        
        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }
        
        .welcome-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 200px; /* æ”¹ä¸ºmin-heightï¼Œä¸å†å ç”¨æ•´ä¸ªé«˜åº¦ */
            padding: 2rem;
            margin-bottom: 1rem; /* æ·»åŠ ä¸‹è¾¹è· */
        }
        
        .assistant-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #6366f1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .welcome-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
            margin: 0 0 0.5rem 0;
        }
        
        .welcome-text {
            font-size: 0.875rem;
            color: #6b7280;
            line-height: 1.5;
            margin: 0;
        }
        
        .chat-input-container {
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 0.75rem;
        }
        
        .chat-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            font-size: 0.875rem;
            resize: none;
            transition: border-color 0.3s ease;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .send-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: none;
            background: #6366f1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s ease;
            align-self: flex-end;
        }
        
        .send-btn:hover {
            background: #4f46e5;
        }
        
        .send-btn:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }
        
        /* èŠå¤©æ¶ˆæ¯æ ·å¼ */
        .message {
            display: flex;
            margin-bottom: 0.75rem; /* å‡å°æ¶ˆæ¯é—´è· */
            max-width: 90%;
        }
        
        .user-message {
            margin-left: auto;
            flex-direction: row-reverse;
        }
        
        .assistant-message {
            margin-right: auto;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #6366f1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin: 0 0.75rem;
        }
        
        .message-content {
            background: #f3f4f6;
            padding: 0.5rem 0.75rem; /* å‡å°å†…è¾¹è· */
            border-radius: 12px;
            font-size: 0.875rem;
            line-height: 1.4; /* å‡å°è¡Œé«˜ */
            color: #4b5563;
            max-width: 280px; /* AIæ¶ˆæ¯æœ€å¤§å®½åº¦ */
            width: fit-content !important; /* å¼ºåˆ¶è®©å®¹å™¨å®½åº¦è‡ªé€‚åº”å†…å®¹ */
            display: inline-block !important; /* ç¡®ä¿å®¹å™¨ä¸ºinline-block */
            word-wrap: break-word; /* å¼ºåˆ¶æ¢è¡Œ */
            word-break: break-word; /* å…¼å®¹æ€§è®¾ç½® */
            overflow-wrap: break-word; /* ç°ä»£æµè§ˆå™¨æ”¯æŒ */
            white-space: pre-wrap; /* ä¿æŒæ¢è¡Œå’Œç©ºæ ¼ */
        }
        
        /* æµå¼æ¶ˆæ¯å†…å®¹çš„æ ·å¼ */
        .message-content.streaming {
            animation: none;
            transition: none;
            opacity: 0.8;
            background: rgba(99, 102, 241, 0.05);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .user-message .message-content {
            background: #6366f1 !important;
            color: white !important;
            padding: 0.35rem 0.6rem !important; /* é€‚ä¸­çš„å†…è¾¹è·ï¼Œæ¥è¿‘æœºå™¨äººæ¶ˆæ¯æ ·å¼ */
            border-radius: 12px !important;
            font-size: 0.875rem !important;
            line-height: 1.2 !important; /* ç¨å¾®æ”¾å®½è¡Œé«˜ */
            display: inline-flex !important; /* ä½¿ç”¨flexå¸ƒå±€ */
            align-items: center !important; /* å‚ç›´å±…ä¸­ */
            width: auto !important;
            max-width: 220px !important;
            min-width: auto !important;
            height: auto !important; /* å®Œå…¨è‡ªé€‚åº”é«˜åº¦ */
            word-wrap: break-word !important;
            word-break: break-word !important;
            overflow-wrap: break-word !important;
            box-sizing: border-box !important;
        }
        
        /* å¢åŠ ä¸€ä¸ªæ›´å…·ä½“çš„é€‰æ‹©å™¨ä»¥ç¡®ä¿ä¼˜å…ˆçº§ */
        .ai-assistant .chat-messages .message.user-message .message-content {
            max-width: 220px !important;
            width: fit-content !important;
            min-width: 20px !important;
        }
        
        .message-content p {
            margin: 0 !important;
            padding: 0 !important; /* ç¡®ä¿æ®µè½æ²¡æœ‰é¢å¤–çš„å†…è¾¹è· */
            line-height: inherit !important; /* ç»§æ‰¿çˆ¶å…ƒç´ çš„è¡Œé«˜ */
        }
        

        
        /* é¢è¯•é¢˜æ–°æ ·å¼ */
        .interview-card {
            background: white;
            border-radius: 16px; /* å¢åŠ åœ†è§’ */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1); /* å¢å¼ºé˜´å½± */
            padding: 2rem; /* å¢åŠ å†…è¾¹è· */
            margin-bottom: 2rem; /* å¢åŠ ä¸‹è¾¹è· */
            position: relative;
            transition: all 0.3s ease;
            border: 1px solid #f1f5f9;
        }
        
        .interview-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .interview-progress {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        .interview-progress i {
            color: #4f46e5;
            margin-right: 0.5rem;
        }

        .interview-question {
            font-size: 1.375rem; /* å¢å¤§å­—ä½“ */
            font-weight: 700; /* åŠ ç²— */
            color: #1f2937;
            margin: 0; /* é‡ç½®é»˜è®¤margin */
            line-height: 1.4;
            letter-spacing: -0.025em; /* ç»†å¾®è°ƒæ•´å­—ç¬¦é—´è· */
            background: linear-gradient(135deg, #6366f1, #8b5cf6); /* æ¢å¤è“è‰²èƒŒæ™¯ */
            color: white; /* æ”¹ä¸ºç™½è‰²æ–‡å­— */
            padding: 1.5rem 2rem; /* å¢åŠ å†…è¾¹è· */
            border-radius: 12px; /* åœ†è§’ */
            margin-bottom: 0; /* ç§»é™¤ä¸‹è¾¹è· */
        }

        .interview-tags {
            display: flex;
            gap: 0.75rem; /* å¢åŠ é—´è· */
            margin-bottom: 2rem; /* å¢åŠ ä¸‹è¾¹è· */
            flex-wrap: wrap;
        }

        .interview-tag {
            padding: 0.375rem 1rem; /* å¢åŠ å†…è¾¹è· */
            border-radius: 9999px;
            font-size: 0.8rem; /* ç¨å¾®å¢å¤§å­—ä½“ */
            font-weight: 600; /* å¢åŠ å­—ä½“é‡é‡ */
            letter-spacing: 0.025em;
            transition: all 0.2s ease;
        }

        .interview-tag.primary {
            background-color: #e9d5ff;
            color: #7e22ce;
        }

        .interview-tag.secondary {
            background-color: #dbeafe;
            color: #1d4ed8;
        }

        .interview-tag.tech {
            background-color: #e0f2fe;
            color: #0369a1;
        }

        /* çŸ¥è¯†ç‚¹æ–°æ ·å¼ */
        .knowledge-item {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 0;
            margin-bottom: 1.5rem;
            display: block;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }

        .knowledge-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-color: #6366f1;
        }

        .knowledge-header {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            padding: 1.2rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .knowledge-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: white;
            margin: 0;
            line-height: 1.3;
            text-align: center;
        }

        .knowledge-content {
            padding: 1.5rem;
            background: white;
        }

        .knowledge-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #4b5563;
            margin: 0;
        }

        .knowledge-text strong {
            color: #1f2937;
            font-weight: 600;
        }

        .knowledge-text br {
            margin-bottom: 0.5rem;
        }

        /* çŸ¥è¯†ç‚¹æŒ‰é’®æ ·å¼ */
        .knowledge-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #f3f4f6;
        }

        .knowledge-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 100px;
        }

        .knowledge-btn i {
            margin-right: 0.5rem;
        }

        .knowledge-btn.primary {
            background-color: #4f46e5;
            color: white;
            border: none;
        }

        .knowledge-btn.primary:hover {
            background-color: #4338ca;
            transform: translateY(-1px);
        }

        .knowledge-btn.secondary {
            background-color: white;
            color: #6b7280;
            border: 1px solid #d1d5db;
        }

        .knowledge-btn.secondary:hover {
            background-color: #f9fafb;
            color: #374151;
            transform: translateY(-1px);
        }

        .knowledge-btn.outline {
            background-color: white;
            color: #4f46e5;
            border: 1px solid #4f46e5;
        }

        .knowledge-btn.outline:hover {
            background-color: #f5f3ff;
            transform: translateY(-1px);
        }

        .interview-actions {
            display: flex;
            gap: 1rem; /* å¢åŠ é—´è· */
            justify-content: space-between;
            margin-top: 1.5rem; /* å¢åŠ ä¸Šè¾¹è· */
        }

        .interview-btn {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .interview-btn i {
            margin-right: 0.5rem;
        }

        .interview-btn.primary {
            background-color: #4f46e5;
            color: white;
            border: none;
        }

        .interview-btn.primary:hover {
            background-color: #4338ca;
        }

        .interview-btn.secondary {
            background-color: white;
            color: #4b5563;
            border: 1px solid #e5e7eb;
        }

        .interview-btn.secondary:hover {
            background-color: #f9fafb;
            color: #111827;
        }

        .interview-btn.outline {
            background-color: white;
            color: #4f46e5;
            border: 1px solid #4f46e5;
        }

        .interview-btn.outline:hover {
            background-color: #f5f3ff;
        }

        .interview-btn.ai-score {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            position: relative;
        }

        .interview-btn.ai-score:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
                                
        .interview-btn.solution {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            position: relative;
        }
                                
        .interview-btn.solution:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        /* é¢è¯•é¢˜ç­”æ¡ˆè¾“å…¥æ¡†æ ·å¼ä¼˜åŒ– */
        .interview-answer-input {
            width: 100%;
            min-height: 150px; /* å¢åŠ æœ€å°é«˜åº¦ */
            height: auto;
            padding: 1rem; /* å¢åŠ å†…è¾¹è· */
            border: 2px solid #e5e7eb;
            border-radius: 12px; /* å¢åŠ åœ†è§’ */
            font-size: 0.95rem;
            line-height: 1.6;
            resize: vertical; /* å…è®¸å‚ç›´è°ƒæ•´å¤§å° */
            transition: all 0.3s ease;
            font-family: inherit;
            background: #fafafa;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
            margin: 0 0 1.5rem 0; /* ä¿®æ”¹ä¸Šè¾¹è·ï¼Œå› ä¸ºä¸Šæ–¹å·²ç»æœ‰æŒ‰é’®åŒºåŸŸ */
        }
        
        .interview-answer-input:focus {
            outline: none;
            border-color: #6366f1;
            background: white;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
            transform: translateY(-1px);
        }
        
        .interview-answer-input:hover {
            border-color: #d1d5db;
            background: white;
        }
        
        .interview-answer-input::placeholder {
            color: #9ca3af;
            font-style: italic;
            font-size: 0.9rem;
        }
        
        /* çŸ¥è¯†ç‚¹ç¬”è®°ç¼–è¾‘æ¡†æ ·å¼ */
        .knowledge-notes {
            margin-top: 1rem;
            margin-bottom: 1rem;
            border-top: 1px dashed #e5e7eb;
            padding-top: 1rem;
        }
        
        .knowledge-notes-input {
            width: 100%;
            min-height: 100px;
            padding: 0.875rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            line-height: 1.5;
            color: #4b5563;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: inherit;
            background-color: #f9fafb;
        }
        
        .knowledge-notes-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background-color: white;
        }
        
        .knowledge-notes-input:hover {
            border-color: #d1d5db;
            background-color: white;
        }
        
        .knowledge-notes-input::placeholder {
            color: #9ca3af;
            font-style: italic;
        }
        
        /* çŸ¥è¯†ç‚¹é€šä¿—è®²è§£æ ·å¼ */
        .knowledge-simple-explanation {
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: #fef3c7;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
        }
        
        .knowledge-simple-explanation-title {
            font-weight: 600;
            font-size: 1rem;
            color: #92400e;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
        }
        
        .knowledge-simple-explanation-title i {
            margin-right: 0.5rem;
        }
        
        .knowledge-simple-explanation-content {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #4b5563;
        }
        
        /* è§£é¢˜æ€è·¯å’Œç­”æ¡ˆæŒ‰é’®åŒºåŸŸæ ·å¼ */
        .interview-helper-actions {
            display: flex;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }
        
        .interview-helper-actions .interview-btn {
            flex: 1;
            justify-content: center;
            padding: 0.75rem 1rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        /* è§£é¢˜æ€è·¯æ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
        .solution-area {
            margin: 0 0 1.5rem 0; /* è°ƒæ•´ä¸Šä¸‹è¾¹è·ï¼Œä¸æ–°å¸ƒå±€åè°ƒ */
            padding: 1.5rem;
            background: linear-gradient(135deg, #ecfdf5, #f0fdf4);
            border-radius: 12px;
            border-left: 4px solid #10b981;
            display: none;
            transition: all 0.3s ease;
        }
                                
        .solution-area.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
                                
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
                                
        .solution-title {
            font-weight: 600;
            font-size: 1rem;
            color: #065f46;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
                                
        .solution-title i {
            margin-right: 0.5rem;
            color: #10b981;
        }
                                
        .solution-content {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #374151;
        }
                                
        .solution-content h4 {
            font-weight: 600;
            color: #1f2937;
            margin: 1rem 0 0.5rem 0;
        }
                                
        .solution-content ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
                                
        .solution-content li {
            margin-bottom: 0.25rem;
        }
                                
        .solution-content code {
            background: #f3f4f6;
            color: #1f2937;
            padding: 0.125rem 0.25rem;
            border-radius: 4px;
            font-size: 0.875rem;
        }
        
        /* ç­”æ¡ˆæ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
        .answer-area {
            margin: 0 0 1.5rem 0;
            padding: 1.5rem;
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            display: none;
            transition: all 0.3s ease;
        }
        
        .answer-area.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
        
        .answer-title {
            font-weight: 600;
            font-size: 1rem;
            color: #1e40af;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .answer-title i {
            margin-right: 0.5rem;
            color: #3b82f6;
        }
        
        .answer-content {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #374151;
        }
        
        .answer-content h4 {
            font-weight: 600;
            color: #1f2937;
            margin: 1rem 0 0.5rem 0;
        }
        
        .answer-content ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .answer-content li {
            margin-bottom: 0.25rem;
        }
        
        .answer-content code {
            background: #f3f4f6;
            color: #1f2937;
            padding: 0.125rem 0.25rem;
            border-radius: 4px;
            font-size: 0.875rem;
        }
        
        /* AIèŠå¤©æŒ‰é’®æ ·å¼ */
        .ai-chat-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            background: white !important;
            color: #6366f1 !important;
        }
                                
        /* é¢è¯•é¢˜ç¬”è®°ç¼–è¾‘æ¡†æ ·å¼ */
        .interview-notes {
            margin-top: 1rem;
            margin-bottom: 1rem;
            border-top: 1px dashed #e5e7eb;
            padding-top: 1rem;
        }
        
        .interview-notes-input {
            width: 100%;
            min-height: 100px;
            padding: 0.875rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            line-height: 1.5;
            color: #4b5563;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: inherit;
            background-color: #f9fafb;
        }
        
        .interview-notes-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background-color: white;
        }
        
        .interview-notes-input:hover {
            border-color: #d1d5db;
            background-color: white;
        }
        
        .interview-notes-input::placeholder {
            color: #9ca3af;
            font-style: italic;
        }
        
        /* ä¹¦ç±æ ·å¼ */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 0;
            width: 100%;
        }
        
        .book-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .book-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #d1d5db;
        }
        
        .book-cover {
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            flex-shrink: 0;
        }
        
        .book-cover i {
            font-size: 1.5rem;
            color: white;
        }
        
        .book-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .book-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }
        
        .book-author {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0 0 0.75rem 0;
        }
        
        .book-description {
            font-size: 0.875rem;
            color: #4b5563;
            line-height: 1.5;
            margin: 0 0 1rem 0;
            flex: 1;
        }
        
        .book-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .stars {
            display: flex;
            gap: 0.125rem;
        }
        
        .stars i {
            font-size: 0.875rem;
            color: #fbbf24;
        }
        
        .stars .far {
            color: #d1d5db;
        }
        
        .rating-text {
            font-size: 0.875rem;
            font-weight: 500;
            color: #4b5563;
        }
        
        .book-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .book-btn {
            flex: 1;
            padding: 0.625rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
        }
        
        .book-btn i {
            margin-right: 0.5rem;
            font-size: 0.75rem;
        }
        
        .book-btn.primary {
            background: #6366f1;
            color: white;
        }
        
        .book-btn.primary:hover {
            background: #4f46e5;
            transform: translateY(-1px);
        }
        
        .book-btn.secondary {
            background: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }
        
        .book-btn.secondary:hover {
            background: #f1f5f9;
            color: #475569;
        }
        

        
        /* è¯ä¹¦æ ·å¼ */
        .certificates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            padding: 0;
            width: 100%;
        }
        
        .certificate-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .certificate-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #d1d5db;
        }
        
        .certificate-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .certificate-icon i {
            font-size: 1.5rem;
            color: white;
        }
        
        .certificate-info {
            flex: 1;
        }
        
        .certificate-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }
        
        .certificate-issuer {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0 0 0.75rem 0;
        }
        
        .certificate-description {
            font-size: 0.875rem;
            color: #4b5563;
            line-height: 1.5;
            margin: 0 0 1rem 0;
        }
        
        .certificate-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .difficulty-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .difficulty-badge.beginner {
            background: #dcfce7;
            color: #166534;
        }
        
        .difficulty-badge.intermediate {
            background: #fef3c7;
            color: #92400e;
        }
        
        .difficulty-badge.advanced {
            background: #fecaca;
            color: #991b1b;
        }
        
        .validity {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .certificate-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .cert-btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
        }
        
        .cert-btn i {
            margin-right: 0.5rem;
            font-size: 0.75rem;
        }
        
        .cert-btn.primary {
            background: #f59e0b;
            color: white;
        }
        
        .cert-btn.primary:hover {
            background: #d97706;
            transform: translateY(-1px);
        }
        
        .cert-btn.secondary {
            background: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }
        
        .cert-btn.secondary:hover {
            background: #f1f5f9;
            color: #475569;
        }
        
        /* è¯¾ç¨‹æ ·å¼ */
        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            padding: 0;
            width: 100%;
        }
        
        .course-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 0;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .course-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #d1d5db;
        }
        
        .course-thumbnail {
            height: 120px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .course-thumbnail i {
            font-size: 3rem;
            color: white;
            opacity: 0.9;
        }
        
        .course-duration {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .course-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .course-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }
        
        .course-instructor {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0 0 0.75rem 0;
        }
        
        .course-description {
            font-size: 0.875rem;
            color: #4b5563;
            line-height: 1.5;
            margin: 0 0 1rem 0;
            flex: 1;
        }
        
        .course-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .course-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .level-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .level-badge.beginner {
            background: #dcfce7;
            color: #166534;
        }
        
        .level-badge.intermediate {
            background: #fef3c7;
            color: #92400e;
        }
        
        .level-badge.advanced {
            background: #fecaca;
            color: #991b1b;
        }
        
        .course-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .current-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: #dc2626;
        }
        
        .original-price {
            font-size: 0.875rem;
            color: #9ca3af;
            text-decoration: line-through;
        }
        
        .discount {
            background: #dc2626;
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .course-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .course-btn {
            flex: 1;
            padding: 0.625rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
        }
        
        .course-btn i {
            margin-right: 0.5rem;
            font-size: 0.75rem;
        }
        
        .course-btn.primary {
            background: #6366f1;
            color: white;
        }
        
        .course-btn.primary:hover {
            background: #4f46e5;
            transform: translateY(-1px);
        }
        
        .course-btn.secondary {
            background: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
            flex: 0 0 auto;
            padding: 0.625rem;
        }
        
        .course-btn.secondary:hover {
            background: #f1f5f9;
            color: #dc2626;
        }

        .interview-refresh {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
        }

        .interview-refresh:hover {
            background-color: #f3f4f6;
            color: #4f46e5;
        }

        .interview-ai-badge {
            display: flex;
            align-items: center;
            color: #4f46e5;
            font-weight: 500;
            font-size: 0.875rem;
            margin-left: auto;
        }

        .interview-ai-badge i {
            margin-right: 0.5rem;
        }

        /* é¢è¯•é¢˜åˆ—è¡¨æ ·å¼ */
        .content-subtitle {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            margin: 2rem 0 1rem 0;
        }

        .interview-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .interview-list-item {
            display: flex;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }

        .interview-list-item:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
            border-color: #d1d5db;
        }

        .interview-list-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #f3f4f6;
            color: #4b5563;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .interview-list-content {
            flex: 1;
        }

        .interview-list-title {
            font-size: 0.9375rem;
            font-weight: 500;
            color: #1f2937;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }

        .interview-list-tags {
            display: flex;
            gap: 0.5rem;
        }

        /* å¤§å±å¹•æ€ç»´å¯¼å›¾ä¼˜åŒ– */
        @media (min-height: 900px) and (min-width: 1400px) {
            .mindmap-card {
                height: calc(100vh - 300px);
                max-height: 90vh;
            }
            
            .mindmap-content {
                min-height: 75vh;
            }
        }
        
        /* è¶…å¤§å±å¹•ä¼˜åŒ– */
        @media (min-height: 1080px) {
            .mindmap-card {
                height: calc(100vh - 320px);
                max-height: 95vh;
            }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1400px) {
            .ai-assistant {
                width: 320px;
                height: calc(100vh - 120px); /* ä¿æŒé«˜åº¦é™åˆ¶ */
            }
            
            .message-content {
                max-width: 240px; /* AIæ¶ˆæ¯é€‚åº”è¾ƒå°çš„å®½åº¦ */
            }
            
            .user-message .message-content {
                max-width: 200px; /* ç”¨æˆ·æ¶ˆæ¯é€‚ä¸­çš„å®½åº¦ */
            }
        }
        
        @media (max-width: 1200px) {
            .results-container {
                flex-direction: column;
            }
            
            .content-layout {
                flex-direction: column;
            }
            
            .content-sidebar, .ai-assistant {
                width: 100%;
            }
            
            .ai-assistant {
                height: 450px; /* å¢åŠ ç§»åŠ¨ç«¯é«˜åº¦ */
                max-height: 450px;
                min-height: 400px;
            }
            
            .chat-messages {
                max-height: calc(450px - 130px); /* é€‚åº”æ–°çš„é«˜åº¦ */
            }
            
            .message-content {
                max-width: 70%; /* AIæ¶ˆæ¯ç§»åŠ¨ç«¯è°ƒæ•´æ¶ˆæ¯å®½åº¦ */
            }
            
            .user-message .message-content {
                max-width: 70%; /* ç”¨æˆ·æ¶ˆæ¯é€‚ä¸­ç´§å‡‘ */
            }
            
            .mindmap-content {
                min-height: 400px;
            }
            
            /* ç§»åŠ¨è®¾å¤‡æ€ç»´å¯¼å›¾é«˜åº¦ä¼˜åŒ– */
            .mindmap-card {
                height: calc(100vh - 200px);
                min-height: 50vh;
                max-height: 80vh;
            }
        }
        
        @media (max-width: 768px) {
            .books-grid,
            .certificates-grid,
            .courses-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                width: 100%;
            }
            
            .book-card,
            .certificate-card,
            .course-card {
                padding: 1rem;
            }
            
            .book-actions,
            .certificate-actions,
            .course-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem; /* å‡å°é—´è· */
                padding: 0.1rem 1rem; /* ä¿æŒä¸ä¸»æ ·å¼ä¸€è‡´çš„å°å†…è¾¹è· */
                min-height: auto; /* ç§»åŠ¨ç«¯å–æ¶ˆæœ€å°é«˜åº¦é™åˆ¶ */
            }
            
            .results-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .content-layout {
                flex-direction: column;
            }
            
            .content-sidebar {
                width: 100%;
                margin-bottom: 1rem;
            }
            
            .content-main {
                width: 100%;
            }
            
            .ai-assistant {
                width: 100%;
                height: 400px; /* å°å±å¹•é€‚ä¸­çš„é«˜åº¦ */
                max-height: 400px;
                min-height: 350px;
                margin-top: 1rem; /* æ·»åŠ ä¸Šè¾¹è·ï¼Œä¸å†…å®¹åŒºåŸŸåˆ†å¼€ */
            }
            
            .chat-messages {
                max-height: calc(400px - 130px);
                padding: 0.75rem; /* å‡å°å†…è¾¹è· */
            }
            
            .message-content {
                max-width: 85%; /* AIæ¶ˆæ¯å°å±å¹•è¿›ä¸€æ­¥å¢åŠ æ¶ˆæ¯å®½åº¦ */
                padding: 0.4rem 0.6rem; /* è¿›ä¸€æ­¥å‡å°å†…è¾¹è· */
            }
            
            .user-message .message-content {
                max-width: 80%; /* ç”¨æˆ·æ¶ˆæ¯å°å±å¹•ä¸‹ä¿æŒåˆç†å®½åº¦ */
            }
        }
        
        @media (max-width: 640px) {
            .interview-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .interview-btn {
                width: 100%;
            }
        }
        
        /* APIé…ç½®æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex !important;
        }
        
        .modal-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 10001;
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f9fafb;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
            display: flex;
            align-items: center;
        }
        
        .modal-header h3 i {
            margin-right: 0.75rem;
            color: #6366f1;
        }
        
        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            background: #f3f4f6;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-description {
            margin: 0 0 1.5rem 0;
            color: #6b7280;
        }
        
        .input-group {
            margin-bottom: 1.5rem;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #111827;
        }
        
        .key-input-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .modal-input {
            width: 100%;
            padding: 0.75rem 1rem;
            padding-right: 3rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            box-sizing: border-box;
        }
        
        .toggle-btn {
            position: absolute;
            right: 0.75rem;
            width: 28px;
            height: 28px;
            border: none;
            background: none;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .provider-select {
            margin-bottom: 1.5rem;
        }
        
        .modal-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            background: white;
            box-sizing: border-box;
        }
        
        .provider-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background: #f9fafb;
        }
        
        .provider-details h4 {
            margin: 0 0 0.25rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: #111827;
        }
        
        .provider-details p {
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .provider-link {
            font-size: 0.875rem;
            color: #6366f1;
            text-decoration: none;
            font-weight: 500;
        }
        
        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            background: #f9fafb;
        }
        
        .modal-btn {
            padding: 0.625rem 1.25rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border: none;
        }
        
        .modal-btn-cancel {
            background: #f3f4f6;
            color: #374151;
        }
        
        .modal-btn-confirm {
            background: #6366f1;
            color: white;
        }
    </style>
    

    
    <!-- ç›´æ¥åœ¨headä¸­åŠ è½½Markmapåº“å’Œæ ·å¼ -->
    <!-- D3åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <!-- Markmap View -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-view@0.14.4"></script>
    <!-- Markmap Lib -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib@0.14.4"></script>
    <!-- Markmap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.4/dist/style.css">
    
    <script>
        // ç­‰å¾…æ‰€æœ‰åº“åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ§  DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–æ€ç»´å¯¼å›¾...');
            
            // æ£€æŸ¥å¿…è¦çš„åº“æ˜¯å¦åŠ è½½
            function checkLibrariesLoaded() {
                return typeof window.d3 !== 'undefined' && 
                       typeof window.markmap !== 'undefined' &&
                       window.markmap.Markmap &&
                       window.markmap.Transformer;
            }
            
            // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿æ‰€æœ‰åº“éƒ½å·²åŠ è½½
            function waitForLibraries(maxAttempts = 10, attempt = 1) {
                console.log(`ğŸ” æ£€æŸ¥åº“åŠ è½½çŠ¶æ€ (å°è¯• ${attempt}/${maxAttempts})...`);
                
                if (checkLibrariesLoaded()) {
                    console.log('âœ… æ‰€æœ‰Markmapåº“å·²åŠ è½½å®Œæˆ');
                    initializeMarkmap();
                } else if (attempt < maxAttempts) {
                    console.log('â³ ç­‰å¾…åº“åŠ è½½...');
                    setTimeout(() => waitForLibraries(maxAttempts, attempt + 1), 1000);
                } else {
                    console.error('âŒ Markmapåº“åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ');
                    showMarkmapFallback();
                }
            }
            
            // å¼€å§‹æ£€æŸ¥åº“åŠ è½½çŠ¶æ€
            waitForLibraries();
        });
        
        function initializeMarkmap() {
            console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–æ€ç»´å¯¼å›¾...');
            
            // æ£€æŸ¥å¿…è¦çš„åº“æ˜¯å¦å·²åŠ è½½
            if (typeof window.d3 === 'undefined') {
                console.error('âŒ d3åº“æœªåŠ è½½');
                showMarkmapFallback();
                return;
            }
            
            if (typeof window.markmap === 'undefined' || !window.markmap.Markmap || !window.markmap.Transformer) {
                console.error('âŒ markmapåº“æœªåŠ è½½æˆ–ä¸å®Œæ•´');
                showMarkmapFallback();
                return;
            }
            
            try {
                // æ˜ç¡®çš„æ€ç»´å¯¼å›¾å†…å®¹ï¼ˆä½¿ç”¨æ ‡å‡†Markdownæ ¼å¼ï¼‰
                const markdown = `# åç«¯å·¥ç¨‹å¸ˆå­¦ä¹ è·¯çº¿

## ğŸ”¥ ç¼–ç¨‹è¯­è¨€
### Java
- åŸºç¡€è¯­æ³•å’Œé¢å‘å¯¹è±¡
- é›†åˆæ¡†æ¶å’Œæ•°æ®ç»“æ„
- å¤šçº¿ç¨‹å’Œå¹¶å‘ç¼–ç¨‹
- JVMåŸç†å’Œè°ƒä¼˜

### Python
- åŸºç¡€è¯­æ³•å’Œæ•°æ®ç±»å‹
- ç½‘ç»œç¼–ç¨‹å’ŒWebæ¡†æ¶
- æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ 

### Go
- å¹¶å‘æ¨¡å‹å’ŒGoroutine
- å†…å­˜ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–
- å¾®æœåŠ¡å’Œäº‘åŸç”Ÿå¼€å‘

## ğŸ—ï¸ æ¡†æ¶æŠ€æœ¯
### Springç”Ÿæ€
- Spring Framework æ ¸å¿ƒ
- Spring Boot å¾®æœåŠ¡
- Spring Cloud åˆ†å¸ƒå¼
- Spring Security å®‰å…¨æ¡†æ¶

### æ•°æ®åº“æ¡†æ¶
- MyBatis ORMæ¡†æ¶
- Hibernate JPAè§„èŒƒ
- æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–

## ğŸ“Š æ•°æ®åº“æŠ€æœ¯
### å…³ç³»å‹æ•°æ®åº“
- MySQL è®¾è®¡å’Œä¼˜åŒ–
- PostgreSQL é«˜çº§ç‰¹æ€§
- ç´¢å¼•ä¼˜åŒ–å’ŒæŸ¥è¯¢ä¼˜åŒ–

### NoSQLæ•°æ®åº“
- Redis ç¼“å­˜å’Œæ•°æ®ç»“æ„
- MongoDB æ–‡æ¡£æ•°æ®åº“
- Elasticsearch æœç´¢å¼•æ“

## ğŸ“ ä¸­é—´ä»¶æŠ€æœ¯
### æ¶ˆæ¯é˜Ÿåˆ—
- Kafka å¤§æ•°æ®æµå¤„ç†
- RabbitMQ å¯é æ¶ˆæ¯ä¼ é€’
- æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹å’Œä¼˜åŒ–

### åˆ†å¸ƒå¼åè°ƒ
- Zookeeper é…ç½®ç®¡ç†
- etcd åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨
- æœåŠ¡å‘ç°å’Œæ³¨å†Œ

## ğŸ¢ æ¶æ„è®¾è®¡
### å¾®æœåŠ¡æ¶æ„
- æœåŠ¡æ‹†åˆ†å’Œè®¾è®¡åŸåˆ™
- APIç½‘å…³å’Œè´Ÿè½½å‡è¡¡
- æœåŠ¡æ²»ç†å’Œç›‘æ§

### åˆ†å¸ƒå¼ç³»ç»Ÿ
- CAPç†è®ºå’Œä¸€è‡´æ€§
- åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†
- é«˜å¯ç”¨å’Œå®¹ç¾è®¾è®¡

## ğŸš€ DevOpså’Œéƒ¨ç½²
### å®¹å™¨åŒ–æŠ€æœ¯
- Docker å®¹å™¨éƒ¨ç½²
- Kubernetes å®¹å™¨ç¼–æ’
- å®¹å™¨ç›‘æ§å’Œæ—¥å¿—

### CI/CD æµæ°´çº¿
- Jenkins è‡ªåŠ¨åŒ–æ„å»º
- GitLab CI æŒç»­é›†æˆ
- ä»£ç è´¨é‡å’Œæµ‹è¯•ç­–ç•¥

## ğŸ”’ å®‰å…¨å’Œæ€§èƒ½
### å®‰å…¨é˜²æŠ¤
- èº«ä»½è®¤è¯å’Œæˆæƒ
- æ•°æ®åŠ å¯†å’Œä¼ è¾“å®‰å…¨
- å¸¸è§æ”»å‡»é˜²æŠ¤

### æ€§èƒ½ä¼˜åŒ–
- ç³»ç»Ÿæ€§èƒ½ç›‘æ§
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- ç¼“å­˜ç­–ç•¥å’Œå¹¶å‘ä¼˜åŒ–`;
                
                // åˆå§‹åŒ–æ€ç»´å¯¼å›¾
                const mindmapElement = document.getElementById('mindmapContent');
                if (!mindmapElement) {
                    console.error('âŒ æ‰¾ä¸åˆ°æ€ç»´å¯¼å›¾å®¹å™¨å…ƒç´ ');
                    return;
                }
                
                // æ¸…ç©ºå…ƒç´ å†…å®¹
                mindmapElement.innerHTML = '';
                
                // åˆ›å»ºSVGå…ƒç´ 
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('width', '100%');
                svg.setAttribute('height', '600');
                // æ·»åŠ ç¼©æ”¾æ•ˆæœçš„åˆå§‹æ ·å¼ï¼Œä½¿ç”¨å°ä¸€ç‚¹çš„æ¯”ä¾‹ï¼Œç„¶åè¿‡æ¸¡åˆ°æ­£å¸¸å¤§å°
                svg.style.transform = 'scale(0.95)';
                svg.style.opacity = '0.9';
                svg.style.background = '#fff';
                svg.style.border = '1px solid #e5e7eb';
                svg.style.borderRadius = '8px';
                mindmapElement.appendChild(svg);
                
                console.log('ğŸ¨ SVGå…ƒç´ åˆ›å»ºå®Œæˆ');
                
                // åˆ›å»ºè½¬æ¢å™¨
                const transformer = new window.markmap.Transformer();
                console.log('ğŸ”„ Transformeråˆ›å»ºå®Œæˆ');
                
                // éªŒè¯å¹¶ä¿®å¤æ•°æ®
                const validateData = (data) => {
                    if (!data) return data;
                    
                    // é€’å½’éªŒè¯æ¯ä¸ªèŠ‚ç‚¹
                    const validateNode = (node) => {
                        if (!node) return;
                        
                        // ä¿®å¤å¯èƒ½çš„NaNå€¼
                        if (!node.x || isNaN(node.x)) node.x = 0;
                        if (!node.y || isNaN(node.y)) node.y = 0;
                        
                        // ç¡®ä¿å…¶ä»–å…³é”®å±æ€§å­˜åœ¨
                        if (typeof node.depth === 'undefined') node.depth = 0;
                        if (!node.parent) node.parent = null;
                        if (!node.data) node.data = {};
                        if (!node.children) node.children = [];
                        
                        // éªŒè¯æ‰€æœ‰åæ ‡å’Œå˜æ¢ç›¸å…³çš„å±æ€§
                        ['x0', 'y0', 'x1', 'y1', 'height', 'width'].forEach(prop => {
                            if (node[prop] && isNaN(node[prop])) node[prop] = 0;
                        });
                        
                        // å¤„ç†å­èŠ‚ç‚¹
                        if (node.children && Array.isArray(node.children)) {
                            node.children.forEach(validateNode);
                        }
                    };
                    
                    validateNode(data);
                    return data;
                };
                
                // è½¬æ¢markdown
                const { root } = transformer.transform(markdown);
                console.log('ğŸŒ³ Markdownè½¬æ¢å®Œæˆ');
                
                // éªŒè¯å¹¶ä¿®å¤æ•°æ®
                const validatedRoot = validateData(root);
                
                // åˆ›å»ºMarkmapå®ä¾‹
                const markmapInstance = window.markmap.Markmap.create(svg, {
                    duration: 500,
                    zoom: true,
                    pan: true,
                    autoFit: true, // å¯ç”¨è‡ªåŠ¨é€‚é…ï¼Œä¸æŠ˜å å…¨éƒ¨æŒ‰é’®ä¿æŒä¸€è‡´
                    initialExpandLevel: -1, // æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹ï¼Œä½†é€šè¿‡å…¶ä»–å‚æ•°æ§åˆ¶å¤§å°
                    color: (d) => {
                        // æ ¹æ®å±‚çº§è®¾ç½®ä¸åŒé¢œè‰²
                        const colors = ['#6366f1', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#ef4444'];
                        return colors[(d.depth || 0) % colors.length]; // æ·»åŠ é»˜è®¤å€¼0é˜²æ­¢undefined
                    }
                    // ç§»é™¤è‡ªå®šä¹‰é—´è·å’Œå°ºå¯¸å‚æ•°ï¼Œè®©autoFitè‡ªåŠ¨å¤„ç†æœ€ä½³æ˜¾ç¤ºæ•ˆæœ
                }, validatedRoot);
                
                // æ·»åŠ é¢å¤–å¤„ç†ï¼Œé˜²æ­¢åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„é”™è¯¯
                if (markmapInstance && typeof markmapInstance.setData === 'function') {
                    // å°è¯•ä¸ºMarkmapInstanceæ·»åŠ é”™è¯¯å¤„ç†å‡½æ•°
                    markmapInstance._handleTransformError = function(node) {
                        if (!node) return;
                        if (isNaN(node.x) || isNaN(node.y)) {
                            node.x = 0;
                            node.y = 0;
                        }
                    };
                }
                
                console.log('âœ… Markmapå®ä¾‹åˆ›å»ºå®Œæˆ');
                
                // ä¿å­˜å®ä¾‹åˆ°å…¨å±€å˜é‡ï¼Œä¾›åç»­è®¿é—®
                window.currentMarkmapInstance = markmapInstance;
                
                // æ·»åŠ ä¸“é—¨çš„CSSæ ·å¼æ¥ä¼˜åŒ–æ–‡å­—æ˜¾ç¤º
                const mindmapStyles = document.createElement('style');
                mindmapStyles.innerHTML = `
                    /* æ¸©å’Œçš„åˆå§‹åŒ–è¿‡æ¸¡æ•ˆæœ */
                    #mindmapContent svg {
                        transition: all 0.5s ease-in-out;
                    }
                    
                    /* ä¼˜åŒ–æ€ç»´å¯¼å›¾æ–‡å­—æ˜¾ç¤ºæ•ˆæœ */
                    #mindmapContent svg text {
                        font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif !important;
                        font-size: 14px !important;
                        font-weight: 500 !important;
                        fill: #1f2937 !important;
                        stroke: none !important;
                        text-rendering: optimizeLegibility !important;
                        -webkit-font-smoothing: antialiased !important;
                        -moz-osx-font-smoothing: grayscale !important;
                    }
                    
                    /* æ ¹æ®å±‚çº§è°ƒæ•´å­—ä½“å¤§å° - autoFitä¼šè‡ªåŠ¨å¤„ç†ç¼©æ”¾ */
                    #mindmapContent svg g[data-depth="0"] text {
                        font-size: 18px !important;
                        font-weight: 700 !important;
                        fill: #111827 !important;
                    }
                    
                    #mindmapContent svg g[data-depth="1"] text {
                        font-size: 16px !important;
                        font-weight: 600 !important;
                        fill: #374151 !important;
                    }
                    
                    #mindmapContent svg g[data-depth="2"] text {
                        font-size: 14px !important;
                        font-weight: 500 !important;
                        fill: #4b5563 !important;
                    }
                    
                    #mindmapContent svg g[data-depth="3"] text {
                        font-size: 13px !important;
                        font-weight: 500 !important;
                        fill: #6b7280 !important;
                    }
                    
                    #mindmapContent svg g[data-depth="4"] text {
                        font-size: 12px !important;
                        font-weight: 400 !important;
                        fill: #9ca3af !important;
                    }
                    
                    /* ä¼˜åŒ–èŠ‚ç‚¹åœ†åœˆå’Œè¿æ¥çº¿ */
                    #mindmapContent svg circle {
                        stroke-width: 2 !important;
                        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)) !important;
                    }
                    
                    #mindmapContent svg path {
                        stroke-width: 3 !important;
                        opacity: 0.7 !important;
                    }
                    
                    /* ä¼˜åŒ–æ•´ä½“SVGæ˜¾ç¤º */
                    #mindmapContent svg {
                        background: #fafbfc !important;
                        border-radius: 8px !important;
                    }
                    
                    /* é˜²æ­¢æ–‡å­—è¢«æˆªæ–­ */
                    #mindmapContent svg foreignObject {
                        overflow: visible !important;
                    }
                    
                    /* ç¡®ä¿æ–‡æœ¬åŒ…è£…æ­£ç¡® */
                    #mindmapContent svg .mm-t {
                        white-space: nowrap !important;
                        overflow: visible !important;
                    }
                `;
                document.head.appendChild(mindmapStyles);
                
                // ä¸ç«‹å³è¿›è¡Œé€‚é…ï¼Œç­‰å¾…å®Œå…¨åˆå§‹åŒ–åå†æ˜¾ç¤º
                console.log('âœ… Markmapå®ä¾‹åˆ›å»ºå®Œæˆï¼Œç­‰å¾…åˆå§‹åŒ–...');
                
                // å¼ºåŒ–çš„å¤šæ¬¡é‡è¯•é€‚é…æœºåˆ¶
                const autoFitWithRetry = () => {
                    const maxRetries = 3; // å‡å°‘é‡è¯•æ¬¡æ•°
                    const delays = [200, 500, 800]; // è°ƒæ•´å»¶è¿Ÿæ—¶é—´
                    
                    const attemptFit = (attempt) => {
                        setTimeout(() => {
                            try {
                                console.log(`ğŸ”„ ç¬¬${attempt + 1}æ¬¡é€‚é…å°è¯•...`);
                                
                                // éªŒè¯SVGå†…å®¹æ˜¯å¦æ­£ç¡®æ¸²æŸ“
                                const hasValidContent = () => {
                                    const gElements = svg.querySelectorAll('g');
                                    const circles = svg.querySelectorAll('circle');
                                    const texts = svg.querySelectorAll('text');
                                    const paths = svg.querySelectorAll('path');
                                    
                                    return gElements.length > 0 && (circles.length > 0 || texts.length > 0 || paths.length > 0);
                                };
                                
                                if (!hasValidContent()) {
                                    console.log('ğŸ” SVGå†…å®¹æœªæ­£ç¡®æ¸²æŸ“ï¼Œç­‰å¾…ä¸‹æ¬¡å°è¯•');
                                    if (attempt < maxRetries - 1) {
                                        attemptFit(attempt + 1);
                                    }
                                    return;
                                }
                                
                                // å…ˆæ£€æŸ¥æ ¹èŠ‚ç‚¹æ˜¯å¦æœ‰æ•ˆ
                                if (root && typeof root === 'object') {
                                    // ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰æœ‰æ•ˆçš„åæ ‡
                                    const validateNode = (node) => {
                                        if (node) {
                                            if (!node.x) node.x = 0;
                                            if (!node.y) node.y = 0;
                                            if (node.children && Array.isArray(node.children)) {
                                                node.children.forEach(validateNode);
                                            }
                                        }
                                    };
                                    
                                    validateNode(root);
                                    
                                    // ä¿®å¤ç°æœ‰çš„SVGå…ƒç´ 
                                    const gElements = svg.querySelectorAll('g');
                                    gElements.forEach(g => {
                                        const transform = g.getAttribute('transform');
                                        if (transform && transform.includes('NaN')) {
                                            console.log('ğŸš¨ ä¿®å¤æ— æ•ˆtransform:', transform);
                                            g.setAttribute('transform', 'translate(400, 300) scale(0.6)');
                                        }
                                    });
                                    
                                    // å°è¯•é€‚é…
                                    if (markmapInstance && typeof markmapInstance.fit === 'function') {
                                        markmapInstance.fit();
                                        console.log(`âœ… ç¬¬${attempt + 1}æ¬¡é€‚é…æˆåŠŸ`);
                                        
                                        // é€‚é…æˆåŠŸåï¼Œæ¸©å’Œåœ°è¿‡æ¸¡åˆ°æ­£å¸¸å¤§å°
                                        setTimeout(() => {
                                            svg.style.transform = 'scale(1)';
                                            svg.style.opacity = '1';
                                        }, 100);
                                        
                                        
                                    } else {
                                        console.warn('âš ï¸ markmapInstanceæˆ–fitæ–¹æ³•ä¸å¯ç”¨');
                                        // å¤‡ç”¨æ–¹æ¡ˆï¼šç›´æ¥è®¾ç½®ä¸»ç¾¤ç»„çš„transform
                                        const mainGroup = svg.querySelector('g');
                                        if (mainGroup) {
                                            mainGroup.setAttribute('transform', 'translate(400, 300) scale(0.55)');
                                            console.log('âœ… ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆè®¾ç½®Transform');
                                            
                                            // åº”ç”¨å¹³æ»‘è¿‡æ¸¡
                                            setTimeout(() => {
                                                svg.style.transform = 'scale(1)';
                                                svg.style.opacity = '1';
                                            }, 100);
                                        }
                                    }
                                    
                                } else {
                                    console.warn('âš ï¸ æ ¹èŠ‚ç‚¹æ— æ•ˆï¼Œè·³è¿‡è‡ªåŠ¨é€‚é…');
                                    if (attempt < maxRetries - 1) {
                                        attemptFit(attempt + 1);
                                    }
                                }
                                
                            } catch (error) {
                                console.error(`âŒ ç¬¬${attempt + 1}æ¬¡é€‚é…å¤±è´¥:`, error);
                                if (attempt < maxRetries - 1) {
                                    attemptFit(attempt + 1);
                                }
                            }
                        }, delays[attempt]);
                    };
                    
                    // å¼€å§‹é‡è¯•
                    attemptFit(0);
                };
                
                // æ‰§è¡Œå¼ºåŒ–çš„é€‚é…
                autoFitWithRetry();
                
                // ä¸ºæ§åˆ¶æŒ‰é’®æ·»åŠ äº‹ä»¶
                
                // ç¼©æ”¾æ§åˆ¶å˜é‡
                let currentScale = 1.0; // ä½¿ç”¨æ ‡å‡†ç¼©æ”¾ï¼ŒautoFitä¼šè‡ªåŠ¨å¤„ç†æœ€ä½³æ˜¾ç¤º
                const scaleStep = 0.2;
                const maxScale = 3.0;
                const minScale = 0.3;
                
                // æ”¾å¤§æŒ‰é’®
                const zoomInBtn = document.getElementById('zoomIn');
                if (zoomInBtn) {
                    zoomInBtn.addEventListener('click', () => {
                        currentScale = Math.min(currentScale + scaleStep, maxScale);
                        applyCustomScale(currentScale);
                        console.log('ğŸ” æ”¾å¤§åˆ°:', currentScale);
                    });
                }
                
                // ç¼©å°æŒ‰é’®
                const zoomOutBtn = document.getElementById('zoomOut');
                if (zoomOutBtn) {
                    zoomOutBtn.addEventListener('click', () => {
                        currentScale = Math.max(currentScale - scaleStep, minScale);
                        applyCustomScale(currentScale);
                        console.log('ğŸ” ç¼©å°åˆ°:', currentScale);
                    });
                }
                
                // é‡ç½®ç¼©æ”¾æŒ‰é’®
                const resetZoomBtn = document.getElementById('resetZoom');
                if (resetZoomBtn) {
                    resetZoomBtn.addEventListener('click', () => {
                        currentScale = 1.0;
                        applyCustomScale(currentScale);
                        console.log('ğŸ”„ é‡ç½®ç¼©æ”¾åˆ°:', currentScale);
                    });
                }
                
                // åº”ç”¨ç¼©æ”¾çš„å‡½æ•°
                const applyCustomScale = (scale) => {
                    try {
                        const mainGroup = svg.querySelector('g');
                        if (mainGroup) {
                            // è®¡ç®—ä¸­å¿ƒä½ç½®
                            const svgRect = svg.getBoundingClientRect();
                            const centerX = svgRect.width / 2;
                            const centerY = svgRect.height / 2;
                            
                            // åº”ç”¨å˜æ¢ï¼šå…ˆå±…ä¸­å†ç¼©æ”¾
                            const transform = `translate(${centerX}, ${centerY}) scale(${scale})`;
                            mainGroup.setAttribute('transform', transform);
                            
                            console.log(`âœ… åº”ç”¨ç¼©æ”¾: ${scale}, Transform: ${transform}`);
                        } else {
                            console.warn('âš ï¸ æœªæ‰¾åˆ°ä¸»ç¾¤ç»„å…ƒç´ ');
                        }
                    } catch (error) {
                        console.error('âŒ åº”ç”¨ç¼©æ”¾å¤±è´¥:', error);
                    }
                };
                
                const expandAllBtn = document.getElementById('expandAll');
                if (expandAllBtn) {
                    expandAllBtn.addEventListener('click', () => {
                        console.log('ğŸ” å±•å¼€æ‰€æœ‰èŠ‚ç‚¹');
                        try {
                            if (markmapInstance && markmapInstance.state && markmapInstance.state.data) {
                                // ä½¿ç”¨ç°æœ‰å®ä¾‹çš„å±•å¼€åŠŸèƒ½
                                const expandNodeRecursively = (node) => {
                                    if (node) {
                                        // æ¸…é™¤æŠ˜å çŠ¶æ€
                                        if (node.payload) {
                                            delete node.payload.fold;
                                        }
                                        if (node.children && Array.isArray(node.children)) {
                                            node.children.forEach(expandNodeRecursively);
                                        }
                                    }
                                };
                                
                                const rootData = markmapInstance.state.data;
                                expandNodeRecursively(rootData);
                                
                                // é‡æ–°æ¸²æŸ“ç°æœ‰å®ä¾‹
                                markmapInstance.setData(rootData);
                                
                                console.log('âœ… å±•å¼€æ‰€æœ‰èŠ‚ç‚¹æˆåŠŸ');
                            } else if (markmapInstance && typeof markmapInstance.fit === 'function') {
                                // å¤‡ç”¨æ–¹æ¡ˆï¼šé‡æ–°é€‚é…è§†å›¾
                                console.log('âš ï¸ ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆï¼šé‡æ–°é€‚é…è§†å›¾');
                                markmapInstance.fit();
                            } else {
                                console.warn('âš ï¸ Markmapå®ä¾‹æˆ–ç›¸å…³æ–¹æ³•ä¸å¯ç”¨');
                            }
                        } catch (error) {
                            console.error('âŒ å±•å¼€èŠ‚ç‚¹æ—¶å‡ºé”™:', error);
                        }
                    });
                }
                
                const collapseAllBtn = document.getElementById('collapseAll');
                if (collapseAllBtn) {
                    collapseAllBtn.addEventListener('click', () => {
                        console.log('ğŸ“‹ æŠ˜å æ‰€æœ‰èŠ‚ç‚¹');
                        try {
                            if (markmapInstance && markmapInstance.state && markmapInstance.state.data) {
                                // ä½¿ç”¨ç°æœ‰å®ä¾‹çš„æŠ˜å åŠŸèƒ½
                                const collapseNodeRecursively = (node, level = 0) => {
                                    if (node && level > 0) {
                                        // æŠ˜å é™¤äº†æ ¹èŠ‚ç‚¹ä»¥å¤–çš„æ‰€æœ‰èŠ‚ç‚¹
                                        node.payload = node.payload || {};
                                        node.payload.fold = 1; // 1è¡¨ç¤ºæŠ˜å 
                                    }
                                    if (node.children && Array.isArray(node.children)) {
                                        node.children.forEach(child => collapseNodeRecursively(child, level + 1));
                                    }
                                };
                                
                                const rootData = markmapInstance.state.data;
                                collapseNodeRecursively(rootData);
                                
                                // é‡æ–°æ¸²æŸ“ç°æœ‰å®ä¾‹
                                markmapInstance.setData(rootData);
                                
                                console.log('âœ… æŠ˜å æ‰€æœ‰èŠ‚ç‚¹æˆåŠŸ');
                            } else if (markmapInstance && typeof markmapInstance.fit === 'function') {
                                // å¤‡ç”¨æ–¹æ¡ˆï¼šå¦‚æœæ²¡æœ‰stateæ•°æ®ï¼Œå°±ç®€å•é‡æ–°é€‚é…
                                console.log('âš ï¸ ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆï¼šé‡æ–°é€‚é…è§†å›¾');
                                markmapInstance.fit();
                            } else {
                                console.warn('âš ï¸ Markmapå®ä¾‹æˆ–ç›¸å…³æ–¹æ³•ä¸å¯ç”¨');
                            }
                        } catch (error) {
                            console.error('âŒ æŠ˜å èŠ‚ç‚¹æ—¶å‡ºé”™:', error);
                        }
                    });
                }
                
                const downloadMindmapBtn = document.getElementById('downloadMindmap');
                if (downloadMindmapBtn) {
                    downloadMindmapBtn.addEventListener('click', () => {
                        console.log('ğŸ’¾ ä¸‹è½½æ€ç»´å¯¼å›¾');
                        // è·å–SVGå†…å®¹å¹¶ä¸‹è½½
                        const svgData = svg.outerHTML;
                        const blob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = 'åç«¯å·¥ç¨‹å¸ˆå­¦ä¹ è·¯çº¿å›¾.svg';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                        alert('æ€ç»´å¯¼å›¾å·²ä¸‹è½½ï¼');
                    });
                }
                
                console.log('ğŸ‰ æ€ç»´å¯¼å›¾åˆå§‹åŒ–å®Œæˆï¼å·²è‡ªåŠ¨é€‚é…æ˜¾ç¤ºå…¨éƒ¨å†…å®¹');
                
                // ä¿®å¤æœ€å¸¸è§çš„SVG transformé”™è¯¯
                const fixSvgTransformErrors = () => {
                    console.log('ğŸ”§ å°è¯•ä¿®å¤SVG transformé”™è¯¯...');
                    try {
                        // è·å–æ‰€æœ‰gå…ƒç´ 
                        const gElements = svg.querySelectorAll('g');
                        let fixedCount = 0;
                        
                        // æ£€æŸ¥æ¯ä¸ªgå…ƒç´ çš„transformå±æ€§
                        gElements.forEach(g => {
                            const transform = g.getAttribute('transform');
                            if (transform && transform.includes('NaN')) {
                                // å‘ç°æ— æ•ˆçš„å˜æ¢ï¼Œå°†å…¶è®¾ç½®ä¸ºæœ‰æ•ˆå€¼
                                console.log('ğŸš¨ å‘ç°æ— æ•ˆçš„transform:', transform);
                                g.setAttribute('transform', 'translate(0,0) scale(1)');
                                fixedCount++;
                            }
                        });
                        
                        console.log(`âœ… SVGé”™è¯¯ä¿®å¤å®Œæˆ: å…±ä¿®å¤${fixedCount}ä¸ªèŠ‚ç‚¹`);
                    } catch (error) {
                        console.error('âŒ ä¿®å¤SVGé”™è¯¯æ—¶å‡ºé”™:', error);
                    }
                };
                
                // åœ¨åˆå§‹åŒ–åå»¶è¿Ÿæ‰§è¡Œä¿®å¤
                setTimeout(() => {
                    fixSvgTransformErrors();
                }, 500);
                
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–æ€ç»´å¯¼å›¾æ—¶å‡ºé”™:', error);
                showMarkmapFallback();
            }
        }
        
        function showMarkmapFallback() {
            console.log('ğŸš‘ æ˜¾ç¤ºæ€ç»´å¯¼å›¾é™çº§æ–¹æ¡ˆ');
            const mindmapElement = document.getElementById('mindmapContent');
            if (mindmapElement) {
                mindmapElement.innerHTML = `
                    <div class="mindmap-fallback" style="
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        min-height: 400px;
                        text-align: center;
                        padding: 2rem;
                        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
                        border: 1px solid #e5e7eb;
                        border-radius: 8px;
                    ">
                        <div style="
                            width: 80px;
                            height: 80px;
                            border-radius: 50%;
                            background: #fbbf24;
                            color: white;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2rem;
                            margin-bottom: 1.5rem;
                            animation: pulse 2s infinite;
                        ">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <h3 style="
                            font-size: 1.25rem;
                            font-weight: 600;
                            color: #111827;
                            margin: 0 0 1rem 0;
                        ">æ­£åœ¨åŠ è½½æ€ç»´å¯¼å›¾...</h3>
                        <p style="
                            font-size: 0.875rem;
                            color: #6b7280;
                            line-height: 1.6;
                            margin: 0 0 1.5rem 0;
                            max-width: 400px;
                        ">å¦‚æœé•¿æ—¶é—´æœªåŠ è½½ï¼Œå¯èƒ½æ˜¯ç½‘ç»œè¿æ¥é—®é¢˜æˆ–æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ã€‚è¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p>
                        
                        <!-- æ“ä½œå»ºè®® -->
                        <div style="
                            display: flex;
                            flex-direction: column;
                            gap: 0.75rem;
                            margin-bottom: 1.5rem;
                            text-align: left;
                        ">
                            <div style="display: flex; align-items: center; color: #4b5563;">
                                <i class="fas fa-redo" style="margin-right: 0.5rem; color: #6366f1;"></i>
                                <span>åˆ·æ–°é¡µé¢é‡è¯•</span>
                            </div>
                            <div style="display: flex; align-items: center; color: #4b5563;">
                                <i class="fas fa-wifi" style="margin-right: 0.5rem; color: #6366f1;"></i>
                                <span>æ£€æŸ¥ç½‘ç»œè¿æ¥</span>
                            </div>
                            <div style="display: flex; align-items: center; color: #4b5563;">
                                <i class="fas fa-browser" style="margin-right: 0.5rem; color: #6366f1;"></i>
                                <span>æ›´æ–°æµè§ˆå™¨ç‰ˆæœ¬</span>
                            </div>
                        </div>
                        
                        <!-- é‡è¯•æŒ‰é’® -->
                        <button onclick="location.reload()" style="
                            padding: 0.75rem 1.5rem;
                            border-radius: 8px;
                            border: none;
                            background: #6366f1;
                            color: white;
                            font-weight: 500;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        " 
                        onmouseover="this.style.background='#4f46e5'" 
                        onmouseout="this.style.background='#6366f1'">
                            <i class="fas fa-redo" style="margin-right: 0.5rem;"></i>
                            é‡æ–°åŠ è½½é¡µé¢
                        </button>
                        
                        <!-- ç®€åŒ–ç‰ˆæœ¬æç¤º -->
                        <div style="
                            margin-top: 2rem;
                            padding: 1rem;
                            background: rgba(99, 102, 241, 0.1);
                            border-radius: 6px;
                            border-left: 4px solid #6366f1;
                        ">
                            <p style="
                                margin: 0;
                                font-size: 0.75rem;
                                color: #4b5563;
                                line-height: 1.5;
                            ">
                                <strong>ğŸ’¡ æç¤ºï¼š</strong>
                                æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å·¦ä¾§å¯¼èˆªæŸ¥çœ‹å…¶ä»–å­¦ä¹ èµ„æ–™ï¼Œ
                                åŒ…æ‹¬çŸ¥è¯†ç‚¹ã€é¢è¯•é¢˜ã€è¯¾ç¨‹æ¨èç­‰å†…å®¹ã€‚
                            </p>
                        </div>
                    </div>
                    
                    <style>
                        @keyframes pulse {
                            0% { opacity: 1; transform: scale(1); }
                            50% { opacity: 0.7; transform: scale(1.05); }
                            100% { opacity: 1; transform: scale(1); }
                        }
                    </style>
                `;
            }
        }
    </script>
</head>
<body>
    <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
    <header class="results-header">
        <!-- è¿”å›ç®­å¤´ -->
        <button class="back-arrow-btn" onclick="goBackToJobInput()" title="è¿”å›èŒä½è¾“å…¥é¡µé¢">
            <i class="fas fa-arrow-left"></i>
        </button>
        
        <h1 class="results-title">
            <i class="fas fa-graduation-cap"></i>
            <span id="jobTitleDisplay">åç«¯å·¥ç¨‹å¸ˆ</span>
        </h1>
        
        <div class="results-meta">
            <div class="generation-time">
                <i class="fas fa-clock"></i>
                <span id="generationTimeDisplay">2025/08/17 16:20:14</span>
            </div>
        </div>
        
        <div class="results-actions">
<button class="result-action-btn" id="configApiBtn" onclick="openApiConfigModal(); console.log('ğŸ› ï¸ å†…è”äº‹ä»¶è¢«è§¦å‘');">
    <i class="fas fa-cog"></i>
    é…ç½®APIå¯†é’¥
</button>
            <button class="result-action-btn" id="saveBtn">
                <i class="fas fa-save"></i>
                ä¿å­˜
            </button>
            <button class="result-action-btn" id="exportPdfBtn">
                <i class="fas fa-file-pdf"></i>
                å¯¼å‡ºPDF
            </button>
            <button class="result-action-btn" id="exportFeishuBtn">
                <i class="fas fa-file-alt"></i>
                å¯¼å‡ºé£ä¹¦æ–‡æ¡£
            </button>
        </div>
    </header>
    
    <!-- ä¸»è¦å†…å®¹å®¹å™¨ -->
    <div class="results-container">
        <!-- ä¸‰åˆ—å¸ƒå±€ -->
        <div class="content-layout">
            <!-- å·¦ä¾§ç›®å½• -->
            <aside class="content-sidebar">
                <div class="sidebar-header">
                    <h3>ç›®å½•</h3>
                </div>
                
                <!-- ä¸»å†…å®¹ç›®å½• -->
                <div class="sidebar-section">
                    <h4 class="sidebar-section-title" id="sidebarJobTitle">åç«¯å·¥ç¨‹å¸ˆ</h4>
                    <ul class="content-nav-list">
                        <li class="nav-item" data-target="mindmap">
                            <i class="fas fa-project-diagram"></i>
                            <span>æ€ç»´å¯¼å›¾</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                        <li class="nav-item" data-target="knowledge">
                            <i class="fas fa-lightbulb"></i>
                            <span>çŸ¥è¯†ç‚¹</span>
                            <span class="item-count" id="knowledgeCount">(1)</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                        <li class="nav-item active" data-target="interview">
                            <i class="fas fa-question-circle"></i>
                            <span>é«˜é¢‘é¢è¯•é¢˜</span>
                            <span class="item-count" id="interviewCount">(15)</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                        <li class="nav-item" data-target="books">
                            <i class="fas fa-book"></i>
                            <span>æ¨èä¹¦ç±</span>
                            <span class="item-count" id="booksCount">(8)</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                        <li class="nav-item" data-target="certificates">
                            <i class="fas fa-certificate"></i>
                            <span>è¯ä¹¦</span>
                            <span class="item-count" id="certificatesCount">(5)</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                        <li class="nav-item" data-target="courses">
                            <i class="fas fa-graduation-cap"></i>
                            <span>æ¨èè¯¾ç¨‹</span>
                            <span class="item-count" id="coursesCount">(12)</span>
                            <i class="fas fa-chevron-right nav-arrow"></i>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- ä¸­é—´å†…å®¹åŒºåŸŸ -->
            <main class="content-main">
                <!-- æ€ç»´å¯¼å›¾åŒºåŸŸ -->
                <div class="content-section" id="mindmapSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-project-diagram"></i>
                            æ€ç»´å¯¼å›¾
                        </h2>
                        <div>
                            <button class="expand-all-btn" id="zoomIn">
                                <i class="fas fa-search-plus"></i>
                                æ”¾å¤§
                            </button>
                            <button class="expand-all-btn" id="zoomOut">
                                <i class="fas fa-search-minus"></i>
                                ç¼©å°
                            </button>
                            <button class="expand-all-btn" id="resetZoom">
                                <i class="fas fa-expand-arrows-alt"></i>
                                é‡ç½®
                            </button>
                            <button class="expand-all-btn" id="expandAll">
                                <i class="fas fa-expand-arrows-alt"></i>
                                å±•å¼€å…¨éƒ¨
                            </button>
                            <button class="expand-all-btn" id="collapseAll">
                                <i class="fas fa-compress-arrows-alt"></i>
                                æŠ˜å å…¨éƒ¨
                            </button>
                            <button class="expand-all-btn" id="downloadMindmap">
                                <i class="fas fa-download"></i>
                                ä¸‹è½½
                            </button>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="mindmap-card">
                            <div class="mindmap-content" id="mindmapContent">
                                <!-- æ€ç»´å¯¼å›¾å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- é¢è¯•é¢˜å†…å®¹é»˜è®¤æ˜¾ç¤º -->
                <div class="content-section active" id="interviewSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-question-circle"></i>
                            é«˜é¢‘é¢è¯•é¢˜
                        </h2>
                    </div>
                    <div class="section-content">
                        <!-- é¢è¯•é¢˜å¡ç‰‡ -->
                        <div class="interview-card">
                            <div class="interview-question-container" style="position: relative; margin-bottom: 1rem;">
                                <h3 class="interview-question">è§£é‡ŠJavaScriptä¸­çš„é—­åŒ…æ¦‚å¿µï¼Œå¹¶ä¸¾ä¾‹è¯´æ˜å…¶åº”ç”¨åœºæ™¯</h3>
                                <button class="ai-chat-btn" onclick="startAIChat('js-closure')" title="ä¸AIåŠ©æ‰‹è®¨è®ºæ­¤é¢˜ç›®" style="
                                    position: absolute;
                                    top: 50%;
                                    right: 12px;
                                    transform: translateY(-50%);
                                    width: 36px;
                                    height: 36px;
                                    border: none;
                                    background: rgba(255, 255, 255, 0.9);
                                    color: #6366f1;
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                                    backdrop-filter: blur(4px);
                                    z-index: 10;
                                ">
                                    <i class="fas fa-robot" style="font-size: 16px;"></i>
                                </button>
                            </div>
                            <div class="interview-tags">
                                <span class="interview-tag primary">ä¸­ç­‰</span>
                                <span class="interview-tag tech">JavaScript</span>
                                <span class="interview-tag secondary">å‰ç«¯å¼€å‘</span>
                            </div>
                                                    
                            <!-- è§£é¢˜æ€è·¯å’Œç­”æ¡ˆæŒ‰é’®åŒºåŸŸ -->
                            <div class="interview-helper-actions" style="display: flex; gap: 0.75rem; margin: 1.5rem 0;">
                                <button class="interview-btn solution" onclick="showSolution('js-closure')" style="flex: 1;">
                                    <i class="fas fa-lightbulb"></i>
                                    è§£é¢˜æ€è·¯
                                </button>
                                <button class="interview-btn secondary" onclick="showAnswer('js-closure')" style="flex: 1;">
                                    <i class="fas fa-eye"></i>
                                    æŸ¥çœ‹ç­”æ¡ˆ
                                </button>
                            </div>
                            
                            <!-- è§£é¢˜æ€è·¯åŒºåŸŸ -->
                            <div class="solution-area" id="solution-js-closure">
                                <div class="solution-title">
                                    <i class="fas fa-lightbulb"></i>
                                    JavaScripté—­åŒ…è§£é¢˜æ€è·¯
                                </div>
                                <div class="solution-content">
                                    <h4>1. ç†è§£é¢˜ç›®è¦æ±‚</h4>
                                    <p>é¢è¯•å®˜æƒ³äº†è§£ä½ å¯¹é—­åŒ…æ¦‚å¿µçš„æŒæ¡ç¨‹åº¦ï¼ŒåŒ…æ‹¬ï¼š</p>
                                    <ul>
                                        <li>é—­åŒ…çš„å®šä¹‰å’ŒåŸç†</li>
                                        <li>é—­åŒ…çš„å®é™…åº”ç”¨åœºæ™¯</li>
                                        <li>é—­åŒ…å¯èƒ½å¸¦æ¥çš„é—®é¢˜</li>
                                    </ul>
                                    
                                    <h4>2. å›ç­”è¦ç‚¹</h4>
                                    <ul>
                                        <li><strong>å®šä¹‰ï¼š</strong>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°</li>
                                        <li><strong>åŸç†ï¼š</strong>å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›å˜é‡ä»ç„¶è¢«ä¿å­˜åœ¨å†…å­˜ä¸­</li>
                                        <li><strong>åº”ç”¨ï¼š</strong>æ¨¡å—åŒ–ç¼–ç¨‹ã€ç§æœ‰å˜é‡ã€å›è°ƒå‡½æ•°ç­‰</li>
                                    </ul>
                                    
                                    <h4>3. ç¤ºä¾‹ä»£ç </h4>
                                    <p>å‡†å¤‡ä¸€ä¸ªç®€å•çš„é—­åŒ…ç¤ºä¾‹ï¼š</p>
                                    <pre style="background: #f8f9fa; padding: 1rem; border-radius: 6px; overflow-x: auto;"><code>function createCounter() {
    let count = 0;
    return function() {
        return ++count;
    };
}
const counter = createCounter();
console.log(counter()); // 1
console.log(counter()); // 2</code></pre>
                                    
                                    <h4>4. æ³¨æ„äº‹é¡¹</h4>
                                    <ul>
                                        <li>æåˆ°å†…å­˜æ³„æ¼çš„é£é™©</li>
                                        <li>è¯´æ˜å¦‚ä½•é¿å…é—­åŒ…é™·é˜±</li>
                                        <li>å¼ºè°ƒåˆç†ä½¿ç”¨çš„é‡è¦æ€§</li>
                                    </ul>
                                </div>
                            </div>
                            

                            <!-- ç­”æ¡ˆæ˜¾ç¤ºåŒºåŸŸ -->
                            <div class="answer-area" id="answer-js-closure">
                                <div class="answer-title">
                                    <i class="fas fa-check-circle"></i>
                                    å‚è€ƒç­”æ¡ˆ
                                </div>
                                <div class="answer-content">
                                    <h4>é—­åŒ…çš„å®šä¹‰å’ŒåŸç†</h4>
                                    <p><strong>å®šä¹‰ï¼š</strong>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°ã€‚å³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»è¿”å›ï¼Œé—­åŒ…ä»ç„¶èƒ½å¤Ÿè®¿é—®åˆ°é‚£äº›å˜é‡ã€‚</p>
                                    
                                    <p><strong>å·¥ä½œåŸç†ï¼š</strong>å½“ä¸€ä¸ªå†…éƒ¨å‡½æ•°è¢«å®šä¹‰åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨æ—¶ï¼Œå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚å³ä½¿å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›å˜é‡ä»ç„¶ä¼šè¢«ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œä¾›å†…éƒ¨å‡½æ•°ä½¿ç”¨ã€‚</p>
                                    
                                    <h4>å®é™…åº”ç”¨åœºæ™¯</h4>
                                    <ul>
                                        <li><strong>æ¨¡å—åŒ–ç¼–ç¨‹ï¼š</strong>åˆ›å»ºç§æœ‰ä½œç”¨åŸŸï¼Œé˜²æ­¢å˜é‡æ±¡æŸ“å…¨å±€å‘½åç©ºé—´</li>
                                        <li><strong>å›è°ƒå‡½æ•°ï¼š</strong>åœ¨äº‹ä»¶å¤„ç†ã€å®šæ—¶å™¨ä¸­ä¿æŒå¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨</li>
                                        <li><strong>å‡½æ•°å·¥å‚ï¼š</strong>åˆ›å»ºå…·æœ‰ç‰¹å®šåŠŸèƒ½çš„å‡½æ•°</li>
                                        <li><strong>æ•°æ®éšè—ï¼š</strong>å®ç°ç±»ä¼¼ç§æœ‰å±æ€§çš„æ•ˆæœ</li>
                                    </ul>
                                    
                                    <h4>ä»£ç ç¤ºä¾‹</h4>
                                    <pre style="background: #f8f9fa; padding: 1rem; border-radius: 6px; overflow-x: auto;"><code>// ç¤ºä¾‹1ï¼šè®¡æ•°å™¨
function createCounter() {
    let count = 0;
    return function() {
        return ++count;
    };
}
const counter = createCounter();
console.log(counter()); // 1
console.log(counter()); // 2

// ç¤ºä¾‹2ï¼šç§æœ‰å˜é‡
function createPerson(name) {
    let age = 0;
    return {
        getName: function() { return name; },
        getAge: function() { return age; },
        setAge: function(newAge) { age = newAge; },
        growUp: function() { age++; }
    };
}
const person = createPerson('Alice');
person.setAge(25);
</`

// ç”Ÿæˆç­”æ¡ˆå†…å®¹çš„å‡½æ•°
function generateAnswerContent(questionId) {
    // æ ¹æ®é¢˜ç›®IDè¿”å›å¯¹åº”çš„ç­”æ¡ˆï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªé»˜è®¤çš„ç­”æ¡ˆæ ¼å¼
    return `
        <div class="answer-title">
            <i class="fas fa-check-circle"></i>
            å‚è€ƒç­”æ¡ˆ
        </div>
        <div class="answer-content">
            <h4>æ ‡å‡†ç­”æ¡ˆè¦ç‚¹</h4>
            <p>è¿™é‡Œä¼šæ˜¾ç¤ºè¯¥é¢è¯•é¢˜çš„è¯¦ç»†å‚è€ƒç­”æ¡ˆï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ¦‚å¿µã€å®é™…åº”ç”¨ã€ä»£ç ç¤ºä¾‹ç­‰å†…å®¹ã€‚</p>
            
            <h4>è¯„åˆ†æ ‡å‡†</h4>
            <ul>
                <li><strong>åŸºç¡€æ¦‚å¿µç†è§£</strong>ï¼šèƒ½å¤Ÿå‡†ç¡®è¯´å‡ºæ ¸å¿ƒå®šä¹‰</li>
                <li><strong>åŸç†é˜è¿°</strong>ï¼šèƒ½å¤Ÿè§£é‡Šå·¥ä½œæœºåˆ¶å’ŒåŸç†</li>
                <li><strong>å®é™…åº”ç”¨</strong>ï¼šèƒ½å¤Ÿä¸¾å‡ºå…·ä½“çš„åº”ç”¨åœºæ™¯</li>
                <li><strong>ä»£ç ç¤ºä¾‹</strong>ï¼šèƒ½å¤Ÿæä¾›ç›¸å…³çš„ä»£ç æ¼”ç¤º</li>
            </ul>
            
            <h4>åŠ åˆ†é¡¹</h4>
            <ul>
                <li>ä¸»åŠ¨æåŠç›¸å…³çš„æ‰©å±•çŸ¥è¯†ç‚¹</li>
                <li>åˆ†æå¯èƒ½çš„ä¼˜ç¼ºç‚¹æˆ–æ³¨æ„äº‹é¡¹</li>
                <li>å±•ç¤ºå®é™…é¡¹ç›®ç»éªŒ</li>
            </ul>
        </div>
    `;
}

// å…¨å±€æš´éœ²å‡½æ•°ï¼Œç¡®ä¿onclickå¯ä»¥è®¿é—®åˆ°
window.showAnswer = showAnswer;
window.startAIChat = startAIChat;
window.sendMessageToAI = sendMessageToAI;
            
// é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–å’Œæµ‹è¯•
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ“„ é¡µé¢DOMåŠ è½½å®Œæˆ');
                
    // ğŸ”§ å¼ºåˆ¶é‡ç½®ç­”æ¡ˆåŒºåŸŸçŠ¶æ€ - ç¡®ä¿åˆå§‹ä¸ºéšè—çŠ¶æ€
    const answerArea = document.getElementById('answer-js-closure');
    if (answerArea) {
        console.log('ğŸ”§ é‡ç½®ç­”æ¡ˆåŒºåŸŸçŠ¶æ€');
        console.log('  - é‡ç½®å‰ç±»å:', answerArea.className);
        console.log('  - é‡ç½®å‰æ˜¾ç¤ºçŠ¶æ€:', window.getComputedStyle(answerArea).display);
                    
        // å¼ºåˆ¶ç§»é™¤showç±»ï¼Œç¡®ä¿åˆå§‹éšè—
        answerArea.classList.remove('show');
                    
        console.log('  - é‡ç½®åç±»å:', answerArea.className);
        console.log('  - é‡ç½®åæ˜¾ç¤ºçŠ¶æ€:', window.getComputedStyle(answerArea).display);
    }
                
    // æµ‹è¯•å‡½æ•°æ˜¯å¦åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨
    console.log('ğŸ§ª æµ‹è¯•å…¨å±€å‡½æ•°å¯ç”¨æ€§:');
    console.log('  - window.showAnswer:', typeof window.showAnswer);
    console.log('  - showAnswer:', typeof showAnswer);
                
    // æ£€æŸ¥æŒ‰é’®æ˜¯å¦å­˜åœ¨
    const answerBtn = document.querySelector('[onclick*="showAnswer"]');
    console.log('ğŸ” æŒ‰é’®å…ƒç´ æ£€æŸ¥:');
    console.log('  - æŸ¥çœ‹ç­”æ¡ˆæŒ‰é’®:', answerBtn);
                
    if (answerBtn) {
        console.log('  - æŸ¥çœ‹ç­”æ¡ˆæŒ‰é’®onclickå±æ€§:', answerBtn.getAttribute('onclick'));
        // ç¡®ä¿æŒ‰é’®æ–‡å­—æ­£ç¡®
        if (answerArea && !answerArea.classList.contains('show')) {
            answerBtn.innerHTML = '<i class="fas fa-eye"></i>æŸ¥çœ‹ç­”æ¡ˆ';
        }
    }
                
    console.log('âœ… é¡µé¢åˆå§‹åŒ–æ£€æŸ¥å®Œæˆ');
});

// æ›´æ–°initSolutionFeatureå‡½æ•°ï¼ŒåŒæ—¶åˆå§‹åŒ–ç­”æ¡ˆåŠŸèƒ½
console.log(person.getAge()); // 25</code></pre>
                                    
                                    <h4>æ³¨æ„äº‹é¡¹å’Œé™·é˜±</h4>
                                    <ul>
                                        <li><strong>å†…å­˜æ³„æ¼ï¼š</strong>é—­åŒ…ä¼šé˜²æ­¢åƒåœ¾å›æ”¶ï¼Œå¦‚æœä¸æ­£ç¡®ä½¿ç”¨å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼</li>
                                        <li><strong>æ€§èƒ½å½±å“ï¼š</strong>è¿‡åº¦ä½¿ç”¨é—­åŒ…å¯èƒ½å½±å“æ€§èƒ½</li>
                                        <li><strong>å¾ªç¯å¼•ç”¨ï¼š</strong>éœ€è¦æ³¨æ„åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…çš„é—®é¢˜</li>
                                    </ul>
                                </div>
                            </div>
                                                    
                            <textarea class="interview-answer-input" placeholder="è¯·è¾“å…¥æ‚¨çš„ç­”æ¡ˆ..."></textarea>
                            <div class="interview-notes">
                                <textarea class="interview-notes-input" placeholder="åœ¨æ­¤æ·»åŠ æ‚¨çš„ç¬”è®°..."></textarea>
                            </div>
                            <div class="interview-actions">
                                <button class="interview-btn ai-score">
                                    <i class="fas fa-star"></i>
                                    AIè¯„åˆ†
                                </button>
                                <button class="interview-btn primary">
                                    <i class="fas fa-check"></i>
                                    æˆ‘ä¼šäº†
                                </button>
                                <button class="interview-btn outline">
                                    <i class="fas fa-arrow-right"></i>
                                    è®°ä¸€ä¸‹
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- çŸ¥è¯†ç‚¹å†…å®¹ -->
                <div class="content-section" id="knowledgeSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-lightbulb"></i>
                            çŸ¥è¯†ç‚¹
                            <span class="section-count">(1)</span>
                        </h2>
                    </div>
                    <div class="section-content">
                        <div class="knowledge-list">
                            <div class="knowledge-item">
                                <div class="knowledge-header" style="position: relative;">
                                    <div class="knowledge-title">JavaåŸºç¡€è¯­æ³•å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹</div>
                                    <button class="ai-chat-btn" onclick="startAIKnowledgeChat('java-basics')" title="ä¸AIåŠ©æ‰‹è®¨è®ºæ­¤çŸ¥è¯†ç‚¹" style="
                                        position: absolute;
                                        top: 50%;
                                        right: 12px;
                                        transform: translateY(-50%);
                                        width: 36px;
                                        height: 36px;
                                        border: none;
                                        background: rgba(255, 255, 255, 0.9);
                                        color: #6366f1;
                                        border-radius: 50%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        cursor: pointer;
                                        transition: all 0.3s ease;
                                        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                                        backdrop-filter: blur(4px);
                                        z-index: 10;
                                    ">
                                        <i class="fas fa-robot" style="font-size: 16px;"></i>
                                    </button>
                                </div>
                                <div class="knowledge-content">
                                    <div class="knowledge-text">
                                        <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>Javaæ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå…·æœ‰è·¨å¹³å°ã€å®‰å…¨ã€å¥å£®ç­‰ç‰¹ç‚¹ã€‚<br><br>
                                        <strong>é‡è¦ç‰¹æ€§ï¼š</strong><br>
                                        â€¢ <strong>å°è£…ï¼ˆEncapsulationï¼‰ï¼š</strong>å°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•ç»‘å®šåœ¨ä¸€èµ·ï¼Œéšè—å†…éƒ¨å®ç°ç»†èŠ‚<br>
                                        â€¢ <strong>ç»§æ‰¿ï¼ˆInheritanceï¼‰ï¼š</strong>å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°ä»£ç å¤ç”¨<br>
                                        â€¢ <strong>å¤šæ€ï¼ˆPolymorphismï¼‰ï¼š</strong>åŒä¸€ä¸ªæ¥å£å¯ä»¥æœ‰å¤šç§ä¸åŒçš„å®ç°æ–¹å¼<br><br>
                                        <strong>å®é™…åº”ç”¨ï¼š</strong>ä¼ä¸šçº§åº”ç”¨å¼€å‘ã€Androidå¼€å‘ã€å¤§æ•°æ®å¤„ç†ç­‰é¢†åŸŸ
                                    </div>
                                    <div class="knowledge-simple-explanation">
                                        <div class="knowledge-simple-explanation-title">
                                            <i class="fas fa-lightbulb"></i>é€šä¿—è®²è§£
                                        </div>
                                        <div class="knowledge-simple-explanation-content">
                                            æƒ³è±¡Javaå°±åƒä¸€å¥—ä¸‡èƒ½å·¥å…·ç®±ï¼Œå®ƒå¯ä»¥åœ¨å„ç§â€œå·¥åœ°â€ï¼ˆå¹³å°ï¼‰ä¸Šä½¿ç”¨ã€‚å°è£…å°±åƒå°†å·¥å…·å’Œæ“ä½œæ‰‹å†Œæ”¾åœ¨ä¸€èµ·ï¼Œä¸éœ€è¦çŸ¥é“å·¥å…·å†…éƒ¨å¦‚ä½•è¿ä½œï¼›ç»§æ‰¿å°±åƒæ–°å·¥å…·èƒ½å¤Ÿè‡ªåŠ¨æ‹¥æœ‰æ—§å·¥å…·çš„åŠŸèƒ½ï¼›å¤šæ€å°±åƒä¸€æŠŠç‘å£«å†›åˆ€ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å˜æˆä¸åŒçš„å·¥å…·ã€‚Javaåº”ç”¨å¹¿æ³›ï¼Œä»æ‰‹æœºåº”ç”¨åˆ°å¤§å‹é“¶è¡Œç³»ç»Ÿéƒ½åœ¨ä½¿ç”¨å®ƒã€‚
                                        </div>
                                    </div>
                                    <div class="knowledge-notes">
                                        <textarea class="knowledge-notes-input" placeholder="åœ¨æ­¤æ·»åŠ æ‚¨çš„ç¬”è®°..."></textarea>
                                    </div>
                                    <div class="knowledge-actions">
                                        <button class="knowledge-btn secondary">
                                            <i class="fas fa-forward"></i>
                                            ä¸‹ä¸€ä¸ª
                                        </button>
                                        <button class="knowledge-btn primary">
                                            <i class="fas fa-check"></i>
                                            æˆ‘ä¼šäº†
                                        </button>
                                        <button class="knowledge-btn outline">
                                            <i class="fas fa-arrow-right"></i>
                                            è®°ä¸€ä¸‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ä¹¦ç±å†…å®¹ -->
                <div class="content-section" id="booksSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-book"></i>
                            æ¨èä¹¦ç±
                            <span class="section-count">(8)</span>
                        </h2>
                    </div>
                    <div class="section-content">
                        <div class="books-grid">
                            <!-- ä¹¦ç±å¡ç‰‡ -->
                            <div class="book-card">
                                <div class="book-cover">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="book-info">
                                    <h3 class="book-title">Javaæ ¸å¿ƒæŠ€æœ¯å·I</h3>
                                    <p class="book-author">ä½œè€…ï¼šCay S. Horstmann</p>
                                    <p class="book-description">Javaé¢†åŸŸç»å…¸ä¹‹ä½œï¼Œæ·±å…¥è®²è§£Javaæ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µã€‚</p>
                                    <div class="book-rating">
                                        <div class="stars">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <span class="rating-text">9.2/10</span>
                                    </div>
                                    <div class="book-actions">
                                        <button class="book-btn primary">
                                            <i class="fas fa-shopping-cart"></i>
                                            è´­ä¹°
                                        </button>
                                        <button class="book-btn secondary">
                                            <i class="fas fa-eye"></i>
                                            æŸ¥çœ‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="book-card">
                                <div class="book-cover">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="book-info">
                                    <h3 class="book-title">æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</h3>
                                    <p class="book-author">ä½œè€…ï¼šå‘¨å¿—æ˜</p>
                                    <p class="book-description">æ·±å…¥åˆ†æJVMçš„å·¥ä½œåŸç†å’Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚</p>
                                    <div class="book-rating">
                                        <div class="stars">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <span class="rating-text">9.0/10</span>
                                    </div>
                                    <div class="book-actions">
                                        <button class="book-btn primary">
                                            <i class="fas fa-shopping-cart"></i>
                                            è´­ä¹°
                                        </button>
                                        <button class="book-btn secondary">
                                            <i class="fas fa-eye"></i>
                                            æŸ¥çœ‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="book-card">
                                <div class="book-cover">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="book-info">
                                    <h3 class="book-title">Springå®æˆ˜</h3>
                                    <p class="book-author">ä½œè€…ï¼šCraig Walls</p>
                                    <p class="book-description">Springæ¡†æ¶å…¨é¢æŒ‡å—ï¼Œä»åŸºç¡€åˆ°é«˜çº§çš„å®æˆ˜æ•™ç¨‹ã€‚</p>
                                    <div class="book-rating">
                                        <div class="stars">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="far fa-star"></i>
                                        </div>
                                        <span class="rating-text">8.8/10</span>
                                    </div>
                                    <div class="book-actions">
                                        <button class="book-btn primary">
                                            <i class="fas fa-shopping-cart"></i>
                                            è´­ä¹°
                                        </button>
                                        <button class="book-btn secondary">
                                            <i class="fas fa-eye"></i>
                                            æŸ¥çœ‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="book-card">
                                <div class="book-cover">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="book-info">
                                    <h3 class="book-title">MySQLå¿…çŸ¥å¿…ä¼š</h3>
                                    <p class="book-author">ä½œè€…ï¼šBen Forta</p>
                                    <p class="book-description">MySQLæ•°æ®åº“çš„ç»å…¸å…¥é—¨æ•™ç¨‹ï¼Œé€‚åˆåˆå­¦è€…ã€‚</p>
                                    <div class="book-rating">
                                        <div class="stars">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="far fa-star"></i>
                                        </div>
                                        <span class="rating-text">8.5/10</span>
                                    </div>
                                    <div class="book-actions">
                                        <button class="book-btn primary">
                                            <i class="fas fa-shopping-cart"></i>
                                            è´­ä¹°
                                        </button>
                                        <button class="book-btn secondary">
                                            <i class="fas fa-eye"></i>
                                            æŸ¥çœ‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- è¯ä¹¦å†…å®¹ -->
                <div class="content-section" id="certificatesSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-certificate"></i>
                            è¯ä¹¦
                            <span class="section-count">(5)</span>
                        </h2>
                    </div>
                    <div class="section-content">
                        <div class="certificates-grid">
                            <!-- è¯ä¹¦å¡ç‰‡ -->
                            <div class="certificate-card">
                                <div class="certificate-icon">
                                    <i class="fas fa-award"></i>
                                </div>
                                <div class="certificate-info">
                                    <h3 class="certificate-title">Oracle Certified Professional Java SE</h3>
                                    <p class="certificate-issuer">é¢å‘æœºæ„ï¼šOracle</p>
                                    <p class="certificate-description">Java SEå¼€å‘è€…ä¸“ä¸šè®¤è¯ï¼Œè¯æ˜å…·å¤‡Javaæ ¸å¿ƒæŠ€èƒ½ã€‚</p>
                                    <div class="certificate-meta">
                                        <span class="difficulty-badge advanced">é«˜çº§</span>
                                        <span class="validity">æœ‰æ•ˆæœŸï¼š3å¹´</span>
                                    </div>
                                    <div class="certificate-actions">
                                        <button class="cert-btn primary">
                                            <i class="fas fa-external-link-alt"></i>
                                            æŸ¥çœ‹è¯¦æƒ…
                                        </button>
                                        <button class="cert-btn secondary">
                                            <i class="fas fa-bookmark"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificate-card">
                                <div class="certificate-icon">
                                    <i class="fas fa-certificate"></i>
                                </div>
                                <div class="certificate-info">
                                    <h3 class="certificate-title">AWS Certified Solutions Architect</h3>
                                    <p class="certificate-issuer">é¢å‘æœºæ„ï¼šAmazon Web Services</p>
                                    <p class="certificate-description">äº‘æ¶æ„å¸ˆä¸“ä¸šè®¤è¯ï¼Œè¯æ˜å…·å¤‡AWSäº‘æœåŠ¡è®¾è®¡èƒ½åŠ›ã€‚</p>
                                    <div class="certificate-meta">
                                        <span class="difficulty-badge intermediate">ä¸­çº§</span>
                                        <span class="validity">æœ‰æ•ˆæœŸï¼š3å¹´</span>
                                    </div>
                                    <div class="certificate-actions">
                                        <button class="cert-btn primary">
                                            <i class="fas fa-external-link-alt"></i>
                                            æŸ¥çœ‹è¯¦æƒ…
                                        </button>
                                        <button class="cert-btn secondary">
                                            <i class="fas fa-bookmark"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificate-card">
                                <div class="certificate-icon">
                                    <i class="fas fa-medal"></i>
                                </div>
                                <div class="certificate-info">
                                    <h3 class="certificate-title">Spring Professional Certification</h3>
                                    <p class="certificate-issuer">é¢å‘æœºæ„ï¼šPivotal (VMware)</p>
                                    <p class="certificate-description">Springæ¡†æ¶ä¸“ä¸šè®¤è¯ï¼Œè¯æ˜æŒæ¡Springæ ¸å¿ƒæŠ€æœ¯ã€‚</p>
                                    <div class="certificate-meta">
                                        <span class="difficulty-badge intermediate">ä¸­çº§</span>
                                        <span class="validity">æœ‰æ•ˆæœŸï¼š2å¹´</span>
                                    </div>
                                    <div class="certificate-actions">
                                        <button class="cert-btn primary">
                                            <i class="fas fa-external-link-alt"></i>
                                            æŸ¥çœ‹è¯¦æƒ…
                                        </button>
                                        <button class="cert-btn secondary">
                                            <i class="fas fa-bookmark"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificate-card">
                                <div class="certificate-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="certificate-info">
                                    <h3 class="certificate-title">MongoDB Certified Developer</h3>
                                    <p class="certificate-issuer">é¢å‘æœºæ„ï¼šMongoDB Inc.</p>
                                    <p class="certificate-description">MongoDBæ•°æ®åº“å¼€å‘è€…è®¤è¯ï¼Œè¯æ˜å…·å¤‡NoSQLæ•°æ®åº“æŠ€èƒ½ã€‚</p>
                                    <div class="certificate-meta">
                                        <span class="difficulty-badge beginner">åˆçº§</span>
                                        <span class="validity">æœ‰æ•ˆæœŸï¼š2å¹´</span>
                                    </div>
                                    <div class="certificate-actions">
                                        <button class="cert-btn primary">
                                            <i class="fas fa-external-link-alt"></i>
                                            æŸ¥çœ‹è¯¦æƒ…
                                        </button>
                                        <button class="cert-btn secondary">
                                            <i class="fas fa-bookmark"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- è¯¾ç¨‹å†…å®¹ -->
                <div class="content-section" id="coursesSection">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-graduation-cap"></i>
                            æ¨èè¯¾ç¨‹
                            <span class="section-count">(12)</span>
                        </h2>
                    </div>
                    <div class="section-content">
                        <div class="courses-grid">
                            <!-- è¯¾ç¨‹å¡ç‰‡ -->
                            <div class="course-card">
                                <div class="course-thumbnail">
                                    <i class="fas fa-play-circle"></i>
                                    <span class="course-duration">24å°æ—¶</span>
                                </div>
                                <div class="course-info">
                                    <h3 class="course-title">Javaå…¨æ ˆå¼€å‘å®æˆ˜è¯¾ç¨‹</h3>
                                    <p class="course-instructor">è®²å¸ˆï¼šå¼ ä¸‰ | é«˜çº§Javaæ¶æ„å¸ˆ</p>
                                    <p class="course-description">ä»é›¶åŸºç¡€åˆ°é¡¹ç›®å®æˆ˜ï¼Œå…¨é¢æŒæ¡Javaå…¨æ ˆå¼€å‘æŠ€èƒ½ã€‚</p>
                                    <div class="course-meta">
                                        <div class="course-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                            <span class="rating-text">4.9 (2,345äºº)</span>
                                        </div>
                                        <div class="course-level">
                                            <span class="level-badge intermediate">ä¸­çº§</span>
                                        </div>
                                    </div>
                                    <div class="course-price">
                                        <span class="current-price">ï¿¥299</span>
                                        <span class="original-price">ï¿¥599</span>
                                        <span class="discount">5æŠ˜</span>
                                    </div>
                                    <div class="course-actions">
                                        <button class="course-btn primary">
                                            <i class="fas fa-play"></i>
                                            ç«‹å³å­¦ä¹ 
                                        </button>
                                        <button class="course-btn secondary">
                                            <i class="fas fa-heart"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="course-card">
                                <div class="course-thumbnail">
                                    <i class="fas fa-play-circle"></i>
                                    <span class="course-duration">18å°æ—¶</span>
                                </div>
                                <div class="course-info">
                                    <h3 class="course-title">Spring Bootå¾®æœåŠ¡æ¶æ„å®æˆ˜</h3>
                                    <p class="course-instructor">è®²å¸ˆï¼šæå›› | Springæ ¸å¿ƒå¼€å‘è€…</p>
                                    <p class="course-description">æ·±å…¥å­¦ä¹ Spring Bootï¼Œæ„å»ºä¼ä¸šçº§å¾®æœåŠ¡æ¶æ„ã€‚</p>
                                    <div class="course-meta">
                                        <div class="course-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <span class="rating-text">4.7 (1,678äºº)</span>
                                        </div>
                                        <div class="course-level">
                                            <span class="level-badge advanced">é«˜çº§</span>
                                        </div>
                                    </div>
                                    <div class="course-price">
                                        <span class="current-price">ï¿¥399</span>
                                        <span class="original-price">ï¿¥699</span>
                                        <span class="discount">5.7æŠ˜</span>
                                    </div>
                                    <div class="course-actions">
                                        <button class="course-btn primary">
                                            <i class="fas fa-play"></i>
                                            ç«‹å³å­¦ä¹ 
                                        </button>
                                        <button class="course-btn secondary">
                                            <i class="fas fa-heart"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="course-card">
                                <div class="course-thumbnail">
                                    <i class="fas fa-play-circle"></i>
                                    <span class="course-duration">32å°æ—¶</span>
                                </div>
                                <div class="course-info">
                                    <h3 class="course-title">MySQLæ•°æ®åº“ä¼˜åŒ–ä¸è°ƒä¼˜</h3>
                                    <p class="course-instructor">è®²å¸ˆï¼šç‹äº” | æ•°æ®åº“ä¸“å®¶</p>
                                    <p class="course-description">ç³»ç»Ÿå­¦ä¹ MySQLæ€§èƒ½ä¼˜åŒ–ï¼Œæå‡æ•°æ®åº“åº”ç”¨æ€§èƒ½ã€‚</p>
                                    <div class="course-meta">
                                        <div class="course-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                            <span class="rating-text">4.8 (3,124äºº)</span>
                                        </div>
                                        <div class="course-level">
                                            <span class="level-badge intermediate">ä¸­çº§</span>
                                        </div>
                                    </div>
                                    <div class="course-price">
                                        <span class="current-price">ï¿¥199</span>
                                        <span class="original-price">ï¿¥399</span>
                                        <span class="discount">5æŠ˜</span>
                                    </div>
                                    <div class="course-actions">
                                        <button class="course-btn primary">
                                            <i class="fas fa-play"></i>
                                            ç«‹å³å­¦ä¹ 
                                        </button>
                                        <button class="course-btn secondary">
                                            <i class="fas fa-heart"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="course-card">
                                <div class="course-thumbnail">
                                    <i class="fas fa-play-circle"></i>
                                    <span class="course-duration">20å°æ—¶</span>
                                </div>
                                <div class="course-info">
                                    <h3 class="course-title">Redisç¼“å­˜ä¸åˆ†å¸ƒå¼å®æˆ˜</h3>
                                    <p class="course-instructor">è®²å¸ˆï¼šèµµå…­ | Redisæ ¸å¿ƒè´¡çŒ®è€…</p>
                                    <p class="course-description">æ·±å…¥Rediså†…æ ¸ï¼ŒæŒæ¡é«˜æ€§èƒ½ç¼“å­˜åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åº”ç”¨ã€‚</p>
                                    <div class="course-meta">
                                        <div class="course-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <span class="rating-text">4.6 (892äºº)</span>
                                        </div>
                                        <div class="course-level">
                                            <span class="level-badge advanced">é«˜çº§</span>
                                        </div>
                                    </div>
                                    <div class="course-price">
                                        <span class="current-price">ï¿¥259</span>
                                        <span class="original-price">ï¿¥499</span>
                                        <span class="discount">5.2æŠ˜</span>
                                    </div>
                                    <div class="course-actions">
                                        <button class="course-btn primary">
                                            <i class="fas fa-play"></i>
                                            ç«‹å³å­¦ä¹ 
                                        </button>
                                        <button class="course-btn secondary">
                                            <i class="fas fa-heart"></i>
                                            æ”¶è—
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- å³ä¾§AIåŠ©æ‰‹ -->
            <aside class="ai-assistant">
                <div class="assistant-header">
                    <h3 class="assistant-title">
                        <i class="fas fa-robot"></i>
                        AI æ™ºèƒ½åŠ©æ‰‹
                    </h3>
                    <div class="assistant-actions">
                        <button class="assistant-btn" id="clearChatBtn" title="æ¸…ç©ºèŠå¤©">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="assistant-btn" id="downloadChatBtn" title="ä¸‹è½½èŠå¤©è®°å½•">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="assistant-btn" id="minimizeAssistantBtn" title="ç¼©å°é¢æ¿">
                            <i class="fas fa-compress"></i>
                        </button>
                    </div>
                </div>
                
                <div class="assistant-content">
                    <div class="chat-messages" id="chatMessages">
                        <!-- èŠå¤©æ¶ˆæ¯å°†åŠ¨æ€ç”Ÿæˆ -->
                        <div class="welcome-message">
                            <div class="assistant-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3 class="welcome-title">æ‚¨å¥½ï¼æˆ‘æ˜¯AIå­¦ä¹ åŠ©æ‰‹</h3>
                            <p class="welcome-text">æˆ‘å¯ä»¥å›ç­”æ‚¨å…³äºèŒä¸šå‘å±•ã€æŠ€èƒ½æå‡çš„é—®é¢˜ã€‚è¯·åœ¨ä¸‹æ–¹è¾“å…¥æ‚¨çš„é—®é¢˜ï¼</p>
                        </div>
                    </div>
                    
                    <div class="chat-input-container">
                        <textarea class="chat-input" id="chatInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."></textarea>
                        <button class="send-btn" id="sendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- é¡µé¢è„šæœ¬ -->
    <script>
        
        document.addEventListener('DOMContentLoaded', function() {
            // å¼ºåˆ¶ä¿®å¤å¸ƒå±€é—®é¢˜
            console.log('\ud83d\udee0 æ­£åœ¨ä¿®å¤å¸ƒå±€é—®é¢˜...');
            
            // ç¡®ä¿å†…å®¹åŒºåŸŸåœ¨æ­£ç¡®çš„ä½ç½®
            const contentMain = document.querySelector('.content-main');
            const contentSections = document.querySelectorAll('.content-section');
            
            if (contentMain && contentSections) {
                // ç¡®ä¿æ‰€æœ‰å†…å®¹åŒºåŸŸéƒ½æœ‰æ­£ç¡®çš„çˆ¶å…ƒç´ 
                contentSections.forEach(section => {
                    // ä»…å½“çˆ¶å…ƒç´ ä¸æ˜¯å†…å®¹åŒºåŸŸæ—¶æ‰ç§»åŠ¨
                    if (section.parentElement !== contentMain) {
                        console.log(`\ud83d\udd04 ç§»åŠ¨å†…å®¹åŒºåŸŸåˆ°æ­£ç¡®ä½ç½®: ${section.id}`);
                        contentMain.appendChild(section);
                    }
                });
                
                console.log('\u2705 å¸ƒå±€é—®é¢˜ä¿®å¤å®Œæˆ');
            }
            
            const jobTitleDisplay = document.getElementById('jobTitleDisplay');
            const sidebarJobTitle = document.getElementById('sidebarJobTitle');
            const generationTimeDisplay = document.getElementById('generationTimeDisplay');
            const navItems = document.querySelectorAll('.nav-item');
            const chatInput = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');
            
            // åˆå§‹åŒ–å†…å®¹åŒºåŸŸ
            console.log('ğŸ”” åˆå§‹åŒ–é¡µé¢å†…å®¹');
            const urlSection = new URLSearchParams(window.location.search).get('section');
            let activeSection = urlSection || 'interview';
            
            // æ¿€æ´»å¯¼èˆªé¡¹
            navItems.forEach(nav => {
                nav.classList.remove('active');
                if (nav.getAttribute('data-target') === activeSection) {
                    nav.classList.add('active');
                }
            });
            
            // æ¿€æ´»å†…å®¹åŒºåŸŸ
            contentSections.forEach(section => {
                section.classList.remove('active');
                if (section.id === `${activeSection}Section`) {
                    section.classList.add('active');
                    console.log('âœ… æ¿€æ´»åŒºåŸŸ:', section.id);
                }
            });
            
            // åˆå§‹åŒ–AIåŠ©æ‰‹çŠ¶æ€
            initializeAIAssistantState(activeSection);
            
            // åˆå§‹åŒ–å˜é‡
            const currentApiKey = localStorage.getItem('ai_learning_companion_api_key') || '';
            
            // æ›´æ–°é…ç½®APIæŒ‰é’®çŠ¶æ€
            const configApiBtn = document.getElementById('configApiBtn');
            if(configApiBtn && currentApiKey) {
                configApiBtn.innerHTML = '<i class="fas fa-check-circle"></i> å·²é…ç½®API';
                configApiBtn.style.color = '#10b981';
                configApiBtn.style.borderColor = '#10b981';
            }
            
            // ç»‘å®šæ¨¡æ€æ¡†äº‹ä»¶
            setTimeout(function() {
                // ç»‘å®šå…³é—­æŒ‰é’®äº‹ä»¶
                const apiConfigClose = document.getElementById('apiConfigClose');
                const apiConfigCancel = document.getElementById('apiConfigCancel');
                const apiConfigModal = document.getElementById('apiConfigModal');
                const modalOverlay = apiConfigModal ? apiConfigModal.querySelector('.modal-overlay') : null;
                
                if (apiConfigClose) {
                    apiConfigClose.addEventListener('click', closeApiConfigModal);
                }
                
                if (apiConfigCancel) {
                    apiConfigCancel.addEventListener('click', closeApiConfigModal);
                }
                
                if (modalOverlay) {
                    modalOverlay.addEventListener('click', closeApiConfigModal);
                }
                
                // åˆ‡æ¢API Keyæ˜¾ç¤º/éšè—
                const toggleApiKey = document.getElementById('toggleApiKey');
                const apiKeyInput = document.getElementById('apiKey');
                
                if (toggleApiKey && apiKeyInput) {
                    toggleApiKey.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('ğŸ‘ï¸ åˆ‡æ¢å¯†é’¥æ˜¾ç¤º/éšè—');
                        
                        if (apiKeyInput.type === 'password') {
                            apiKeyInput.type = 'text';
                            toggleApiKey.innerHTML = '<i class="fas fa-eye-slash"></i>';
                            console.log('âœ… å¯†é’¥å·²æ˜¾ç¤º');
                        } else {
                            apiKeyInput.type = 'password';
                            toggleApiKey.innerHTML = '<i class="fas fa-eye"></i>';
                            console.log('âœ… å¯†é’¥å·²éšè—');
                        }
                    });
                }
                
                // å¤„ç†å‚å•†åˆ‡æ¢
                const apiProviderSelect = document.getElementById('apiProvider');
                if (apiProviderSelect) {
                    // åˆå§‹åŒ–æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„å‚å•†ä¿¡æ¯
                    updateProviderInfo(apiProviderSelect.value);
                    
                    apiProviderSelect.addEventListener('change', function() {
                        console.log('ğŸ”„ å‚å•†åˆ‡æ¢ä¸º:', this.value);
                        updateProviderInfo(this.value);
                    });
                }
                
                // æ›´æ–°å‚å•†ä¿¡æ¯æ˜¾ç¤º
                function updateProviderInfo(provider) {
                    const providerInfo = document.querySelector('.provider-info');
                    if (!providerInfo) return;
                    
                    const logo = providerInfo.querySelector('.provider-logo i');
                    const title = providerInfo.querySelector('.provider-details h4');
                    const description = providerInfo.querySelector('.provider-details p');
                    const link = providerInfo.querySelector('.provider-link');
                    
                    switch(provider) {
                        case 'alibaba':
                            if (logo) {
                                logo.className = 'fas fa-cloud';
                                logo.style.color = '#ff6a00';
                            }
                            if (title) title.textContent = 'é˜¿é‡Œäº‘ DashScope';
                            if (description) description.textContent = 'ä½¿ç”¨é€šä¹‰å¤§æ¨¡å‹ç³»åˆ—ï¼ŒåŒ…æ‹¬æ¨¡å‹é€šä¹‰åƒé—®2.0ç­‰';
                            if (link) {
                                link.href = 'https://dashscope.aliyun.com/';
                                link.textContent = 'è·å–å¯†é’¥';
                            }
                            break;
                        case 'openai':
                            if (logo) {
                                logo.className = 'fas fa-brain';
                                logo.style.color = '#10a37f';
                            }
                            if (title) title.textContent = 'OpenAI';
                            if (description) description.textContent = 'ä½¿ç”¨GPT-4ã€GPT-3.5ç­‰å…ˆè¿›çš„è¯­è¨€æ¨¡å‹';
                            if (link) {
                                link.href = 'https://platform.openai.com/api-keys';
                                link.textContent = 'è·å–å¯†é’¥';
                            }
                            break;
                        case 'anthropic':
                            if (logo) {
                                logo.className = 'fas fa-robot';
                                logo.style.color = '#d97700';
                            }
                            if (title) title.textContent = 'Anthropic Claude';
                            if (description) description.textContent = 'ä½¿ç”¨Claude 3.5 Sonnetç­‰å…ˆè¿›çš„AIæ¨¡å‹';
                            if (link) {
                                link.href = 'https://console.anthropic.com/';
                                link.textContent = 'è·å–å¯†é’¥';
                            }
                            break;
                    }
                }
                
                // ä¿å­˜APIé…ç½®
                const apiConfigConfirm = document.getElementById('apiConfigConfirm');
                // å¤ç”¨ä¹‹å‰å£°æ˜çš„ apiProviderSelect
                
                if (apiConfigConfirm) {
                    apiConfigConfirm.addEventListener('click', function() {
                        const apiKey = apiKeyInput ? apiKeyInput.value.trim() : '';
                        const apiProvider = apiProviderSelect ? apiProviderSelect.value : 'alibaba';
                        
                        if (!apiKey) {
                            alert('è¯·è¾“å…¥APIå¯†é’¥');
                            return;
                        }
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('ai_learning_companion_api_key', apiKey);
                        localStorage.setItem('apiProvider', apiProvider);
                        
                        // æ›´æ–°æŒ‰é’®çŠ¶æ€
                        const configApiBtn = document.getElementById('configApiBtn');
                        if (configApiBtn) {
                            configApiBtn.innerHTML = '<i class="fas fa-check-circle"></i> å·²é…ç½®API';
                            configApiBtn.style.color = '#10b981';
                            configApiBtn.style.borderColor = '#10b981';
                        }
                        
                        // å…³é—­æ¨¡æ€æ¡†
                        closeApiConfigModal();
                        
                        alert('APIé…ç½®å·²ä¿å­˜');
                    });
                }
            }, 100);
            
            // è·å–URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const jobTitle = urlParams.get('job') || localStorage.getItem('currentJob') || 'åç«¯å·¥ç¨‹å¸ˆ';
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.title = `${jobTitle} å­¦ä¹ èµ„æ–™ - èŒé€”åŠ©æ‰‹AIæ±‚èŒå¤§å¸ˆ`;
            
            // æ›´æ–°èŒä½æ ‡é¢˜
            if (jobTitleDisplay) jobTitleDisplay.textContent = jobTitle;
            if (sidebarJobTitle) sidebarJobTitle.textContent = jobTitle;
            
            // æ›´æ–°ç”Ÿæˆæ—¶é—´
            if (generationTimeDisplay) {
                const now = new Date();
                generationTimeDisplay.textContent = `${now.getFullYear()}/${(now.getMonth() + 1).toString().padStart(2, '0')}/${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            }
            
            // å¤„ç†å¯¼èˆªé¡¹ç‚¹å‡»
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    
                    const targetId = this.getAttribute('data-target');
                    console.log('ğŸ“Š ç‚¹å‡»å¯¼èˆªé¡¹:', targetId);
                    
                    if (!targetId) {
                        console.error('âš ï¸ å¯¼èˆªé¡¹ç¼ºå°‘data-targetå±æ€§');
                        return;
                    }
                    
                    // æ›´æ–°å¯¼èˆªé¡¹çŠ¶æ€
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    // æ›´æ–°å†…å®¹åŒºåŸŸæ˜¾ç¤º
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                        const expectedId = `${targetId}Section`;
                        console.log('ğŸ” æ£€æŸ¥åŒºåŸŸ:', section.id, 'æœŸæœ›:', expectedId);
                        if (section.id === expectedId) {
                            section.classList.add('active');
                            console.log('âœ… æ¿€æ´»åŒºåŸŸ:', section.id);
                        }
                    });
                    
                    // æ™ºèƒ½æ§åˆ¶AIåŠ©æ‰‹çŠ¶æ€
                    controlAIAssistantForSection(targetId);
                });
            });
            
            // å¤„ç†å¯¼å‡ºPDFæŒ‰é’®
            const exportPdfBtn = document.getElementById('exportPdfBtn');
            if (exportPdfBtn) {
                exportPdfBtn.addEventListener('click', function() {
                    alert('å¯¼å‡ºPDFåŠŸèƒ½å°†åœ¨å®Œæ•´ç‰ˆä¸­æä¾›');
                });
            }
            
            // å¤„ç†å¯¼å‡ºé£ä¹¦æŒ‰é’®
            const exportFeishuBtn = document.getElementById('exportFeishuBtn');
            if (exportFeishuBtn) {
                exportFeishuBtn.addEventListener('click', function() {
                    alert('å¯¼å‡ºé£ä¹¦æ–‡æ¡£åŠŸèƒ½å°†åœ¨å®Œæ•´ç‰ˆä¸­æä¾›');
                });
            }
            
            // å¤„ç†ä¿å­˜æŒ‰é’®
            const saveBtn = document.getElementById('saveBtn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    alert('å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨');
                });
            }
            
            // å¤„ç†æ€ç»´å¯¼å›¾åˆ‡æ¢
            const mindmapToggleBtn = document.getElementById('mindmapToggleBtn');
            if (mindmapToggleBtn) {
                mindmapToggleBtn.addEventListener('click', function(e) {
                    e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    
                    console.log('ğŸ“Š ç‚¹å‡»æ€ç»´å¯¼å›¾åˆ‡æ¢æŒ‰é’®');
                    
                    navItems.forEach(nav => nav.classList.remove('active'));
                    document.querySelector('.nav-item[data-target="mindmap"]').classList.add('active');
                    
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === 'mindmapSection') {
                            section.classList.add('active');
                            console.log('âœ… æ¿€æ´»æ€ç»´å¯¼å›¾åŒºåŸŸ');
                        }
                    });
                    
                    // æ™ºèƒ½æ§åˆ¶AIåŠ©æ‰‹çŠ¶æ€
                    controlAIAssistantForSection('mindmap');
                });
            }
            
            // å¤„ç†é¢è¯•é¢˜å±•å¼€
            const expandAllInterviewBtn = document.getElementById('expandAllInterview');
            if (expandAllInterviewBtn) {
                expandAllInterviewBtn.addEventListener('click', function() {
                    alert('å±•å¼€æ‰€æœ‰é¢è¯•é¢˜åŠŸèƒ½å°†åœ¨å®Œæ•´ç‰ˆä¸­æä¾›');
                });
            }
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨çš„å‡½æ•°
            function scrollChatToBottom() {
                const chatMessages = document.getElementById('chatMessages');
                if (chatMessages) {
                    // ä½¿ç”¨requestAnimationFrameç¡®ä¿åœ¨DOMæ›´æ–°åæ‰§è¡Œ
                    requestAnimationFrame(() => {
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    });
                }
            }
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            function addUserMessage(message) {
                const chatMessages = document.getElementById('chatMessages');
                if (!chatMessages) return;
                
                // ç§»é™¤æ¬¢è¿æ¶ˆæ¯
                const welcomeMessage = chatMessages.querySelector('.welcome-message');
                if (welcomeMessage) {
                    welcomeMessage.remove();
                }
                
                const messageElement = document.createElement('div');
                messageElement.className = 'message user-message';
                messageElement.innerHTML = `
                    <div class="message-content">
                        <p>${message}</p>
                    </div>
                `;
                
                chatMessages.appendChild(messageElement);
                scrollChatToBottom(); // ä½¿ç”¨æ–°çš„æ»šåŠ¨å‡½æ•°
            }
            
            // æ·»åŠ åŠ©æ‰‹æ¶ˆæ¯
            function addAssistantMessage(message) {
                const chatMessages = document.getElementById('chatMessages');
                if (!chatMessages) return;
                
                const messageElement = document.createElement('div');
                messageElement.className = 'message assistant-message';
                messageElement.innerHTML = `
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>${message}</p>
                    </div>
                `;
                
                chatMessages.appendChild(messageElement);
                scrollChatToBottom(); // ä½¿ç”¨æ–°çš„æ»šåŠ¨å‡½æ•°
            }
            
            // æ·»åŠ æµå¼åŠ©æ‰‹æ¶ˆæ¯å®¹å™¨
            function addAssistantMessageStreaming() {
                const chatMessages = document.getElementById('chatMessages');
                if (!chatMessages) return null;
                
                // ç§»é™¤æ¬¢è¿æ¶ˆæ¯
                const welcomeMessage = chatMessages.querySelector('.welcome-message');
                if (welcomeMessage) {
                    welcomeMessage.remove();
                }
                
                const messageElement = document.createElement('div');
                messageElement.className = 'message assistant-message';
                messageElement.innerHTML = `
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content streaming">
                        <p>ğŸ¤” æ­£åœ¨æ€è€ƒä¸­...</p>
                    </div>
                `;
                
                chatMessages.appendChild(messageElement);
                scrollChatToBottom(); // ä½¿ç”¨æ–°çš„æ»šåŠ¨å‡½æ•°
                
                return messageElement.querySelector('.message-content');
            }
            
            // æ›´æ–°æµå¼æ¶ˆæ¯å†…å®¹
            function updateStreamingMessage(contentElement, content) {
                if (contentElement) {
                    contentElement.innerHTML = `<p>${content}</p>`;
                    scrollChatToBottom(); // æ¯æ¬¡æ›´æ–°éƒ½æ»šåŠ¨åˆ°åº•éƒ¨
                }
            }
            
            // è·å–å­˜å‚¨çš„APIå¯†é’¥
            function getStoredApiKey() {
                return localStorage.getItem('ai_learning_companion_api_key') || '';
            }
            
            // è°ƒç”¨æµå¼DashScope API
            async function callDashScopeAPIStream(message, onContent) {
                console.log('ğŸš€ è°ƒç”¨æµå¼ç™¾ç‚¼ API...');
                
                // è·å–APIå¯†é’¥
                const apiKey = getStoredApiKey();
                if (!apiKey) {
                    throw new Error('è¯·å…ˆé…ç½®APIå¯†é’¥');
                }
                
                // æ„å»ºå¯¹è¯å†å²ï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥ä»localStorageè·å–å†å²è®°å½•ï¼‰
                const messages = [
                    {
                        role: 'system',
                        content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„èŒä¸šå‘å±•é¡¾é—®ï¼Œæ“…é•¿æä¾›æŠ€èƒ½å­¦ä¹ ã€èŒä¸šè§„åˆ’ã€é¢è¯•æŒ‡å¯¼ç­‰å»ºè®®ã€‚è¯·ç”¨ä¸­æ–‡å›ç­”ï¼Œè¯­è¨€å‹å¥½ã€ä¸“ä¸šã€‚'
                    },
                    {
                        role: 'user',
                        content: message
                    }
                ];
                
                // ä½¿ç”¨æµå¼èŠå¤©æ¥å£
                return new Promise((resolve, reject) => {
                    // å‘é€POSTè¯·æ±‚æ•°æ®
                    fetch('/api/chat-stream-init', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            messages: messages,
                            apiKey: apiKey
                        })
                    }).then(response => {
                        if (!response.ok) {
                            throw new Error(`åˆå§‹åŒ–æµå¼APIå¤±è´¥: ${response.status}`);
                        }
                        return response.json();
                    }).then(data => {
                        const sessionId = data.sessionId;
                        
                        // ä½¿ç”¨EventSourceå¤„ç†SSE
                        const eventSource = new EventSource(`/api/chat-stream/${sessionId}`);
                        
                        console.log('ğŸŒŠ å»ºç«‹SSEè¿æ¥:', sessionId);
                        
                        let hasReceivedFirstMessage = false;
                        let connectionStartTime = Date.now();
                        let streamContent = '';
                        
                        // è®¾ç½®è¿æ¥è¶…æ—¶æ£€æŸ¥
                        const connectionTimeout = setTimeout(() => {
                            if (!hasReceivedFirstMessage) {
                                onContent('â³ AIæ­£åœ¨æ€è€ƒä¸­ï¼Œè¯·ç¨ç­‰...');
                            }
                        }, 2000); // 2ç§’åæ˜¾ç¤ºæ€è€ƒä¸­
                        
                        eventSource.onopen = () => {
                            console.log('âœ… EventSourceè¿æ¥å·²å»ºç«‹');
                        };
                        
                        eventSource.addEventListener('message', (event) => {
                            try {
                                console.log('ğŸ“¨ æ”¶åˆ°messageäº‹ä»¶:', event.data);
                                const data = JSON.parse(event.data);
                                
                                if (data.content) {
                                    if (!hasReceivedFirstMessage) {
                                        hasReceivedFirstMessage = true;
                                        clearTimeout(connectionTimeout);
                                        streamContent = '';
                                        console.log('ğŸ† å¼€å§‹æ¥æ”¶æµå¼å†…å®¹');
                                    }
                                    
                                    console.log('ğŸ’¬ æµå¼æ¶ˆæ¯:', data.content);
                                    streamContent += data.content;
                                    onContent(streamContent);
                                }
                            } catch (parseError) {
                                console.warn('âš ï¸ è§£æmessageäº‹ä»¶å¤±è´¥:', parseError.message);
                            }
                        });
                        
                        eventSource.addEventListener('done', (event) => {
                            console.log('âœ… æµå¼å¯¹è¯å®Œæˆ:', event.data);
                            clearTimeout(connectionTimeout);
                            eventSource.close();
                            resolve();
                        });
                        
                        eventSource.addEventListener('error', (event) => {
                            try {
                                const data = JSON.parse(event.data);
                                console.error('âŒ æµå¼é”™è¯¯:', data.error);
                                clearTimeout(connectionTimeout);
                                eventSource.close();
                                reject(new Error(data.error));
                            } catch (e) {
                                console.error('âŒ æµå¼é”™è¯¯äº‹ä»¶:', event);
                                clearTimeout(connectionTimeout);
                                eventSource.close();
                                reject(new Error('æµå¼è¿æ¥é”™è¯¯'));
                            }
                        });
                        
                        eventSource.onerror = (error) => {
                            console.error('âŒ EventSourceè¿æ¥é”™è¯¯:', error);
                            clearTimeout(connectionTimeout);
                            eventSource.close();
                            reject(new Error('EventSourceè¿æ¥å¤±è´¥'));
                        };
                        
                    }).catch(error => {
                        console.error('âŒ åˆå§‹åŒ–æµå¼APIå¤±è´¥:', error);
                        reject(error);
                    });
                });
            }
            
            // å¤„ç†AIåŠ©æ‰‹å‘é€æŒ‰é’®
            if (sendBtn && chatInput) {
                sendBtn.addEventListener('click', async function() {
                    const message = chatInput.value.trim();
                    if (message) {
                        console.log('ğŸ“ å‘é€æ¶ˆæ¯:', message);
                        
                        // ç«‹å³æ¸…ç©ºè¾“å…¥æ¡†å¹¶ç¦ç”¨
                        chatInput.value = '';
                        // ç§»é™¤blur()ï¼Œä¿æŒç„¦ç‚¹åœ¨è¾“å…¥æ¡†ä»¥ä¾¿è¿ç»­è¾“å…¥
                        sendBtn.disabled = true; // ç¦ç”¨å‘é€æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
                        console.log('âœ… è¾“å…¥æ¡†å·²æ¸…ç©º');
                        
                        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
                        addUserMessage(message);
                        
                        // åˆ›å»ºæµå¼æ¶ˆæ¯å®¹å™¨
                        const aiMessageContent = addAssistantMessageStreaming();
                        
                        try {
                            // è°ƒç”¨æµå¼API
                            await callDashScopeAPIStream(message, (content) => {
                                updateStreamingMessage(aiMessageContent, content);
                            });
                            
                            // ç§»é™¤streamingç±»
                            if (aiMessageContent) {
                                aiMessageContent.classList.remove('streaming');
                            }
                        } catch (error) {
                            console.error('âŒ èŠå¤©APIè°ƒç”¨å¤±è´¥:', error);
                            if (aiMessageContent) {
                                aiMessageContent.innerHTML = '<p>âš ï¸ æŠ±æ­‰ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚è¯·æ£€æŸ¥APIé…ç½®æˆ–ç¨åå†è¯•ã€‚</p>';
                                aiMessageContent.classList.remove('streaming');
                            }
                        } finally {
                            // æ¢å¤å‘é€æŒ‰é’®çŠ¶æ€
                            sendBtn.disabled = false;
                            // å†æ¬¡ç¡®ä¿è¾“å…¥æ¡†ä¸ºç©ºï¼Œä½†ä¿æŒç„¦ç‚¹
                            setTimeout(() => {
                                chatInput.value = '';
                                chatInput.focus(); // é‡æ–°èšç„¦åˆ°è¾“å…¥æ¡†
                            }, 100);
                        }
                    }
                });
                
                chatInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        // ç¡®ä¿è¾“å…¥æ¡†æœ‰å†…å®¹æ‰è§¦å‘å‘é€
                        if (chatInput.value.trim() && !sendBtn.disabled) {
                            sendBtn.click();
                        }
                    }
                });
            }
            
            // AIåŠ©æ‰‹å¤´éƒ¨æŒ‰é’®åŠŸèƒ½
            const clearChatBtn = document.getElementById('clearChatBtn');
            const downloadChatBtn = document.getElementById('downloadChatBtn');
            const minimizeAssistantBtn = document.getElementById('minimizeAssistantBtn');
            
            // æ¸…ç©ºèŠå¤©åŠŸèƒ½
            if (clearChatBtn) {
                clearChatBtn.addEventListener('click', function() {
                    const chatMessages = document.getElementById('chatMessages');
                    if (chatMessages) {
                        // é‡ç½®ä¸ºæ¬¢è¿æ¶ˆæ¯
                        chatMessages.innerHTML = `
                            <div class="welcome-message">
                                <div class="assistant-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <h3 class="welcome-title">æ‚¨å¥½ï¼æˆ‘æ˜¯AIå­¦ä¹ åŠ©æ‰‹</h3>
                                <p class="welcome-text">æˆ‘å¯ä»¥å›ç­”æ‚¨å…³äºèŒä¸šå‘å±•ã€æŠ€èƒ½æå‡çš„é—®é¢˜ã€‚è¯·åœ¨ä¸‹æ–¹è¾“å…¥æ‚¨çš„é—®é¢˜ï¼</p>
                            </div>
                        `;
                        console.log('ğŸ§½ èŠå¤©è®°å½•å·²æ¸…ç©º');
                    }
                });
            }
            
            // ä¸‹è½½èŠå¤©è®°å½•åŠŸèƒ½
            if (downloadChatBtn) {
                downloadChatBtn.addEventListener('click', function() {
                    const chatMessages = document.getElementById('chatMessages');
                    if (!chatMessages) {
                        alert('æ²¡æœ‰èŠå¤©è®°å½•å¯ä¸‹è½½');
                        return;
                    }
                    
                    const messages = chatMessages.querySelectorAll('.user-message, .assistant-message');
                    let chatContent = 'èŠå¤©è®°å½• - ' + new Date().toLocaleString() + '\n\n';
                    
                    messages.forEach(message => {
                        if (message.classList.contains('user-message')) {
                            const content = message.querySelector('p');
                            if (content) {
                                chatContent += 'ç”¨æˆ·ï¼š ' + content.textContent + '\n\n';
                            }
                        } else if (message.classList.contains('assistant-message')) {
                            const content = message.querySelector('.message-content');
                            if (content) {
                                chatContent += 'AIåŠ©æ‰‹ï¼š ' + content.textContent + '\n\n';
                            }
                        }
                    });
                    
                    if (messages.length === 0) {
                        alert('æ²¡æœ‰èŠå¤©è®°å½•å¯ä¸‹è½½');
                        return;
                    }
                    
                    // åˆ›å»ºä¸‹è½½æ–‡ä»¶
                    const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                    const filename = `AIåŠ©æ‰‹èŠå¤©è®°å½•_${timestamp}.txt`;
                    
                    const blob = new Blob([chatContent], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    console.log('ğŸ’¾ èŠå¤©è®°å½•å·²ä¸‹è½½:', filename);
                });
            }
            
            // ç¼©å°/æ‰©å¤§AIåŠ©æ‰‹é¢æ¿åŠŸèƒ½
            if (minimizeAssistantBtn) {
                minimizeAssistantBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    toggleAssistantSize();
                });
            }
            
            // ç¼©å°åçš„ç‚¹å‡»äº‹ä»¶
            const aiAssistant = document.querySelector('.ai-assistant');
            if (aiAssistant) {
                aiAssistant.addEventListener('click', function(e) {
                    // åªæœ‰åœ¨ç¼©å°çŠ¶æ€ä¸‹æ‰å“åº”ç‚¹å‡»
                    if (this.classList.contains('minimized')) {
                        e.stopPropagation();
                        e.preventDefault();
                        toggleAssistantSize();
                    }
                });
            }
            

            
            // æ™ºèƒ½æ§åˆ¶AIåŠ©æ‰‹çŠ¶æ€çš„å‡½æ•°
            function controlAIAssistantForSection(sectionType) {
                const aiAssistant = document.querySelector('.ai-assistant');
                const minimizeBtn = document.getElementById('minimizeAssistantBtn');
                const icon = minimizeBtn ? minimizeBtn.querySelector('i') : null;
                
                if (!aiAssistant) return;
                
                console.log('ğŸ¤– æ ¹æ®é¡µé¢ç±»å‹æ§åˆ¶AIåŠ©æ‰‹:', sectionType);
                
                if (sectionType === 'mindmap') {
                    // æ€ç»´å¯¼å›¾é¡µé¢ï¼šè‡ªåŠ¨ç¼©å°
                    if (!aiAssistant.classList.contains('minimized')) {
                        aiAssistant.classList.add('minimized');
                        if (icon) {
                            icon.className = 'fas fa-expand';
                        }
                        if (minimizeBtn) {
                            minimizeBtn.title = 'æ‰©å¤§é¢æ¿';
                        }
                        console.log('ğŸ” AIåŠ©æ‰‹è‡ªåŠ¨ç¼©å°ï¼ˆæ€ç»´å¯¼å›¾æ¨¡å¼ï¼‰');
                    }
                    
                    // è§¦å‘æ€ç»´å¯¼å›¾çš„è‡ªåŠ¨é€‚é…ï¼Œç¡®ä¿å†…å®¹å¯è§
                    setTimeout(() => {
                        const mindmapContent = document.getElementById('mindmapContent');
                        const svg = mindmapContent ? mindmapContent.querySelector('svg') : null;
                        if (svg) {
                            console.log('ğŸ“Š æ€ç»´å¯¼å›¾é¡µé¢æ¿€æ´»ï¼Œè§¦å‘è‡ªåŠ¨é€‚é…');
                            // å°è¯•ä½¿ç”¨å…¨å±€å˜é‡ä¸­çš„markmapå®ä¾‹
                            if (window.currentMarkmapInstance && typeof window.currentMarkmapInstance.fit === 'function') {
                                try {
                                    window.currentMarkmapInstance.fit();
                                    console.log('âœ… é€šè¿‡å…¨å±€å®ä¾‹é€‚é…æˆåŠŸ');
                                } catch (e) {
                                    console.warn('âš ï¸ å…¨å±€å®ä¾‹é€‚é…å¤±è´¥:', e);
                                }
                            }
                        }
                    }, 300);
                } else {
                    // å…¶ä»–é¡µé¢ï¼šè‡ªåŠ¨å±•å¼€
                    if (aiAssistant.classList.contains('minimized')) {
                        aiAssistant.classList.remove('minimized');
                        if (icon) {
                            icon.className = 'fas fa-compress';
                        }
                        if (minimizeBtn) {
                            minimizeBtn.title = 'ç¼©å°é¢æ¿';
                        }
                        console.log('ğŸ” AIåŠ©æ‰‹è‡ªåŠ¨å±•å¼€ï¼ˆéæ€ç»´å¯¼å›¾æ¨¡å¼ï¼‰');
                    }
                }
            }
            
            // åˆå§‹åŒ–AIåŠ©æ‰‹çŠ¶æ€çš„å‡½æ•°
            function initializeAIAssistantState(activeSection) {
                console.log('ğŸš€ åˆå§‹åŒ–AIåŠ©æ‰‹çŠ¶æ€:', activeSection);
                // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå®Œå…¨åŠ è½½
                setTimeout(() => {
                    controlAIAssistantForSection(activeSection);
                }, 500);
            }
            
            // åˆ‡æ¢AIåŠ©æ‰‹å¤§å°çš„å‡½æ•°
            function toggleAssistantSize() {
                const aiAssistant = document.querySelector('.ai-assistant');
                const minimizeBtn = document.getElementById('minimizeAssistantBtn');
                const icon = minimizeBtn ? minimizeBtn.querySelector('i') : null;
                
                if (aiAssistant) {
                    if (aiAssistant.classList.contains('minimized')) {
                        // æ‰©å¤§
                        aiAssistant.classList.remove('minimized');
                        if (icon) {
                            icon.className = 'fas fa-compress';
                        }
                        if (minimizeBtn) {
                            minimizeBtn.title = 'ç¼©å°é¢æ¿';
                        }
                        console.log('ğŸ” AIåŠ©æ‰‹é¢æ¿å·²æ‰©å¤§');
                    } else {
                        // ç¼©å°
                        aiAssistant.classList.add('minimized');
                        if (icon) {
                            icon.className = 'fas fa-expand';
                        }
                        if (minimizeBtn) {
                            minimizeBtn.title = 'æ‰©å¤§é¢æ¿';
                        }
                        console.log('ğŸ” AIåŠ©æ‰‹é¢æ¿å·²ç¼©å°');
                    }
                }
            }
            
            // åˆå§‹åŒ–é¢è¯•é¢˜ç¬”è®°åŠŸèƒ½
            function initInterviewNotes() {
                console.log('ğŸ““ åˆå§‹åŒ–é¢è¯•é¢˜ç¬”è®°åŠŸèƒ½...');
                
                // è·å–æ‰€æœ‰ç¬”è®°è¾“å…¥æ¡†
                const notesInputs = document.querySelectorAll('.interview-notes-input');
                
                // ä¸ºæ¯ä¸ªè¾“å…¥æ¡†æ·»åŠ äº‹ä»¶å¤„ç†
                notesInputs.forEach((input, index) => {
                    // è·å–é¢è¯•é¢˜æ ‡é¢˜
                    const interviewCard = input.closest('.interview-card');
                    if (!interviewCard) return;
                    
                    const titleElement = interviewCard.querySelector('.interview-question');
                    if (!titleElement) return;
                    
                    const interviewTitle = titleElement.textContent;
                    const noteKey = `interview_note_${interviewTitle}`;
                    
                    // è®¾ç½®æ ‡è¯†ä»¥ä¾¿åŒºåˆ†
                    input.setAttribute('data-note-key', noteKey);
                    
                    // ä»localStorageåŠ è½½å·²ä¿å­˜çš„ç¬”è®°
                    const savedNotes = JSON.parse(localStorage.getItem('interviewNotes') || '{}');
                    if (savedNotes[noteKey]) {
                        input.value = savedNotes[noteKey];
                    }
                    
                    // ç›‘å¬è¾“å…¥äº‹ä»¶ï¼Œè‡ªåŠ¨ä¿å­˜
                    input.addEventListener('input', function() {
                        const notes = JSON.parse(localStorage.getItem('interviewNotes') || '{}');
                        notes[noteKey] = this.value;
                        localStorage.setItem('interviewNotes', JSON.stringify(notes));
                        console.log(`âœ… å·²ä¿å­˜é¢è¯•é¢˜ç¬”è®°: ${noteKey}`);
                        
                        // å¦‚æœæœ‰å†…å®¹ï¼Œè‡ªåŠ¨æ›´æ–°æ”¶è—æŒ‰é’®çŠ¶æ€
                        const noteBtn = interviewCard.querySelector('.interview-btn.outline');
                        if (noteBtn) {
                            if (this.value.trim() !== '') {
                                if (!noteBtn.classList.contains('bookmarked')) {
                                    noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                                    noteBtn.style.backgroundColor = '#f59e0b';
                                    noteBtn.style.color = 'white';
                                    noteBtn.style.borderColor = '#f59e0b';
                                    noteBtn.classList.add('bookmarked');
                                }
                            } else {
                                // å¦‚æœæ²¡æœ‰å†…å®¹ï¼Œåˆ™æ¢å¤æ”¶è—æŒ‰é’®çŠ¶æ€
                                if (noteBtn.classList.contains('bookmarked')) {
                                    noteBtn.innerHTML = '<i class="fas fa-arrow-right"></i> è®°ä¸€ä¸‹';
                                    noteBtn.style.backgroundColor = '';
                                    noteBtn.style.color = '#4f46e5';
                                    noteBtn.style.borderColor = '#4f46e5';
                                    noteBtn.classList.remove('bookmarked');
                                }
                            }
                        }
                    });
                });
                
                console.log(`âœ… é¢è¯•é¢˜ç¬”è®°åŠŸèƒ½åˆå§‹åŒ–å®Œæˆï¼Œå…±${notesInputs.length}ä¸ªé¢è¯•é¢˜`);
            }
            
            // å¤„ç†é¢è¯•é¢˜äº¤äº’
            function initInterviewQuestions() {
                // è·å–é¢è¯•é¢˜å…ƒç´ 
                const interviewListItems = document.querySelectorAll('.interview-list-item');
                const refreshQuestionBtn = document.getElementById('refreshQuestion');
                const interviewAnswerInput = document.querySelector('.interview-answer-input');
                const checkAnswerBtn = document.querySelector('.interview-btn.secondary');
                const learnedBtn = document.querySelector('.interview-btn.primary');
                const noteBtn = document.querySelector('.interview-btn.outline');
                
                // åˆ‡æ¢é¢è¯•é¢˜
                if (interviewListItems) {
                    interviewListItems.forEach(item => {
                        item.addEventListener('click', function() {
                            // è·å–é¢˜ç›®æ ‡é¢˜å’Œæ ‡ç­¾
                            const title = this.querySelector('.interview-list-title').textContent;
                            const tags = this.querySelectorAll('.interview-tag');
                            const number = this.querySelector('.interview-list-number').textContent;
                            
                            // æ›´æ–°å½“å‰æ˜¾ç¤ºçš„é¢˜ç›®
                            const questionTitle = document.querySelector('.interview-question');
                            const questionTags = document.querySelector('.interview-tags');
                            const questionProgress = document.querySelector('.interview-progress');
                            
                            if (questionTitle) questionTitle.textContent = title;
                            if (questionProgress) {
                                questionProgress.innerHTML = `<i class="fas fa-list-ol"></i> ç¬¬ ${number} é¢˜ / å…± 50 é¢˜`;
                            }
                            
                            // æ›´æ–°æ ‡ç­¾
                            if (questionTags) {
                                questionTags.innerHTML = '';
                                tags.forEach(tag => {
                                    questionTags.appendChild(tag.cloneNode(true));
                                });
                            }
                            
                            // æ¸…ç©ºè¾“å…¥æ¡†
                            if (interviewAnswerInput) {
                                interviewAnswerInput.value = '';
                                interviewAnswerInput.focus();
                            }
                            
                            // æ»šåŠ¨åˆ°é¡¶éƒ¨
                            document.querySelector('.interview-card').scrollIntoView({ behavior: 'smooth' });
                        });
                    });
                }
                
                // åˆ·æ–°é¢˜ç›®
                if (refreshQuestionBtn) {
                    refreshQuestionBtn.addEventListener('click', function() {
                        // éšæœºé€‰æ‹©ä¸€ä¸ªé¢˜ç›®
                        const randomIndex = Math.floor(Math.random() * interviewListItems.length);
                        interviewListItems[randomIndex].click();
                    });
                }
                
                // æŸ¥çœ‹ç­”æ¡ˆ - å·²åœ¨HTMLä¸­ä½¿ç”¨onclickå±æ€§ï¼Œä¸éœ€è¦é‡å¤ç»‘å®š
                // æ³¨é‡Šæ‰é‡å¤çš„äº‹ä»¶ç»‘å®šï¼Œé¿å…åŒä¸€ä¸ªæŒ‰é’®è¢«è§¦å‘ä¸¤æ¬¡
                /*
                if (checkAnswerBtn) {
                    checkAnswerBtn.addEventListener('click', function() {
                        // ç›´æ¥è°ƒç”¨showAnswerå‡½æ•°æ˜¾ç¤ºç­”æ¡ˆå†…å®¹
                        const questionId = 'js-closure'; // æˆ–è€…åŠ¨æ€è·å–é¢˜ç›®ID
                        showAnswer(questionId);
                    });
                }
                */
                
                // æˆ‘ä¼šäº†æŒ‰é’®
                if (learnedBtn) {
                    learnedBtn.addEventListener('click', function() {
                        // è·å–å·²æŒæ¡çš„é¢è¯•é¢˜åˆ—è¡¨
                        const learnedInterviews = JSON.parse(localStorage.getItem('learnedInterviews') || '[]');
                        
                        // è·å–å½“å‰é¢˜ç›®æ ‡é¢˜
                        const questionTitleElement = document.querySelector('.interview-question');
                        if (!questionTitleElement) return;
                        
                        const questionTitle = questionTitleElement.textContent;
                        const isLearned = learnedInterviews.includes(questionTitle);
                        
                        const interviewCard = document.querySelector('.interview-card');
                        
                        if (isLearned) {
                            // å–æ¶ˆæŒæ¡çŠ¶æ€
                            const updatedList = learnedInterviews.filter(title => title !== questionTitle);
                            localStorage.setItem('learnedInterviews', JSON.stringify(updatedList));
                            
                            // ä¿æŒåŸå§‹æ ·å¼ï¼ˆä¸éœ€è¦æ¢å¤ï¼‰
                            
                            // æ¢å¤æŒ‰é’®çŠ¶æ€
                            learnedBtn.innerHTML = '<i class="fas fa-check"></i> æˆ‘ä¼šäº†';
                            learnedBtn.style.backgroundColor = '#4f46e5';
                            learnedBtn.disabled = false;
                            
                            // é™é»˜å–æ¶ˆæŒæ¡çŠ¶æ€
                        } else {
                            // æ·»åŠ æŒæ¡çŠ¶æ€
                            learnedInterviews.push(questionTitle);
                            localStorage.setItem('learnedInterviews', JSON.stringify(learnedInterviews));
                            
                            // æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼ˆä¸æ”¹å˜é¡µé¢å¤–è§‚ï¼‰
                            learnedBtn.innerHTML = '<i class="fas fa-check"></i> å·²æŒæ¡';
                            learnedBtn.style.backgroundColor = '#22c55e';
                            
                            // é™é»˜è®¾ç½®æŒæ¡çŠ¶æ€
                        }
                    });
                }
                
                // è®°ä¸€ä¸‹æŒ‰é’®
                if (noteBtn) {
                    noteBtn.addEventListener('click', function() {
                        // è·å–å½“å‰é¢˜ç›®æ ‡é¢˜
                        const questionTitleElement = document.querySelector('.interview-question');
                        if (!questionTitleElement) return;
                        
                        const questionTitle = questionTitleElement.textContent;
                        const noteKey = `interview_note_${questionTitle}`;
                        const isBookmarked = noteBtn.classList.contains('bookmarked');
                        
                        if (isBookmarked) {
                            // å–æ¶ˆæ”¶è—çŠ¶æ€
                            noteBtn.innerHTML = '<i class="fas fa-arrow-right"></i> è®°ä¸€ä¸‹';
                            noteBtn.style.backgroundColor = '';
                            noteBtn.style.color = '#4f46e5';
                            noteBtn.style.borderColor = '#4f46e5';
                            noteBtn.classList.remove('bookmarked');
                            
                            // æ¸…ç©ºç¬”è®°å†…å®¹å¦‚æœç”¨æˆ·ç¡®è®¤
                            const savedNotes = JSON.parse(localStorage.getItem('interviewNotes') || '{}');
                            if (savedNotes[noteKey] && savedNotes[noteKey].trim() !== '' && confirm('æ˜¯å¦åŒæ—¶æ¸…ç©ºç¬”è®°å†…å®¹ï¼Ÿ')) {
                                // æ¸…ç©ºç¬”è®°å†…å®¹
                                const notesInput = document.querySelector('.interview-notes-input');
                                if (notesInput) {
                                    notesInput.value = '';
                                    // æ¸…ç©ºå­˜å‚¨çš„ç¬”è®°
                                    savedNotes[noteKey] = '';
                                    localStorage.setItem('interviewNotes', JSON.stringify(savedNotes));
                                }
                            }
                            
                            // é™é»˜å–æ¶ˆæ”¶è—çŠ¶æ€
                        } else {
                            // èšç„¦åˆ°ç¬”è®°è¾“å…¥æ¡†
                            const notesInput = document.querySelector('.interview-notes-input');
                            if (notesInput) {
                                notesInput.focus();
                            }
                            
                            // æ›´æ–°æŒ‰é’®çŠ¶æ€
                            noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                            noteBtn.style.backgroundColor = '#f59e0b';
                            noteBtn.style.color = 'white';
                            noteBtn.style.borderColor = '#f59e0b';
                            noteBtn.classList.add('bookmarked');
                            
                            // é™é»˜æ·»åŠ åˆ°å­¦ä¹ ç¬”è®°
                        }
                    });
                }
            }
            
            // åˆå§‹åŒ–é¢è¯•é¢˜åŠŸèƒ½
            initInterviewQuestions();
            
            // æ¢å¤å·²æŒæ¡çš„é¢è¯•é¢˜çŠ¶æ€
            const learnedInterviews = JSON.parse(localStorage.getItem('learnedInterviews') || '[]');
            const currentQuestionTitle = document.querySelector('.interview-question');
            if (currentQuestionTitle && learnedInterviews.includes(currentQuestionTitle.textContent)) {
                const learnedBtn = document.querySelector('.interview-btn.primary');
                
                // åªæ›´æ–°æŒ‰é’®çŠ¶æ€ï¼Œä¸æ”¹å˜é¡µé¢å¤–è§‚
                if (learnedBtn) {
                    learnedBtn.innerHTML = '<i class="fas fa-check"></i> å·²æŒæ¡';
                    learnedBtn.style.backgroundColor = '#22c55e';
                }
            }
            
            // æ¢å¤å·²æ”¶è—çš„é¢è¯•é¢˜çŠ¶æ€
            const savedInterviewNotes = JSON.parse(localStorage.getItem('interviewNotes') || '{}');
            const currentInterviewTitle = document.querySelector('.interview-question');
            if (currentInterviewTitle) {
                const noteBtn = document.querySelector('.interview-btn.outline');
                const noteKey = `interview_note_${currentInterviewTitle.textContent}`;
                
                // å¦‚æœæœ‰ç¬”è®°å†…å®¹æˆ–è€…å·²è¢«æ ‡è®°ä¸ºæ”¶è—
                if (savedInterviewNotes[noteKey] && savedInterviewNotes[noteKey].trim() !== '' && noteBtn) {
                    noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                    noteBtn.style.backgroundColor = '#f59e0b';
                    noteBtn.style.color = 'white';
                    noteBtn.style.borderColor = '#f59e0b';
                    noteBtn.classList.add('bookmarked');
                }
            }
            
            // åˆå§‹åŒ–é¢è¯•é¢˜ç¬”è®°åŠŸèƒ½
            initInterviewNotes();
            
            // åˆå§‹åŒ–çŸ¥è¯†ç‚¹åŠŸèƒ½
            initKnowledgeButtons();
            
            // åˆå§‹åŒ–çŸ¥è¯†ç‚¹ç¬”è®°åŠŸèƒ½
            initKnowledgeNotes();
            
            // åˆå§‹åŒ–çŸ¥è¯†ç‚¹ç¬”è®°åŠŸèƒ½
            function initKnowledgeNotes() {
                console.log('ğŸ“ƒ åˆå§‹åŒ–çŸ¥è¯†ç‚¹ç¬”è®°åŠŸèƒ½...');
                
                // è·å–æ‰€æœ‰ç¬”è®°è¾“å…¥æ¡†
                const notesInputs = document.querySelectorAll('.knowledge-notes-input');
                
                // ä¸ºæ¯ä¸ªè¾“å…¥æ¡†æ·»åŠ äº‹ä»¶å¤„ç†
                notesInputs.forEach((input, index) => {
                    // è·å–çŸ¥è¯†ç‚¹æ ‡é¢˜
                    const knowledgeItem = input.closest('.knowledge-item');
                    if (!knowledgeItem) return;
                    
                    const titleElement = knowledgeItem.querySelector('.knowledge-title');
                    if (!titleElement) return;
                    
                    const knowledgeTitle = titleElement.textContent;
                    const noteKey = `knowledge_note_${knowledgeTitle}`;
                    
                    // è®¾ç½®æ ‡è¯†ä»¥ä¾¿åŒºåˆ†
                    input.setAttribute('data-note-key', noteKey);
                    
                    // ä»localStorageåŠ è½½å·²ä¿å­˜çš„ç¬”è®°
                    const savedNotes = JSON.parse(localStorage.getItem('knowledgeNotes') || '{}');
                    if (savedNotes[noteKey]) {
                        input.value = savedNotes[noteKey];
                    }
                    
                    // ç›‘å¬è¾“å…¥äº‹ä»¶ï¼Œè‡ªåŠ¨ä¿å­˜
                    input.addEventListener('input', function() {
                        const notes = JSON.parse(localStorage.getItem('knowledgeNotes') || '{}');
                        notes[noteKey] = this.value;
                        localStorage.setItem('knowledgeNotes', JSON.stringify(notes));
                        console.log(`âœ… å·²ä¿å­˜çŸ¥è¯†ç‚¹ç¬”è®°: ${noteKey}`);
                        
                        // å¦‚æœæœ‰å†…å®¹ï¼Œè‡ªåŠ¨æ›´æ–°æ”¶è—æŒ‰é’®çŠ¶æ€
                        const noteBtn = knowledgeItem.querySelector('.knowledge-btn.outline');
                        if (noteBtn) {
                            if (this.value.trim() !== '') {
                                if (!noteBtn.classList.contains('bookmarked')) {
                                    noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                                    noteBtn.style.backgroundColor = '#f59e0b';
                                    noteBtn.style.color = 'white';
                                    noteBtn.style.borderColor = '#f59e0b';
                                    noteBtn.classList.add('bookmarked');
                                }
                            } else {
                                // å¦‚æœæ²¡æœ‰å†…å®¹ï¼Œåˆ™æ¢å¤æ”¶è—æŒ‰é’®çŠ¶æ€
                                if (noteBtn.classList.contains('bookmarked')) {
                                    noteBtn.innerHTML = '<i class="fas fa-arrow-right"></i> è®°ä¸€ä¸‹';
                                    noteBtn.style.backgroundColor = '';
                                    noteBtn.style.color = '#4f46e5';
                                    noteBtn.style.borderColor = '#4f46e5';
                                    noteBtn.classList.remove('bookmarked');
                                }
                            }
                        }
                    });
                });
                
                console.log(`âœ… çŸ¥è¯†ç‚¹ç¬”è®°åŠŸèƒ½åˆå§‹åŒ–å®Œæˆï¼Œå…±${notesInputs.length}ä¸ªçŸ¥è¯†ç‚¹`);
            }
            
            // åˆå§‹åŒ–çŸ¥è¯†ç‚¹æŒ‰é’®åŠŸèƒ½
            function initKnowledgeButtons() {
                const knowledgeItems = document.querySelectorAll('.knowledge-item');
                
                knowledgeItems.forEach((item, index) => {
                    const nextBtn = item.querySelector('.knowledge-btn.secondary');
                    const learnedBtn = item.querySelector('.knowledge-btn.primary');
                    const noteBtn = item.querySelector('.knowledge-btn.outline');
                    const knowledgeTitle = item.querySelector('.knowledge-title').textContent;
                    
                    // "ä¸‹ä¸€ä¸ª"æŒ‰é’®åŠŸèƒ½
                    if (nextBtn) {
                        nextBtn.addEventListener('click', function() {
                            alert(`å·²åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼è¿™é‡Œå¯ä»¥å®ç°çŸ¥è¯†ç‚¹åˆ‡æ¢é€»è¾‘ã€‚`);
                        });
                    }
                    
                    // "æˆ‘ä¼šäº†"æŒ‰é’®åŠŸèƒ½
                    if (learnedBtn) {
                        learnedBtn.addEventListener('click', function() {
                            // è·å–å·²æŒæ¡çš„çŸ¥è¯†ç‚¹åˆ—è¡¨
                            const learnedKnowledge = JSON.parse(localStorage.getItem('learnedKnowledge') || '[]');
                            const isLearned = learnedKnowledge.includes(knowledgeTitle);
                            
                            if (isLearned) {
                                // å–æ¶ˆæŒæ¡çŠ¶æ€
                                const updatedList = learnedKnowledge.filter(title => title !== knowledgeTitle);
                                localStorage.setItem('learnedKnowledge', JSON.stringify(updatedList));
                                
                                // ä¿æŒåŸå§‹æ ·å¼ï¼ˆä¸éœ€è¦æ¢å¤ï¼‰
                                
                                // æ¢å¤æŒ‰é’®çŠ¶æ€
                                learnedBtn.innerHTML = '<i class="fas fa-check"></i> æˆ‘ä¼šäº†';
                                learnedBtn.style.backgroundColor = '#4f46e5';
                                learnedBtn.disabled = false;
                                
                                // é™é»˜å–æ¶ˆæŒæ¡çŠ¶æ€
                            } else {
                                // æ·»åŠ æŒæ¡çŠ¶æ€
                                learnedKnowledge.push(knowledgeTitle);
                                localStorage.setItem('learnedKnowledge', JSON.stringify(learnedKnowledge));
                                
                                // æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼ˆä¸æ”¹å˜é¡µé¢å¤–è§‚ï¼‰
                                learnedBtn.innerHTML = '<i class="fas fa-check"></i> å·²æŒæ¡';
                                learnedBtn.style.backgroundColor = '#22c55e';
                                
                                // é™é»˜è®¾ç½®æŒæ¡çŠ¶æ€
                            }
                        });
                    }
                    
                    // "è®°ä¸€ä¸‹"æŒ‰é’®åŠŸèƒ½
                    if (noteBtn) {
                        noteBtn.addEventListener('click', function() {
                            // è·å–å·²æ”¶è—çš„çŸ¥è¯†ç‚¹åˆ—è¡¨
                            const savedNotes = JSON.parse(localStorage.getItem('knowledgeNotes') || '{}');
                            const noteKey = `knowledge_note_${knowledgeTitle}`;
                            const isBookmarked = noteBtn.classList.contains('bookmarked');
                            
                            if (isBookmarked) {
                                // å–æ¶ˆæ”¶è—çŠ¶æ€
                                noteBtn.innerHTML = '<i class="fas fa-arrow-right"></i> è®°ä¸€ä¸‹';
                                noteBtn.style.backgroundColor = '';
                                noteBtn.style.color = '#4f46e5';
                                noteBtn.style.borderColor = '#4f46e5';
                                noteBtn.classList.remove('bookmarked');
                                
                                // æ¸…ç©ºç¬”è®°å†…å®¹å¦‚æœç”¨æˆ·ç¡®è®¤
                                if (savedNotes[noteKey] && savedNotes[noteKey].trim() !== '' && confirm('æ˜¯å¦åŒæ—¶æ¸…ç©ºç¬”è®°å†…å®¹ï¼Ÿ')) {
                                    // æ¸…ç©ºç¬”è®°å†…å®¹
                                    const notesInput = item.querySelector('.knowledge-notes-input');
                                    if (notesInput) {
                                        notesInput.value = '';
                                        // æ¸…ç©ºå­˜å‚¨çš„ç¬”è®°
                                        savedNotes[noteKey] = '';
                                        localStorage.setItem('knowledgeNotes', JSON.stringify(savedNotes));
                                    }
                                }
                                
                                // é™é»˜å–æ¶ˆæ”¶è—çŠ¶æ€
                            } else {
                                // èšç„¦åˆ°ç¬”è®°è¾“å…¥æ¡†
                                const notesInput = item.querySelector('.knowledge-notes-input');
                                if (notesInput) {
                                    notesInput.focus();
                                }
                                
                                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                                noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                                noteBtn.style.backgroundColor = '#f59e0b';
                                noteBtn.style.color = 'white';
                                noteBtn.style.borderColor = '#f59e0b';
                                noteBtn.classList.add('bookmarked');
                                
                                // é™é»˜æ·»åŠ åˆ°å­¦ä¹ ç¬”è®°
                            }
                        });
                    }
                });
                
                // æ¢å¤å·²æŒæ¡çš„çŸ¥è¯†ç‚¹çŠ¶æ€
                const learnedKnowledge = JSON.parse(localStorage.getItem('learnedKnowledge') || '[]');
                knowledgeItems.forEach(item => {
                    const title = item.querySelector('.knowledge-title').textContent;
                    const learnedBtn = item.querySelector('.knowledge-btn.primary');
                    
                    if (learnedKnowledge.includes(title) && learnedBtn) {
                        // åªæ›´æ–°æŒ‰é’®çŠ¶æ€ï¼Œä¸æ”¹å˜é¡µé¢å¤–è§‚
                        learnedBtn.innerHTML = '<i class="fas fa-check"></i> å·²æŒæ¡';
                        learnedBtn.style.backgroundColor = '#22c55e';
                    }
                });
                
                // æ¢å¤å·²æ”¶è—çš„çŸ¥è¯†ç‚¹çŠ¶æ€
                const savedNotes = JSON.parse(localStorage.getItem('knowledgeNotes') || '{}');
                knowledgeItems.forEach(item => {
                    const title = item.querySelector('.knowledge-title').textContent;
                    const noteBtn = item.querySelector('.knowledge-btn.outline');
                    const noteKey = `knowledge_note_${title}`;
                    
                    // å¦‚æœæœ‰ç¬”è®°å†…å®¹æˆ–è€…å·²è¢«æ ‡è®°ä¸ºæ”¶è—
                    if (savedNotes[noteKey] && savedNotes[noteKey].trim() !== '' && noteBtn) {
                        noteBtn.innerHTML = '<i class="fas fa-bookmark"></i> å·²æ”¶è—';
                        noteBtn.style.backgroundColor = '#f59e0b';
                        noteBtn.style.color = 'white';
                        noteBtn.style.borderColor = '#f59e0b';
                        noteBtn.classList.add('bookmarked');
                    }
                });
            }
            
            // è§£é¢˜æ€è·¯åŠŸèƒ½
            function showSolution(questionId) {
                console.log('ğŸ§  æ˜¾ç¤ºè§£é¢˜æ€è·¯:', questionId);
                
                // è·å–å¯¹åº”çš„è§£é¢˜æ€è·¯åŒºåŸŸ
                const solutionArea = document.getElementById(`solution-${questionId}`);
                const solutionBtn = document.querySelector(`[onclick="showSolution('${questionId}')"]`);
                
                if (!solutionArea) {
                    console.error('æœªæ‰¾åˆ°è§£é¢˜æ€è·¯åŒºåŸŸ');
                    return;
                }
                
                // åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€
                if (solutionArea.classList.contains('show')) {
                    solutionArea.classList.remove('show');
                    if (solutionBtn) {
                        solutionBtn.innerHTML = '<i class="fas fa-lightbulb"></i>è§£é¢˜æ€è·¯';
                    }
                } else {
                    solutionArea.classList.add('show');
                    if (solutionBtn) {
                        solutionBtn.innerHTML = '<i class="fas fa-eye-slash"></i>éšè—æ€è·¯';
                    }
                }
            }
            
            // æŸ¥çœ‹ç­”æ¡ˆåŠŸèƒ½ - ç®€æ´ç‰ˆæœ¬ï¼ˆå¸¦é˜²é‡å¤è°ƒç”¨ï¼‰
            let showAnswerLock = false; // é˜²é‡å¤è°ƒç”¨é”
            function showAnswer(questionId) {
                // é˜²é‡å¤è°ƒç”¨æ£€æŸ¥
                if (showAnswerLock) {
                    console.log('ğŸ”’ showAnswerè¢«é”å®šï¼Œå¿½ç•¥é‡å¤è°ƒç”¨');
                    return;
                }
                
                showAnswerLock = true;
                console.log('ğŸ” showAnswer called with questionId:', questionId);
                
                try {
                    // è·å–å¯¹åº”çš„ç­”æ¡ˆåŒºåŸŸ
                    const answerAreaId = `answer-${questionId}`;
                    const answerArea = document.getElementById(answerAreaId);
                    
                    if (!answerArea) {
                        console.error('âŒ æœªæ‰¾åˆ°ç­”æ¡ˆåŒºåŸŸ:', answerAreaId);
                        return;
                    }
                    
                    // æŸ¥æ‰¾æŒ‰é’®
                    const answerBtn = document.querySelector(`[onclick*="showAnswer('${questionId}')"]`);
                    
                    // åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€
                    if (answerArea.classList.contains('show')) {
                        // å½“å‰æ˜¾ç¤ºä¸­ï¼Œåˆ‡æ¢ä¸ºéšè—
                        answerArea.classList.remove('show');
                        if (answerBtn) {
                            answerBtn.innerHTML = '<i class="fas fa-eye"></i>æŸ¥çœ‹ç­”æ¡ˆ';
                        }
                        console.log('âœ… å·²éšè—ç­”æ¡ˆ');
                    } else {
                        // å½“å‰éšè—ä¸­ï¼Œåˆ‡æ¢ä¸ºæ˜¾ç¤º
                        answerArea.classList.add('show');
                        if (answerBtn) {
                            answerBtn.innerHTML = '<i class="fas fa-eye-slash"></i>éšè—ç­”æ¡ˆ';
                        }
                        console.log('âœ… å·²æ˜¾ç¤ºç­”æ¡ˆ');
                    }
                } finally {
                    // è§£é”ï¼Œå…è®¸ä¸‹æ¬¡è°ƒç”¨
                    setTimeout(() => {
                        showAnswerLock = false;
                    }, 200); // 200msåè§£é”
                }
            }
            
            // AIèŠå¤©åŠŸèƒ½
            function startAIChat(questionId) {
                console.log('ğŸ¤– å¯åŠ¨AIèŠå¤©:', questionId);
                
                // è·å–é¢˜ç›®å†…å®¹
                const questionCard = document.querySelector(`[data-question-id="${questionId}"]`) || document.querySelector('.interview-card');
                if (!questionCard) {
                    console.error('æœªæ‰¾åˆ°é¢˜ç›®å¡ç‰‡');
                    return;
                }
                
                const questionText = questionCard.querySelector('.interview-question').textContent;
                const questionTags = Array.from(questionCard.querySelectorAll('.interview-tag')).map(tag => tag.textContent).join(', ');
                
                // æ„å»ºèŠå¤©å†…å®¹
                const chatContent = `é¢è¯•é¢˜ç›®ï¼š${questionText}\n\né¢˜ç›®æ ‡ç­¾ï¼š${questionTags}\n\nè¯·å¸®æˆ‘åˆ†æè¿™é“é¢è¯•é¢˜ï¼Œå¹¶æä¾›è¯¦ç»†çš„è§£ç­”æ€è·¯å’Œå‚è€ƒç­”æ¡ˆã€‚`;
                
                // å‘é€æ¶ˆæ¯åˆ°AIåŠ©æ‰‹
                sendMessageToAI(chatContent);
                
                // æ˜¾ç¤ºåé¦ˆ
                console.log('âœ… å·²å°†é¢˜ç›®å‘é€åˆ°AIåŠ©æ‰‹');
            }
            
            // å‘é€æ¶ˆæ¯åˆ°AIåŠ©æ‰‹çš„å‡½æ•°
            function sendMessageToAI(message) {
                // è·å–AIåŠ©æ‰‹çš„èŠå¤©åŒºåŸŸ
                const chatMessages = document.querySelector('.chat-messages');
                const chatInput = document.querySelector('.chat-input');
                
                if (chatInput) {
                    // å°†æ¶ˆæ¯å¡«å…¥è¾“å…¥æ¡†
                    chatInput.value = message;
                    chatInput.focus();
                    
                    // æ¨¡æ‹Ÿå‘é€æ“ä½œ
                    const sendBtn = document.querySelector('.send-btn');
                    if (sendBtn && !sendBtn.disabled) {
                        // è§¦å‘å‘é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                        setTimeout(() => {
                            sendBtn.click();
                        }, 100);
                    }
                }
                
                // å¦‚æœAIåŠ©æ‰‹è¢«æœ€å°åŒ–ï¼Œå°±æ¢å¤å®ƒ
                const aiAssistant = document.querySelector('.ai-assistant');
                if (aiAssistant && aiAssistant.classList.contains('minimized')) {
                    aiAssistant.classList.remove('minimized');
                }
            }
            
            // ç”Ÿæˆç­”æ¡ˆå†…å®¹çš„å‡½æ•°
            function generateAnswerContent(questionId) {
                return `
                    <div class="answer-title">
                        <i class="fas fa-check-circle"></i>
                        å‚è€ƒç­”æ¡ˆ
                    </div>
                    <div class="answer-content">
                        <h4>æ ‡å‡†ç­”æ¡ˆè¦ç‚¹</h4>
                        <p>è¿™é‡Œä¼šæ˜¾ç¤ºè¯¥é¢è¯•é¢˜çš„è¯¦ç»†å‚è€ƒç­”æ¡ˆï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ¦‚å¿µã€å®é™…åº”ç”¨ã€ä»£ç ç¤ºä¾‹ç­‰å†…å®¹ã€‚</p>
                        
                        <h4>è¯„åˆ†æ ‡å‡†</h4>
                        <ul>
                            <li><strong>åŸºç¡€æ¦‚å¿µç†è§£</strong>ï¼šèƒ½å¤Ÿå‡†ç¡®è¯´å‡ºæ ¸å¿ƒå®šä¹‰</li>
                            <li><strong>åŸç†é˜è¿°</strong>ï¼šèƒ½å¤Ÿè§£é‡Šå·¥ä½œæœºåˆ¶å’ŒåŸç†</li>
                            <li><strong>å®é™…åº”ç”¨</strong>ï¼šèƒ½å¤Ÿä¸¾å‡ºå…·ä½“çš„åº”ç”¨åœºæ™¯</li>
                            <li><strong>ä»£ç ç¤ºä¾‹</strong>ï¼šèƒ½å¤Ÿæä¾›ç›¸å…³çš„ä»£ç æ¼”ç¤º</li>
                        </ul>
                        
                        <h4>åŠ åˆ†é¡¹</h4>
                        <ul>
                            <li>ä¸»åŠ¨æåŠç›¸å…³çš„æ‰©å±•çŸ¥è¯†ç‚¹</li>
                            <li>åˆ†æå¯èƒ½çš„ä¼˜ç¼ºç‚¹æˆ–æ³¨æ„äº‹é¡¹</li>
                            <li>å±•ç¤ºå®é™…é¡¹ç›®ç»éªŒ</li>
                        </ul>
                    </div>
                `;
            }
            
            // ç¤ºä¾‹è§£é¢˜æ€è·¯æ•°æ®
            const solutionData = {
                'js-closure': {
                    title: 'JavaScripté—­åŒ…è§£é¢˜æ€è·¯',
                    content: `
                        <h4>1. ç†è§£é¢˜ç›®è¦æ±‚</h4>
                        <p>é¢è¯•å®˜æƒ³äº†è§£ä½ å¯¹é—­åŒ…æ¦‚å¿µçš„æŒæ¡ç¨‹åº¦ï¼ŒåŒ…æ‹¬ï¼š</p>
                        <ul>
                            <li>é—­åŒ…çš„å®šä¹‰å’ŒåŸç†</li>
                            <li>é—­åŒ…çš„å®é™…åº”ç”¨åœºæ™¯</li>
                            <li>é—­åŒ…å¯èƒ½å¸¦æ¥çš„é—®é¢˜</li>
                        </ul>
                        
                        <h4>2. å›ç­”è¦ç‚¹</h4>
                        <ul>
                            <li><strong>å®šä¹‰ï¼š</strong>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°</li>
                            <li><strong>åŸç†ï¼š</strong>å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›å˜é‡ä»ç„¶è¢«ä¿å­˜åœ¨å†…å­˜ä¸­</li>
                            <li><strong>åº”ç”¨ï¼š</strong>æ¨¡å—åŒ–ç¼–ç¨‹ã€ç§æœ‰å˜é‡ã€å›è°ƒå‡½æ•°ç­‰</li>
                        </ul>
                        
                        <h4>3. ç¤ºä¾‹ä»£ç </h4>
                        <p>å‡†å¤‡ä¸€ä¸ªç®€å•çš„é—­åŒ…ç¤ºä¾‹ï¼š</p>
                        <pre><code>function createCounter() {
    let count = 0;
    return function() {
        return ++count;
    };
}
const counter = createCounter();
console.log(counter()); // 1
console.log(counter()); // 2</code></pre>
                        
                        <h4>4. æ³¨æ„äº‹é¡¹</h4>
                        <ul>
                            <li>æåˆ°å†…å­˜æ³„æ¼çš„é£é™©</li>
                            <li>è¯´æ˜å¦‚ä½•é¿å…é—­åŒ…é™·é˜±</li>
                            <li>å¼ºè°ƒåˆç†ä½¿ç”¨çš„é‡è¦æ€§</li>
                        </ul>
                    `
                }
            };
            
            // åŠ¨æ€ç”Ÿæˆè§£é¢˜æ€è·¯å†…å®¹
            function generateSolutionContent(questionId) {
                const solution = solutionData[questionId];
                if (!solution) {
                    return `
                        <div class="solution-title">
                            <i class="fas fa-lightbulb"></i>
                            è§£é¢˜æ€è·¯
                        </div>
                        <div class="solution-content">
                            <h4>1. åˆ†æé¢˜ç›®å…³é”®ç‚¹</h4>
                            <p>é¦–å…ˆç†è§£é¢è¯•å®˜çš„çœŸå®æ„å›¾ï¼Œæ˜ç¡®è¦è€ƒæŸ¥çš„æŠ€æœ¯ç‚¹ã€‚</p>
                            
                            <h4>2. ç»„ç»‡ç­”æ¡ˆç»“æ„</h4>
                            <ul>
                                <li>å…ˆç»™å‡ºæ ¸å¿ƒæ¦‚å¿µçš„å®šä¹‰</li>
                                <li>è¯¦ç»†è§£é‡Šå·¥ä½œåŸç†</li>
                                <li>ä¸¾ä¾‹è¯´æ˜å®é™…åº”ç”¨</li>
                                <li>æ€»ç»“ä¼˜ç¼ºç‚¹å’Œæ³¨æ„äº‹é¡¹</li>
                            </ul>
                            
                            <h4>3. å›ç­”æŠ€å·§</h4>
                            <ul>
                                <li>ä¿æŒé€»è¾‘æ¸…æ™°ï¼Œç”±æµ…å…¥æ·±</li>
                                <li>ç»“åˆå…·ä½“ä»£ç ç¤ºä¾‹</li>
                                <li>ä¸»åŠ¨æåŠç›¸å…³æŠ€æœ¯ç‚¹</li>
                                <li>å±•ç¤ºè§£å†³é—®é¢˜çš„æ€ç»´è¿‡ç¨‹</li>
                            </ul>
                            
                            <h4>4. åŠ åˆ†é¡¹</h4>
                            <p>ä¸»åŠ¨æ‰©å±•ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œå±•ç¤ºæŠ€æœ¯æ·±åº¦å’Œå¹¿åº¦ã€‚</p>
                        </div>
                    `;
                }
                
                return `
                    <div class="solution-title">
                        <i class="fas fa-lightbulb"></i>
                        ${solution.title}
                    </div>
                    <div class="solution-content">
                        ${solution.content}
                    </div>
                `;
            }
            
            // ä¸ºæ‰€æœ‰é¢è¯•é¢˜å¡ç‰‡æ·»åŠ è§£é¢˜æ€è·¯åŒºåŸŸ
            function initSolutionFeature() {
                console.log('ğŸ”§ åˆå§‹åŒ–è§£é¢˜æ€è·¯åŠŸèƒ½...');
                
                const interviewCards = document.querySelectorAll('.interview-card');
                
                interviewCards.forEach((card, index) => {
                    const questionId = `question-${index + 1}`;
                    
                    // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰helper-actionsåŒºåŸŸ
                    let helperActionsDiv = card.querySelector('.interview-helper-actions');
                    
                    // å¦‚æœæ²¡æœ‰helper-actionsåŒºåŸŸï¼Œåˆ™åˆ›å»ºä¸€ä¸ª
                    if (!helperActionsDiv) {
                        helperActionsDiv = document.createElement('div');
                        helperActionsDiv.className = 'interview-helper-actions';
                        helperActionsDiv.style.cssText = 'display: flex; gap: 0.75rem; margin: 1.5rem 0;';
                        
                        // æ‰¾åˆ°é€‚åˆçš„æ’å…¥ä½ç½®ï¼ˆtagsä¹‹åï¼Œanswer-inputä¹‹å‰ï¼‰
                        const tagsDiv = card.querySelector('.interview-tags');
                        const answerInput = card.querySelector('.interview-answer-input');
                        
                        if (tagsDiv && answerInput) {
                            // åœ¨tagsä¹‹åã€answer-inputä¹‹å‰æ’å…¥
                            answerInput.parentNode.insertBefore(helperActionsDiv, answerInput);
                            
                            // æ·»åŠ è§£é¢˜æ€è·¯æŒ‰é’®
                            const solutionBtn = document.createElement('button');
                            solutionBtn.className = 'interview-btn solution';
                            solutionBtn.style.flex = '1';
                            solutionBtn.innerHTML = '<i class="fas fa-lightbulb"></i>è§£é¢˜æ€è·¯';
                            solutionBtn.onclick = () => showSolution(questionId);
                            
                            // æ·»åŠ æŸ¥çœ‹ç­”æ¡ˆæŒ‰é’®
                            const answerBtn = document.createElement('button');
                            answerBtn.className = 'interview-btn secondary';
                            answerBtn.style.flex = '1';
                            answerBtn.innerHTML = '<i class="fas fa-eye"></i>æŸ¥çœ‹ç­”æ¡ˆ';
                            // ä½¿ç”¨setAttributeè®¾ç½®onclickå±æ€§ï¼Œé¿å…é‡å¤ç»‘å®š
                            answerBtn.setAttribute('onclick', `showAnswer('${questionId}')`);
                            
                            helperActionsDiv.appendChild(solutionBtn);
                            helperActionsDiv.appendChild(answerBtn);
                        }
                    }
                    
                    // åœ¨é¢è¯•é¢˜å¡ç‰‡ä¸­æ·»åŠ è§£é¢˜æ€è·¯æ˜¾ç¤ºåŒºåŸŸï¼ˆåœ¨ç­”æ¡ˆè¾“å…¥æ¡†ä¹‹å‰ï¼‰
                    const existingSolutionArea = card.querySelector(`#solution-${questionId}`);
                    if (!existingSolutionArea) {
                        const solutionDiv = document.createElement('div');
                        solutionDiv.id = `solution-${questionId}`;
                        solutionDiv.className = 'solution-area';
                        solutionDiv.innerHTML = generateSolutionContent(questionId);
                        
                        // æ’å…¥åˆ°ç­”æ¡ˆè¾“å…¥æ¡†ä¹‹å‰
                        const answerInput = card.querySelector('.interview-answer-input');
                        if (answerInput) {
                            answerInput.parentNode.insertBefore(solutionDiv, answerInput);
                        } else {
                            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆè¾“å…¥æ¡†ï¼Œå°±æ’å…¥åˆ°helper-actionsä¹‹å
                            if (helperActionsDiv.nextSibling) {
                                helperActionsDiv.parentNode.insertBefore(solutionDiv, helperActionsDiv.nextSibling);
                            } else {
                                helperActionsDiv.parentNode.appendChild(solutionDiv);
                            }
                        }
                    }
                    
                    // æ·»åŠ ç­”æ¡ˆæ˜¾ç¤ºåŒºåŸŸ
                    const existingAnswerArea = card.querySelector(`#answer-${questionId}`);
                    if (!existingAnswerArea) {
                        const answerDiv = document.createElement('div');
                        answerDiv.id = `answer-${questionId}`;
                        answerDiv.className = 'answer-area';
                        answerDiv.innerHTML = generateAnswerContent(questionId);
                        
                        // æ’å…¥åˆ°è§£é¢˜æ€è·¯åŒºåŸŸä¹‹åï¼Œç­”æ¡ˆè¾“å…¥æ¡†ä¹‹å‰
                        const solutionArea = card.querySelector(`#solution-${questionId}`);
                        const answerInput = card.querySelector('.interview-answer-input');
                        
                        if (solutionArea && answerInput) {
                            answerInput.parentNode.insertBefore(answerDiv, answerInput);
                        } else if (answerInput) {
                            answerInput.parentNode.insertBefore(answerDiv, answerInput);
                        } else if (helperActionsDiv.nextSibling) {
                            helperActionsDiv.parentNode.insertBefore(answerDiv, helperActionsDiv.nextSibling);
                        } else {
                            helperActionsDiv.parentNode.appendChild(answerDiv);
                        }
                    }
                });
                
                console.log('âœ… è§£é¢˜æ€è·¯åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
            }
            
            // çŸ¥è¯†ç‚¹AIèŠå¤©åŠŸèƒ½
            function startAIKnowledgeChat(knowledgeId) {
                console.log('ğŸ¤– å¯åŠ¨çŸ¥è¯†ç‚¹AIèŠå¤©:', knowledgeId);
                
                // å°è¯•å¤šç§æ–¹å¼è·å–çŸ¥è¯†ç‚¹å†…å®¹
                let knowledgeItem = null;
                
                // æ–¹æ³•1ï¼šé€šè¿‡onclickå±æ€§æŸ¥æ‰¾
                const clickButtons = document.querySelectorAll('[onclick*="startAIKnowledgeChat"]');
                for (let btn of clickButtons) {
                    if (btn.onclick && btn.onclick.toString().includes(knowledgeId)) {
                        knowledgeItem = btn.closest('.knowledge-item');
                        break;
                    }
                }
                
                // æ–¹æ³•2ï¼šç›´æ¥æŸ¥æ‰¾æœ€è¿‘çš„çŸ¥è¯†ç‚¹å®¹å™¨
                if (!knowledgeItem) {
                    knowledgeItem = document.querySelector('.knowledge-item');
                }
                
                if (!knowledgeItem) {
                    console.error('æœªæ‰¾åˆ°çŸ¥è¯†ç‚¹å¡ç‰‡');
                    alert('æœªæ‰¾åˆ°çŸ¥è¯†ç‚¹å†…å®¹ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                    return;
                }
                
                console.log('âœ… æ‰¾åˆ°çŸ¥è¯†ç‚¹å…ƒç´ :', knowledgeItem);
                
                // è·å–çŸ¥è¯†ç‚¹æ ‡é¢˜
                const knowledgeTitleElement = knowledgeItem.querySelector('.knowledge-title');
                const knowledgeTitle = knowledgeTitleElement ? knowledgeTitleElement.textContent : 'æœªçŸ¥çŸ¥è¯†ç‚¹';
                
                // è·å–çŸ¥è¯†ç‚¹å†…å®¹
                const knowledgeTextElement = knowledgeItem.querySelector('.knowledge-text');
                let knowledgeContent = '';
                
                if (knowledgeTextElement) {
                    // æå–çŸ¥è¯†ç‚¹çš„æ–‡æœ¬å†…å®¹ï¼Œå»æ‰HTMLæ ‡ç­¾
                    knowledgeContent = knowledgeTextElement.textContent || knowledgeTextElement.innerText || '';
                }
                
                console.log('ğŸ“– çŸ¥è¯†ç‚¹æ ‡é¢˜:', knowledgeTitle);
                console.log('ğŸ“„ çŸ¥è¯†ç‚¹å†…å®¹é¢„è§ˆ:', knowledgeContent.substring(0, 100) + '...');
                
                // æ„å»ºèŠå¤©å†…å®¹
                const chatContent = `çŸ¥è¯†ç‚¹ï¼š${knowledgeTitle}\n\nçŸ¥è¯†ç‚¹å†…å®¹ï¼š\n${knowledgeContent}\n\nè¯·å¸®æˆ‘æ·±å…¥å­¦ä¹ è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬ç›¸å…³æ¦‚å¿µè§£é‡Šã€å®é™…åº”ç”¨åœºæ™¯ã€å­¦ä¹ å»ºè®®ç­‰ã€‚`;
                
                // å‘é€æ¶ˆæ¯åˆ°AIåŠ©æ‰‹
                sendMessageToAI(chatContent);
                
                // æ˜¾ç¤ºåé¦ˆ
                console.log('âœ… å·²å°†çŸ¥è¯†ç‚¹å‘é€åˆ°AIåŠ©æ‰‹');
                
                // é™é»˜å‘é€åˆ°AIåŠ©æ‰‹
            }
            
            // å…¨å±€æš´éœ²å‡½æ•°
            window.showSolution = showSolution;
            window.showAnswer = showAnswer;
            window.startAIChat = startAIChat;
            window.startAIKnowledgeChat = startAIKnowledgeChat;
            window.sendMessageToAI = sendMessageToAI;
            
            // éªŒè¯å‡½æ•°æ˜¯å¦æ­£ç¡®æš´éœ²
            console.log('ğŸ” éªŒè¯å…¨å±€å‡½æ•°æš´éœ²:', {
                showSolution: typeof window.showSolution,
                showAnswer: typeof window.showAnswer, 
                startAIChat: typeof window.startAIChat,
                startAIKnowledgeChat: typeof window.startAIKnowledgeChat,
                sendMessageToAI: typeof window.sendMessageToAI
            });
            
            // æµ‹è¯•ç›´æ¥è°ƒç”¨
            console.log('ğŸ§ª æµ‹è¯•ç›´æ¥è°ƒç”¨ showAnswer:');
            try {
                console.log('âœ… showAnswer å‡½æ•°å­˜åœ¨ï¼Œå¯ä»¥è°ƒç”¨');
            } catch (e) {
                console.error('âŒ showAnswer å‡½æ•°è°ƒç”¨å¤±è´¥:', e);
            }
            
            // åˆå§‹åŒ–è§£é¢˜æ€è·¯åŠŸèƒ½ - æš‚æ—¶æ³¨é‡Šæ‰é¿å…é‡å¤æŒ‰é’®åˆ›å»º
            // initSolutionFeature();
            
            // é¡µé¢åŠ è½½å®Œæˆåçš„éªŒè¯
            setTimeout(() => {
                console.log('ğŸ” é¡µé¢åŠ è½½å®Œæˆï¼ŒéªŒè¯å…ƒç´ å’Œå‡½æ•°:');
                console.log('ç­”æ¡ˆåŒºåŸŸ:', document.getElementById('answer-js-closure'));
                console.log('ç­”æ¡ˆæŒ‰é’®:', document.querySelector('[onclick*="showAnswer"]'));
                console.log('showAnswerå‡½æ•°:', window.showAnswer);
                
                // æ‰‹åŠ¨æµ‹è¯•è°ƒç”¨
                console.log('ğŸ§ª æ‰‹åŠ¨æµ‹è¯•è°ƒç”¨ showAnswer:');
                if (window.showAnswer) {
                    console.log('âœ… å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ showAnswer');
                } else {
                    console.error('âŒ æ— æ³•æ‰‹åŠ¨è°ƒç”¨ showAnswer');
                }
            }, 1000);
            
            // æµ‹è¯•AIæœºå™¨äººå›¾æ ‡çš„ç‚¹å‡»äº‹ä»¶
            const aiChatBtns = document.querySelectorAll('.ai-chat-btn');
            console.log('ğŸ¤– æ‰¾åˆ°AIèŠå¤©æŒ‰é’®æ•°é‡:', aiChatBtns.length);
            
            aiChatBtns.forEach((btn, index) => {
                console.log(`ğŸ”˜ AIæŒ‰é’® ${index + 1}:`, {
                    onclick: btn.onclick,
                    onclickStr: btn.getAttribute('onclick'),
                    element: btn
                });
                
                // ä¸ºæ¯ä¸ªæŒ‰é’®æ·»åŠ é¢å¤–çš„ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ä½œä¸ºå¤‡ç”¨
                btn.addEventListener('click', function(e) {
                    console.log('ğŸ’† AIæŒ‰é’®è¢«ç‚¹å‡»:', this);
                    
                    // å¦‚æœæ˜¯çŸ¥è¯†ç‚¹çš„AIæŒ‰é’®
                    if (this.getAttribute('onclick') && this.getAttribute('onclick').includes('startAIKnowledgeChat')) {
                        e.preventDefault();
                        const match = this.getAttribute('onclick').match(/startAIKnowledgeChat\('([^']+)'\)/);
                        if (match) {
                            const knowledgeId = match[1];
                            console.log('ğŸ”„ æ‰‹åŠ¨è°ƒç”¨ startAIKnowledgeChat:', knowledgeId);
                            startAIKnowledgeChat(knowledgeId);
                        }
                    }
                });
            });
            
        });
    </script>
</body>

<!-- APIé…ç½®æ¨¡æ€æ¡† -->
<div class="modal" id="apiConfigModal">
    <div class="modal-overlay"></div>
    <div class="modal-container">
        <div class="modal-header">
            <h3>
                <i class="fas fa-cog"></i>
                é…ç½®APIå¯†é’¥
            </h3>
            <button class="modal-close" id="apiConfigClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <p class="modal-description">è¯·è¾“å…¥æ‚¨çš„APIå¯†é’¥ï¼Œä»¥è·å¾—æ›´å¥½çš„AIåŠŸèƒ½ä½“éªŒã€‚</p>
            
            <div class="input-group">
                <label for="apiKey">å¤§è¯­è¨€æ¨¡å‹ API å¯†é’¥</label>
                <div class="key-input-container">
                    <input type="password" id="apiKey" placeholder="è¾“å…¥æ‚¨çš„APIå¯†é’¥..." class="modal-input">
                    <button class="toggle-btn" id="toggleApiKey">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>
            
            <div class="provider-select">
                <label for="apiProvider">æ¨¡å‹æä¾›å•†</label>
                <select id="apiProvider" class="modal-select">
                    <option value="alibaba">é˜¿é‡Œäº‘ - DashScope</option>
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic Claude</option>
                </select>
            </div>
            
            <div class="provider-info alibaba-info">
                <div class="provider-logo">
                    <i class="fas fa-cloud" style="font-size: 32px; color: #ff6a00;"></i>
                </div>
                <div class="provider-details">
                    <h4>é˜¿é‡Œäº‘ DashScope</h4>
                    <p>ä½¿ç”¨é€šä¹‰å¤§æ¨¡å‹ç³»åˆ—ï¼ŒåŒ…æ‹¬æ¨¡å‹é€šä¹‰åƒé—®2.0ç­‰</p>
                    <a href="https://dashscope.aliyun.com/" target="_blank" class="provider-link">è·å–å¯†é’¥</a>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn modal-btn-cancel" id="apiConfigCancel">å–æ¶ˆ</button>
            <button class="modal-btn modal-btn-confirm" id="apiConfigConfirm">ä¿å­˜é…ç½®</button>
        </div>
    </div>
</div>
</html>
